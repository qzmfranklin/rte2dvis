(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    363360,      11832]
NotebookOptionsPosition[    361711,      11777]
NotebookOutlinePosition[    362238,      11799]
CellTagsIndexPosition[    362195,      11796]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Discretization of the Volume Integral Equation (VIE)\
\>", "Subtitle",
 CellChangeTimes->{{3.5880703101450863`*^9, 3.588070361790676*^9}}],

Cell[TextData[{
 "Following the Liemert paper\[CloseCurlyQuote]s notation, the radiative \
transport equation (RTE) reads\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{"\[Psi]", "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         StyleBox["v",
          FontWeight->"Bold"]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Psi]", "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        StyleBox["s",
         FontWeight->"Bold"]}], ")"}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"f", "(", 
         RowBox[{
          StyleBox["s",
           FontWeight->"Bold"], "\[CenterDot]", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}], 
        RowBox[{"\[Psi]", "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}]}]}]}], "+", 
     RowBox[{"q", "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", 
       StyleBox["s",
        FontWeight->"Bold"]}], ")"}]}]}], TraditionalForm]]],
 "\nwith\n\t",
 Cell[BoxData[
  FormBox[
   StyleBox["r",
    FontWeight->"Bold"], TraditionalForm]]],
 "\t\t\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"[", "L", "]"}], 
    RowBox[{"+", "1"}]], TraditionalForm]]],
 "\tposition vector\n\t",
 Cell[BoxData[
  FormBox[
   StyleBox["s",
    FontWeight->"Bold"], TraditionalForm]]],
 "\t\t\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"[", "L", "]"}], "0"], TraditionalForm]]],
 "\tunit direction vector\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Psi]", "(", 
    RowBox[{
     StyleBox["r",
      FontWeight->"Bold"], ",", 
     StyleBox["s",
      FontWeight->"Bold"]}], ")"}], TraditionalForm]]],
 "\t\t\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"[", "L", "]"}], "0"], TraditionalForm]]],
 "\tradiance\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"q", "(", 
    RowBox[{
     StyleBox["r",
      FontWeight->"Bold"], ",", 
     StyleBox["s",
      FontWeight->"Bold"]}], ")"}], TraditionalForm]]],
 "\t\t\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"[", "L", "]"}], 
    RowBox[{"-", "1"}]], TraditionalForm]]],
 "\tsource\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     StyleBox["s",
      FontWeight->"Bold"], "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["s",
       FontWeight->"Bold"], "'"]}], ")"}], TraditionalForm]]],
 "\t\t\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"[", "L", "]"}], "0"], TraditionalForm]]],
 "\tscattering phase function as a function of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["s",
     FontWeight->"Bold"], "\[CenterDot]", 
    SuperscriptBox[
     StyleBox["s",
      FontWeight->"Bold"], "'"]}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "m"], "=", 
    SuperscriptBox["g", 
     TemplateBox[{"m"},
      "Abs"]]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Mu]", "s"], "(", 
    StyleBox["r",
     FontWeight->"Bold"], ")"}], TraditionalForm]]],
 "\t\t\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"[", "L", "]"}], 
    RowBox[{"-", "1"}]], TraditionalForm]]],
 "\tscattering cross-section, independent of ",
 Cell[BoxData[
  FormBox[
   StyleBox["s",
    FontWeight->"Bold"], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Mu]", "a"], "(", 
    StyleBox["r",
     FontWeight->"Bold"], ")"}], TraditionalForm]]],
 "\t\t\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"[", "L", "]"}], 
    RowBox[{"-", "1"}]], TraditionalForm]]],
 "\tabsorption cross-section, independent of ",
 Cell[BoxData[
  FormBox[
   StyleBox["s",
    FontWeight->"Bold"], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   FormBox[
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "t"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], "+", 
      RowBox[{
       SubscriptBox["\[Mu]", "a"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}]}]}],
    TraditionalForm], TraditionalForm]]],
 "\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"[", "L", "]"}], 
    RowBox[{"-", "1"}]], TraditionalForm]]],
 "\ttotal cross-section, independent of ",
 Cell[BoxData[
  FormBox[
   StyleBox["s",
    FontWeight->"Bold"], TraditionalForm]]],
 "\nFor a single scatterer, the volume integral equation\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]", "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", 
       StyleBox["s",
        FontWeight->"Bold"]}], ")"}], "+", 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"]}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         StyleBox["s",
          FontWeight->"Bold"], "'"]}], 
       RowBox[{"g", "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         RowBox[{
          StyleBox["s",
           FontWeight->"Bold"], ";", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}], ",", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], ")"}], 
       RowBox[{
        SubscriptBox["\[Mu]", "t"], "(", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ")"}], 
       RowBox[{"\[Psi]", "(", 
        RowBox[{
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ",", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], ")"}]}]}], "-", 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"]}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         StyleBox["s",
          FontWeight->"Bold"], "'"]}], 
       RowBox[{"g", "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         RowBox[{
          StyleBox["s",
           FontWeight->"Bold"], ";", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}], ",", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], ")"}], 
       RowBox[{
        SubscriptBox["\[Mu]", "s"], "(", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ")"}], 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "''"]}], 
         RowBox[{"f", "(", 
          RowBox[{
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "'"], "\[CenterDot]", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "''"]}], ")"}], 
         RowBox[{"\[Psi]", "(", 
          RowBox[{
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"], ",", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "''"]}], ")"}]}]}]}]}]}], "=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["s",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"g", "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        RowBox[{
         StyleBox["s",
          FontWeight->"Bold"], ";", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], ",", 
        SuperscriptBox[
         StyleBox["s",
          FontWeight->"Bold"], "'"]}], ")"}], 
      RowBox[{"q", "(", 
       RowBox[{
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ",", 
        SuperscriptBox[
         StyleBox["s",
          FontWeight->"Bold"], "'"]}], ")"}]}]}]}], TraditionalForm]]],
 "\t\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"[", "L", "]"}], "0"], TraditionalForm]]],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{"g", "(", 
    RowBox[{
     StyleBox["r",
      FontWeight->"Bold"], ",", 
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], ";", 
      SuperscriptBox[
       StyleBox["r",
        FontWeight->"Bold"], "'"]}], ",", 
     SuperscriptBox[
      StyleBox["s",
       FontWeight->"Bold"], "'"]}], ")"}], TraditionalForm]]],
 " is the free space (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Mu]", "s"], "=", 
    RowBox[{
     SubscriptBox["\[Mu]", "a"], "=", "0"}]}], TraditionalForm]]],
 ") Green\[CloseCurlyQuote]s function\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"g", "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      RowBox[{
       StyleBox["s",
        FontWeight->"Bold"], ";", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], ",", 
      SuperscriptBox[
       StyleBox["s",
        FontWeight->"Bold"], "'"]}], ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      TemplateBox[{RowBox[{
          StyleBox["r", FontWeight -> "Bold"], "-", 
          SuperscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "'"]}]},
       "Abs"]], Cell[""], 
     RowBox[{"\[Delta]", "(", 
      RowBox[{
       StyleBox["s",
        FontWeight->"Bold"], "-", 
       SubscriptBox[
        StyleBox["s",
         FontWeight->"Bold"], 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]]}], ")"}], 
     RowBox[{"\[Delta]", "(", 
      RowBox[{
       SuperscriptBox[
        StyleBox["s",
         FontWeight->"Bold"], "'"], "-", 
       SubscriptBox[
        StyleBox["s",
         FontWeight->"Bold"], 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]]}], ")"}]}]}], TraditionalForm]]],
 "\t\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"[", "L", "]"}], 
    RowBox[{"-", "1"}]], TraditionalForm]]],
 "\nwith\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      StyleBox["r",
       FontWeight->"Bold"], "'"], ",", 
     SuperscriptBox[
      StyleBox["s",
       FontWeight->"Bold"], "'"]}], ")"}], TraditionalForm]]],
 "\t\tsource point\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     StyleBox["r",
      FontWeight->"Bold"], ",", 
     StyleBox["s",
      FontWeight->"Bold"]}], ")"}], TraditionalForm]]],
 "\t\tfield point\n\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["s",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["r",
      FontWeight->"Bold"], "-", 
     SuperscriptBox[
      StyleBox["r",
       FontWeight->"Bold"], "'"]}]], TraditionalForm]]],
 "\t\tunit vector in the direction of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["r",
     FontWeight->"Bold"], "-", 
    SuperscriptBox[
     StyleBox["r",
      FontWeight->"Bold"], "'"]}], TraditionalForm]]],
 "\ncan be written with the following short-hand notations\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Psi]", "=", 
    RowBox[{"\[Psi]", "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      StyleBox["s",
       FontWeight->"Bold"]}], ")"}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Psi]", "s"], "\[Psi]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Psi]", "s"], "[", "\[Psi]", "]"}], 
      RowBox[{"(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        StyleBox["s",
         FontWeight->"Bold"]}], ")"}]}], "=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], 
         RowBox[{"g", "(", 
          RowBox[{
           StyleBox["r",
            FontWeight->"Bold"], ",", 
           RowBox[{
            StyleBox["s",
             FontWeight->"Bold"], ";", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "'"]}], ",", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "'"]}], ")"}], 
         RowBox[{
          SubscriptBox["\[Mu]", "t"], "(", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ")"}], 
         RowBox[{"\[Psi]", "(", 
          RowBox[{
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"], ",", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "'"]}], ")"}]}]}]}], "+", 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"g", "(", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], ",", 
          RowBox[{
           StyleBox["s",
            FontWeight->"Bold"], ";", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]}], ",", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}], 
        RowBox[{
         SubscriptBox["\[Mu]", "s"], "(", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ")"}], 
        RowBox[{"\[Integral]", 
         RowBox[{
          RowBox[{"\[DifferentialD]", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "''"]}], 
          RowBox[{"f", "(", 
           RowBox[{
            SuperscriptBox[
             StyleBox["s",
              FontWeight->"Bold"], "'"], "\[CenterDot]", 
            SuperscriptBox[
             StyleBox["s",
              FontWeight->"Bold"], "''"]}], ")"}], 
          RowBox[{"\[Psi]", "(", 
           RowBox[{
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "'"], ",", 
            SuperscriptBox[
             StyleBox["s",
              FontWeight->"Bold"], "''"]}], ")"}]}]}]}]}]}]}]}], 
   TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[Psi]", "i"], "=", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Psi]", "i"], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", 
       StyleBox["s",
        FontWeight->"Bold"]}], ")"}], "=", 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"]}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         StyleBox["s",
          FontWeight->"Bold"], "'"]}], 
       RowBox[{"g", "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         RowBox[{
          StyleBox["s",
           FontWeight->"Bold"], ";", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}], ",", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], ")"}], 
       RowBox[{"q", "(", 
        RowBox[{
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ",", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], ")"}]}]}]}]}], TraditionalForm]]],
 "\nas\n\t",
 Cell[BoxData[
  FormBox[Cell[TextData[Cell[BoxData[
    FormBox[
     RowBox[{
      RowBox[{"\[Psi]", "-", 
       RowBox[{
        SuperscriptBox["\[Psi]", "s"], "\[Psi]"}]}], "=", 
      SuperscriptBox["\[Psi]", "i"]}], TraditionalForm]]]]], 
   TraditionalForm]]],
 "\nThe physical meaning is explicit from the above representation:\n\t",
 StyleBox["The total field is the sum of the \[OpenCurlyDoubleQuote]incident\
\[CloseCurlyDoubleQuote] field due to the source ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   RowBox[{"q", "(", 
    RowBox[{"r", ",", "v"}], ")"}], TraditionalForm]]],
 " ",
 StyleBox["in free space and the \[OpenCurlyDoubleQuote]scattering\
\[CloseCurlyDoubleQuote] field due to the excited sources in the scattering \
volume\n",
  FontSlant->"Italic"],
 "Note that\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[Psi]", "i"], "(", 
    RowBox[{
     StyleBox["r",
      FontWeight->"Bold"], ",", 
     StyleBox["s",
      FontWeight->"Bold"]}], ")"}], TraditionalForm]]],
 " is a ",
 StyleBox["constant",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " ",
 StyleBox["scalar field",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " for given ",
 Cell[BoxData[
  FormBox[
   RowBox[{"g", "(", 
    RowBox[{
     StyleBox["r",
      FontWeight->"Bold"], ",", 
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], ";", 
      SuperscriptBox[
       StyleBox["r",
        FontWeight->"Bold"], "'"]}], ",", 
     SuperscriptBox[
      StyleBox["s",
       FontWeight->"Bold"], "'"]}], ")"}], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"q", "(", 
    RowBox[{
     SuperscriptBox[
      StyleBox["r",
       FontWeight->"Bold"], "'"], ",", 
     SuperscriptBox[
      StyleBox["s",
       FontWeight->"Bold"], "'"]}], ")"}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Psi]", "s"], TraditionalForm]]],
 " is a ",
 StyleBox["linear",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " ",
 StyleBox["functional",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " on ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Psi]", "(", 
    RowBox[{
     StyleBox["r",
      FontWeight->"Bold"], ",", 
     StyleBox["s",
      FontWeight->"Bold"]}], ")"}], TraditionalForm]]],
 StyleBox["\n",
  FontSlant->"Italic"],
 "We can use linear solver to tackle this system!\nFor\n\t2D:\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["r",
     FontWeight->"Bold"], "\[Rule]", 
    RowBox[{"(", 
     RowBox[{"r", ",", 
      SubscriptBox["\[Phi]", 
       StyleBox["r",
        FontWeight->"Bold"]]}], ")"}]}], TraditionalForm]]],
 "\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", 
     StyleBox["r",
      FontWeight->"Bold"]}], "=", 
    RowBox[{"r", 
     RowBox[{"\[DifferentialD]", "r"}], 
     RowBox[{"\[DifferentialD]", 
      SubscriptBox["\[Phi]", 
       StyleBox["r",
        FontWeight->"Bold"]]}]}]}], TraditionalForm]]],
 "\n\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["s",
     FontWeight->"Bold"], "\[Rule]", "\[Phi]"}], TraditionalForm]]],
 "\t\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", 
     StyleBox["s",
      FontWeight->"Bold"]}], "\[Rule]", 
    RowBox[{"\[DifferentialD]", "\[Phi]"}]}], TraditionalForm]]],
 "\[LineSeparator]\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      SuperscriptBox[
       StyleBox["s",
        FontWeight->"Bold"], "'"]}], "\[Rule]", 
     RowBox[{"\[Phi]", "-", 
      SuperscriptBox["\[Phi]", "'"]}]}], ",", 
    RowBox[{"cos", "(", 
     RowBox[{"\[Phi]", "-", 
      SuperscriptBox["\[Phi]", "'"]}], ")"}]}], TraditionalForm]]],
 "\n\t3D:\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["r",
     FontWeight->"Bold"], "\[Rule]", 
    RowBox[{"(", 
     RowBox[{"r", ",", 
      SubscriptBox["\[Theta]", 
       StyleBox["r",
        FontWeight->"Bold"]], ",", 
      SubscriptBox["\[Phi]", 
       StyleBox["r",
        FontWeight->"Bold"]]}], ")"}]}], TraditionalForm]]],
 "\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", 
     StyleBox["r",
      FontWeight->"Bold"]}], "=", 
    RowBox[{
     SuperscriptBox["r", "2"], "sin\[Theta]", 
     RowBox[{"\[DifferentialD]", "r"}], 
     RowBox[{"\[DifferentialD]", 
      SubscriptBox["\[Theta]", 
       StyleBox["r",
        FontWeight->"Bold"]]}], 
     RowBox[{"\[DifferentialD]", 
      SubscriptBox["\[Phi]", 
       StyleBox["r",
        FontWeight->"Bold"]]}]}]}], TraditionalForm]]],
 "\n\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["s",
     FontWeight->"Bold"], "\[Rule]", 
    RowBox[{"(", 
     RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]}], TraditionalForm]]],
 "\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", 
     StyleBox["s",
      FontWeight->"Bold"]}], "\[Rule]", 
    RowBox[{"sin\[Theta]", 
     RowBox[{"\[DifferentialD]", "\[Theta]"}], 
     RowBox[{"\[DifferentialD]", "\[Phi]"}]}]}], TraditionalForm]]],
 "\n\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     StyleBox["s",
      FontWeight->"Bold"], "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["s",
       FontWeight->"Bold"], "'"]}], "\[Rule]", 
    RowBox[{
     RowBox[{"cos", "(", 
      RowBox[{"\[Theta]", "-", 
       SuperscriptBox["\[Theta]", "'"]}], ")"}], "-", 
     RowBox[{
      RowBox[{"cos", "(", 
       RowBox[{"\[Phi]", "-", 
        SuperscriptBox["\[Phi]", "'"]}], ")"}], "sin\[Theta]", " ", 
      SuperscriptBox["sin\[Theta]", "'"]}]}]}], TraditionalForm]]],
 "\nIn this notebook, we only do the 2D problem\nWrite out everything in 2D \
explicitly (check dimensions!)\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{"\[Psi]", "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Psi]", "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["\[Phi]", "'"]}], 
        RowBox[{"f", "(", 
         RowBox[{"\[Phi]", "-", 
          SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}], "+", 
     RowBox[{"q", "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], TraditionalForm]]],
 "\t\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]", "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "-", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Psi]", "s"], "[", "\[Psi]", "]"}], 
      RowBox[{"(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "=", 
    RowBox[{
     SuperscriptBox["\[Psi]", "i"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Psi]", "s"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["\[Phi]", "'"]}], 
        RowBox[{"g", "(", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], ",", 
          RowBox[{"\[Phi]", ";", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]}], ",", 
          SuperscriptBox["\[Phi]", "'"]}], ")"}], 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], "(", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ")"}], 
        RowBox[{"\[Psi]", "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}], "+", 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"]}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["\[Phi]", "'"]}], 
       RowBox[{"g", "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         RowBox[{"\[Phi]", ";", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}], ",", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}], 
       RowBox[{
        SubscriptBox["\[Mu]", "s"], "(", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ")"}], 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["\[Phi]", "''"]}], 
         RowBox[{"f", "(", 
          RowBox[{
           SuperscriptBox["\[Phi]", "'"], "-", 
           SuperscriptBox["\[Phi]", "''"]}], ")"}], 
         RowBox[{"\[Psi]", "(", 
          RowBox[{
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"], ",", 
           SuperscriptBox["\[Phi]", "''"]}], ")"}]}]}]}]}]}]}], 
   TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Psi]", "i"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[DifferentialD]", "2"], 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["\[Phi]", "'"]}], 
      RowBox[{"g", "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        RowBox[{"\[Phi]", ";", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], ",", 
        SuperscriptBox["\[Phi]", "'"]}], ")"}], 
      RowBox[{"q", "(", 
       RowBox[{
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ",", 
        SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"g", "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      RowBox[{"\[Phi]", ";", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], ",", 
      SuperscriptBox["\[Phi]", "'"]}], ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      TemplateBox[{RowBox[{
          StyleBox["r", FontWeight -> "Bold"], "-", 
          SuperscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "'"]}]},
       "Abs"]], Cell[""], 
     RowBox[{"\[Delta]", "(", 
      RowBox[{"\[Phi]", "-", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]]}], ")"}], 
     RowBox[{"\[Delta]", "(", 
      RowBox[{
       SuperscriptBox["\[Phi]", "'"], "-", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]]}], ")"}]}]}], TraditionalForm]]],
 "\nAssuming plane-wave incidence, e.g.,\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Psi]", "i"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{"\[Delta]", "(", 
     RowBox[{"\[Phi]", "-", 
      SuperscriptBox["\[Phi]", "i"]}], ")"}]}], TraditionalForm]]],
 "\t\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"[", "L", "]"}], "0"], TraditionalForm]]]
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxN0n0s1AEYB/BzxzGT11XYTWcrOd15S7HM+9EtEiLivMQwcRjWTO3WpJfr
GJUoL1O6q821cw6TYmnkHDc1V+1SnXmp6S6Uoc2q9fv+/vLHs8+eZ8+z55+v
a3ZJQi6VQqEEEQV5rO7K1B5DGFvEbIZMJ30rjLXmdMP9sTl9cIIuNEsj3ChL
t4S+kwprON8Y5Azd2jQusE/CDYeX9SIudF+W8uCEx/NoeCmYGgdr/NjJMOnA
Wjq0N2NehIo0/+sw/mVDLdSId4+Q97T0cXjhZ54GlnQeM+ETfvC0pMMRzgYT
nhwqYEPHEW4CLO0qPge5ttX58KBjqwDeH7MTw7m1a/Ww6HxFO8xKumuhJIyr
++gAfSvqnaGpqtUFFs8v2vfiX6qHA+QMtrHJfuHIcRhuo4yGZ742Z8ATmfU5
cLG0SATtq2Rd5F5nvgI+/LWtgrpNrpbcG42che2byeuwRWT1G9oIWaT5r0xY
fZivz3tB2mp1ANziy0np1ppQGGF+kwu5W9m8nc5k8mKgeY1fCtS9ozbAKkXe
AyiWsiVkbyzsglf4fDks60lWQT2t4BO0pUk/w6gt1yX4VhC7Br8NL23C6as/
aP2EU9EsC9i0+sYHdq/oMqCpUU+qj/wyMUSopv4zwozVRe9h5C84xweWZZWG
QMeQ+BTICNw3M418zVppISdTRKMpDWH3bifaQb/ySiEMlW/XQllMoxpKhIPv
ITU819+MMLGQGQj95/iFHMKjjBsCeOjpSqjnDpe1RjUU3Lll6kX4enjvLqgz
sWiBC3WqDlLb8kewPeD7E6gZ85DDPy/oSijznhmFEbIKJ2/Cs4bHpFUDAiZc
2DjtBhlNp/phlNj9Gfyb7cLw2WGthCIYIFRrx0kPSyWTHb2GsJg9k1PwP0Xu
Blg=
  "]],

Cell[TextData[{
 "Grid the volume of interest using ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "s"], TraditionalForm]]],
 " triangles, numbered as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"n", "=", "1"}], ",", "2", ",", "3", ",", "\[Ellipsis]", ",", 
    SubscriptBox["N", "s"]}], TraditionalForm]]],
 "\nDo the finite-element expansion\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Psi]", "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"n", "=", "1"}], 
      SubscriptBox["N", "s"]], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"m", "=", 
        RowBox[{"-", 
         SubscriptBox["N", "d"]}]}], 
       SubscriptBox["N", "d"]], 
      RowBox[{
       SubscriptBox["J", 
        RowBox[{"n", " ", "m"}]], 
       RowBox[{
        SubscriptBox["S", "n"], "(", 
        StyleBox["r",
         FontWeight->"Bold"], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]]}]}]}]}], 
   TraditionalForm]]],
 "\nThe number of the total degree of freedom (DOF) of the above expansion is \
",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["N", "s"], "(", 
    RowBox[{
     RowBox[{"2", 
      SubscriptBox["N", "d"]}], "+", "1"}], ")"}], TraditionalForm]]],
 ", compared to \[Infinity] of the true ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Psi]", "(", 
    RowBox[{
     StyleBox["r",
      FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["S", "n"], "(", 
     StyleBox["r",
      FontWeight->"Bold"], ")"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {"1", 
           RowBox[{"inside", " ", "triangle", " ", "n"}]},
          {"0", "elsewhere"}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], TraditionalForm]]],
 "\nHereafter, use the following shorthand notations\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["S", "n"], "(", 
    StyleBox["r",
     FontWeight->"Bold"], ")"}], TraditionalForm]]],
 " \t\tthe pulse function\n\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "n"], TraditionalForm]]],
 " \t\tthe ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]]],
 "-th triangle\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"S", "(", "n", ")"}], TraditionalForm]]],
 " \t\tthe area of the ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]]],
 "-th triangle\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"n", ",", "m"}]], 
    RowBox[{"=", 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"n", "=", "1"}], 
       SubscriptBox["N", "s"]], 
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"m", "=", 
        RowBox[{"-", 
         SubscriptBox["N", "d"]}]}], 
       SubscriptBox["N", "d"]]}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Psi]", 
      RowBox[{"n", " ", "m"}]], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["S", "n"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]]}]}], 
   TraditionalForm]]],
 "\nWe have\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Psi]", "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"n", ",", "m"}]], 
     RowBox[{
      SubscriptBox["J", 
       RowBox[{"n", " ", "m"}]], 
      RowBox[{
       SubscriptBox["\[Psi]", 
        RowBox[{"n", " ", "m"}]], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}]}], TraditionalForm]]],
 "\nThe goal is to find out such a set of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["J", 
    RowBox[{"n", " ", "m"}]], TraditionalForm]]],
 " that the above finite series best represents the true ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Psi]", "(", 
    RowBox[{
     StyleBox["r",
      FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], TraditionalForm]]],
 "\nThe volume integral equation\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]", "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "-", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Psi]", "s"], "[", "\[Psi]", "]"}], 
      RowBox[{"(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "=", 
    RowBox[{
     SuperscriptBox["\[Psi]", "i"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}], TraditionalForm]]],
 "\nnow reads\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"n", ",", "m"}]], 
     RowBox[{
      SubscriptBox["J", 
       RowBox[{"n", " ", "m"}]], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Psi]", 
          RowBox[{"n", " ", "m"}]], "(", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "-", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Psi]", "s"], "[", 
          SubscriptBox["\[Psi]", 
           RowBox[{"n", " ", "m"}]], "]"}], 
         RowBox[{"(", 
          RowBox[{
           StyleBox["r",
            FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "}"}]}]}], "=", 
    RowBox[{
     SuperscriptBox["\[Psi]", "i"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}], TraditionalForm]]],
 "\nChange the dummy indices from ",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    FormBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["n", "'"], ",", 
       SuperscriptBox["m", "'"]}], ")"}],
     TraditionalForm]}], TraditionalForm]]],
 " to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"n", ",", "m"}], ")"}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{
       SuperscriptBox["n", "'"], ",", 
       SuperscriptBox["m", "'"]}]], 
     RowBox[{
      SubscriptBox["J", 
       RowBox[{
        SuperscriptBox["n", "'"], ",", 
        SuperscriptBox["m", "'"]}]], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Psi]", 
          RowBox[{
           SuperscriptBox["n", "'"], ",", 
           SuperscriptBox["m", "'"]}]], "(", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "-", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Psi]", "s"], "[", 
          SubscriptBox["\[Psi]", 
           RowBox[{
            SuperscriptBox["n", "'"], ",", 
            SuperscriptBox["m", "'"]}]], "]"}], 
         RowBox[{"(", 
          RowBox[{
           StyleBox["r",
            FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "}"}]}]}], "=", 
    RowBox[{
     SuperscriptBox["\[Psi]", "i"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}], TraditionalForm]]],
 "\nFor a given ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"n", ",", "m"}], ")"}], TraditionalForm]]],
 ", multiply ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Psi]", 
     RowBox[{"n", " ", "m"}], "*"], "(", 
    RowBox[{
     StyleBox["r",
      FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], TraditionalForm]]],
 " on both sides and integrate (",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Integral]", 
    RowBox[{
     RowBox[{"\[DifferentialD]", 
      StyleBox["r",
       FontWeight->"Bold"]}], 
     RowBox[{"\[DifferentialD]", 
      StyleBox["\[Phi]",
       FontWeight->"Plain"]}]}]}], TraditionalForm]]],
 ") to get\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{
       SuperscriptBox["n", "'"], ",", 
       SuperscriptBox["m", "'"]}]], 
     RowBox[{
      SubscriptBox["J", 
       RowBox[{
        SuperscriptBox["n", "'"], ",", 
        SuperscriptBox["m", "'"]}]], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Integral]", 
         RowBox[{
          RowBox[{"\[DifferentialD]", 
           StyleBox["r",
            FontWeight->"Bold"]}], 
          RowBox[{"\[DifferentialD]", 
           StyleBox["\[Phi]",
            FontWeight->"Plain"]}], 
          StyleBox[" ",
           FontWeight->"Plain"], 
          RowBox[{
           SubsuperscriptBox["\[Psi]", 
            RowBox[{"n", " ", "m"}], "*"], "(", 
           RowBox[{
            StyleBox["r",
             FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], 
          RowBox[{
           SubscriptBox["\[Psi]", 
            RowBox[{
             SuperscriptBox["n", "'"], ",", 
             SuperscriptBox["m", "'"]}]], "(", 
           RowBox[{
            StyleBox["r",
             FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "-", 
        RowBox[{"\[Integral]", 
         RowBox[{
          RowBox[{"\[DifferentialD]", 
           StyleBox["r",
            FontWeight->"Bold"]}], 
          RowBox[{"\[DifferentialD]", 
           StyleBox["\[Phi]",
            FontWeight->"Plain"]}], 
          StyleBox[" ",
           FontWeight->"Plain"], 
          RowBox[{
           SubsuperscriptBox["\[Psi]", 
            RowBox[{"n", " ", "m"}], "*"], "(", 
           RowBox[{
            StyleBox["r",
             FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], 
          RowBox[{
           SuperscriptBox["\[Psi]", "s"], "[", 
           SubscriptBox["\[Psi]", 
            RowBox[{
             SuperscriptBox["n", "'"], ",", 
             SuperscriptBox["m", "'"]}]], "]"}], 
          RowBox[{"(", 
           RowBox[{
            StyleBox["r",
             FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}]}], "}"}]}]}], 
    "=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{"\[DifferentialD]", 
       StyleBox["\[Phi]",
        FontWeight->"Plain"]}], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      RowBox[{
       SubsuperscriptBox["\[Psi]", 
        RowBox[{"n", " ", "m"}], "*"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], 
      RowBox[{
       SuperscriptBox["\[Psi]", "i"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxN030s1HEcB3DucDeTx7VkprOVnO48jSjL4ylDhohxHmKYOG6YmdrVPNV5
GKUSx0hM43bOudY8LZbydJNR7VDn4WRyoQxtstbv/fvLH5+99vnu89nn+8fn
Y52UHZ5C0dLS8iQCBjC7C2J6Nn1YQkYdZJxWiWCIIbsbng1JlsNxPYFuLOFe
Tpw+dJ6UGsKVJ1csoE2jwgrK2zi+8L5KyIG2G+0BcNyuPwje9aSEwhIXVhSM
PLcTB011GXegNNbtAQx7W1MJFRUnh8l+atwHmP8rVQGzWy9rcwm/2OvrwWH2
HgNeH0xnQfNhTjjkd2bdghzjojR43lzEg/WjJhVwaaesGmbezmuCiZFP6TLC
0Kp5M+icV20BdcZEVjBrRW3ai3kxdmaQ3dfIIvNV12vQ10gWBG9+r4uHgQnV
yVDNzxRC08KuTrKuNU0KX/w+HIPKfc4cWffOfwE27UftwgahwR9oJGCSpo1o
M+V4311xgNTtInd4wJWQ6hkqvKEfrZwDOQdJAcedTQgIhrQSl2io/ESpgYXS
1BZY0c5qI3NNRics5nIlMKcnagyqqOmL0Jja/hVePbBegzO8kB24PrS2D6dL
f1JfE04FMenw2fZHJ9i9pYyHOhoVqcr/2/gg4QTlnwbGb6sdh7B/nslOMCeR
7wXNvcKioaXHmdlp7NeCwRxkJwipVNmmz/PHESbQJbdAAL0lh5WwK/jJBGwT
9H2GFN8UN13CiAyGB3Rb4mawCS9aPuTBC+Itb/tjbsxpJiCv9pGOA+H7oVMn
oFKb3gBXq8aaSY1zX8Im9x8dUDFqJ4FHA3oyOD10NAWX/eizcEas/gvzhS00
R/xn8YY+lNe+YsIdWakrXBfzL8GyuuVImCjeHggl7LetH4Qd9zgRNr3EXRYH
kjZP0kSiN5s+5fMjpP8BVBMStw==
  "]],

Cell[TextData[{
 "Note that\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Psi]", "s"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["\[Phi]", "'"]}], 
        RowBox[{"g", "(", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], ",", 
          RowBox[{"\[Phi]", ";", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]}], ",", 
          SuperscriptBox["\[Phi]", "'"]}], ")"}], 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], "(", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ")"}], 
        RowBox[{"\[Psi]", "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}], "+", 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"]}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["\[Phi]", "'"]}], 
       RowBox[{"g", "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         RowBox[{"\[Phi]", ";", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}], ",", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}], 
       RowBox[{
        SubscriptBox["\[Mu]", "s"], "(", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ")"}], 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["\[Phi]", "''"]}], 
         RowBox[{"f", "(", 
          RowBox[{"\[Phi]", "-", 
           SuperscriptBox["\[Phi]", "'"]}], ")"}], 
         RowBox[{"\[Psi]", "(", 
          RowBox[{
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"], ",", 
           SuperscriptBox["\[Phi]", "''"]}], ")"}]}]}]}]}]}]}], 
   TraditionalForm]]],
 "\nWrite\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}]], "=", 
    RowBox[{
     SubscriptBox["A", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", " ", "m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["n", "'"], 
         SuperscriptBox["m", "'"]}], ")"}]}]], "+", 
     SubscriptBox["B", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", " ", "m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["n", "'"], 
         SuperscriptBox["m", "'"]}], ")"}]}]]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}]], "=", 
    FormBox[
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        StyleBox["r",
         FontWeight->"Bold"]}], 
       RowBox[{"\[DifferentialD]", 
        StyleBox["\[Phi]",
         FontWeight->"Plain"]}], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{
        SubsuperscriptBox["\[Psi]", 
         RowBox[{"n", " ", "m"}], "*"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], 
       RowBox[{
        SubscriptBox["\[Psi]", 
         RowBox[{
          SuperscriptBox["n", "'"], ",", 
          SuperscriptBox["m", "'"]}]], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}],
     TraditionalForm]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["B", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}]], "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         StyleBox["r",
          FontWeight->"Bold"]}], 
        RowBox[{"\[DifferentialD]", 
         StyleBox["\[Phi]",
          FontWeight->"Plain"]}], 
        StyleBox[" ",
         FontWeight->"Plain"], 
        RowBox[{
         SubsuperscriptBox["\[Psi]", 
          RowBox[{"n", " ", "m"}], "*"], "(", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], 
        RowBox[{
         SuperscriptBox["\[Psi]", "s"], "[", 
         SubscriptBox["\[Psi]", 
          RowBox[{
           SuperscriptBox["n", "'"], ",", 
           SuperscriptBox["m", "'"]}]], "]"}], 
        RowBox[{"(", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}]}], "=", 
     RowBox[{
      SubsuperscriptBox["B", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", " ", "m"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["n", "'"], 
          SuperscriptBox["m", "'"]}], ")"}]}], "\[Sigma]"], "+", 
      SubsuperscriptBox["B", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", " ", "m"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["n", "'"], 
          SuperscriptBox["m", "'"]}], ")"}]}], "f"]}]}]}], TraditionalForm]]],
 "\n\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["B", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}], "\[Sigma]"], "=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{"\[DifferentialD]", 
       StyleBox["\[Phi]",
        FontWeight->"Plain"]}], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      RowBox[{
       SubsuperscriptBox["\[Psi]", 
        RowBox[{"n", " ", "m"}], "*"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["\[Phi]", "'"]}], 
        RowBox[{"g", "(", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], ",", 
          RowBox[{"\[Phi]", ";", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]}], ",", 
          SuperscriptBox["\[Phi]", "'"]}], ")"}], 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], "(", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ")"}], 
        RowBox[{
         SubscriptBox["\[Psi]", 
          RowBox[{
           SuperscriptBox["n", "'"], ",", 
           SuperscriptBox["m", "'"]}]], "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}]}]}], TraditionalForm]]],
 "\n\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["B", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}], "f"], "=", 
    RowBox[{"-", 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        StyleBox["r",
         FontWeight->"Bold"]}], 
       RowBox[{"\[DifferentialD]", 
        StyleBox["\[Phi]",
         FontWeight->"Plain"]}], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{
        SubsuperscriptBox["\[Psi]", 
         RowBox[{"n", " ", "m"}], "*"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["\[Phi]", "'"]}], 
         RowBox[{"g", "(", 
          RowBox[{
           StyleBox["r",
            FontWeight->"Bold"], ",", 
           RowBox[{"\[Phi]", ";", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "'"]}], ",", 
           SuperscriptBox["\[Phi]", "'"]}], ")"}], 
         RowBox[{
          SubscriptBox["\[Mu]", "s"], "(", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ")"}], 
         RowBox[{"\[Integral]", 
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            SuperscriptBox["\[Phi]", "''"]}], 
           RowBox[{"f", "(", 
            RowBox[{
             SuperscriptBox["\[Phi]", "'"], "-", 
             SuperscriptBox["\[Phi]", "''"]}], ")"}], 
           RowBox[{
            SubscriptBox["\[Psi]", 
             RowBox[{
              SuperscriptBox["n", "'"], ",", 
              SuperscriptBox["m", "'"]}]], "(", 
            RowBox[{
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "'"], ",", 
             SuperscriptBox["\[Phi]", "''"]}], ")"}]}]}]}]}]}]}]}]}], 
   TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["V", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}]], "=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{"\[DifferentialD]", 
       StyleBox["\[Phi]",
        FontWeight->"Plain"]}], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      RowBox[{
       SubsuperscriptBox["\[Psi]", 
        RowBox[{"n", " ", "m"}], "*"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], 
      RowBox[{
       SuperscriptBox["\[Psi]", "i"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}]}], TraditionalForm]]],
 "\nNote that ",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]]],
 " is a matrix with indices ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", " ", "m"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["n", "'"], 
      SuperscriptBox["m", "'"]}], ")"}]}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox["J", TraditionalForm]]],
 " is a column vector with indices ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"n", " ", "m"}], ")"}], TraditionalForm]]],
 "\nWith these notations, the integral equation converts to a system of \
linear equations for ",
 Cell[BoxData[
  FormBox["J", TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Z", " ", "J"}], "=", "V"}], TraditionalForm]]],
 "\nWith\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Psi]", 
      RowBox[{"n", " ", "m"}]], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["S", "n"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]]}]}], 
   TraditionalForm]]],
 "\ndo",
 StyleBox["\n",
  FontSlant->"Italic"],
 "\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox["A", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}]], "=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{"\[DifferentialD]", 
       StyleBox["\[Phi]",
        FontWeight->"Plain"]}], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      RowBox[{
       SubsuperscriptBox["\[Psi]", 
        RowBox[{"n", " ", "m"}], "*"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], 
      RowBox[{
       SubscriptBox["\[Psi]", 
        RowBox[{
         SuperscriptBox["n", "'"], ",", 
         SuperscriptBox["m", "'"]}]], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], " ", 
      RowBox[{
       SubscriptBox["S", "n"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       SubscriptBox["S", 
        SuperscriptBox["n", "'"]], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", "\[Phi]"}], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"+", "\[ImaginaryI]"}], " ", 
          SuperscriptBox["m", "'"], " ", "\[Phi]"}]]}]}]}]}]}], 
   TraditionalForm]}]],
 "\nUse the 1-point quadrature rule to do the integral over ",
 Cell[BoxData[
  FormBox[
   StyleBox["r",
    FontWeight->"Bold"], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{
       SubscriptBox["S", "n"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       SubscriptBox["S", 
        SuperscriptBox["n", "'"]], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}]}]}], "=", 
    RowBox[{
     RowBox[{"S", "(", "n", ")"}], 
     SubscriptBox["\[Delta]", 
      RowBox[{"n", " ", 
       SuperscriptBox["n", "'"]}]]}]}], TraditionalForm]]],
 "\nAlso note that\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", "\[Phi]"}], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"+", "\[ImaginaryI]"}], " ", 
        SuperscriptBox["m", "'"], " ", "\[Phi]"}]]}]}], "=", 
    RowBox[{"2", "\[Pi]", " ", 
     SubscriptBox["\[Delta]", 
      RowBox[{"m", " ", 
       SuperscriptBox["m", "'"]}]]}]}], TraditionalForm]]],
 "\nWe got a diagonal matrix, which is called the ",
 StyleBox["identity term",
  FontSlant->"Italic"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}]], "=", 
    RowBox[{"2", "\[Pi]", " ", 
     RowBox[{"S", "(", "n", ")"}], 
     SubscriptBox["\[Delta]", 
      RowBox[{"n", " ", 
       SuperscriptBox["n", "'"]}]], 
     SubscriptBox["\[Delta]", 
      RowBox[{"m", " ", 
       SuperscriptBox["m", "'"]}]]}]}], TraditionalForm]]],
 "\nUsing the plane-wave incidence assumption\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Psi]", "i"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{"\[Delta]", "(", 
     RowBox[{"\[Phi]", "-", 
      SuperscriptBox["\[Phi]", "i"]}], ")"}]}], TraditionalForm]]],
 "\nto calculate\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox["V", 
     RowBox[{"n", " ", "m"}]], "=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{"\[DifferentialD]", 
       StyleBox["\[Phi]",
        FontWeight->"Plain"]}], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      RowBox[{
       SubsuperscriptBox["\[Psi]", 
        RowBox[{"n", " ", "m"}], "*"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], 
      RowBox[{
       SuperscriptBox["\[Psi]", "i"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{"\[DifferentialD]", "\[Phi]"}], " ", 
      RowBox[{
       SubscriptBox["S", "n"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
      RowBox[{"\[Delta]", "(", 
       RowBox[{"\[Phi]", "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"\[TildeEqual]", 
    RowBox[{
     RowBox[{"S", "(", "n", ")"}], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       SuperscriptBox["\[Phi]", "i"]}]]}]}], TraditionalForm]}]]
}], "Text",
 CellChangeTimes->{{3.582645189473789*^9, 3.5826454330167446`*^9}, {
   3.582645470940567*^9, 3.582645625407996*^9}, {3.5826456671032887`*^9, 
   3.582646315938328*^9}, {3.5826463549202824`*^9, 3.582646389524682*^9}, {
   3.5826464819244237`*^9, 3.582646518394061*^9}, {3.5826468021451054`*^9, 
   3.5826468203084106`*^9}, {3.5826468531845894`*^9, 
   3.5826468778177223`*^9}, {3.5826469120701275`*^9, 
   3.5826469693814106`*^9}, {3.582647023473307*^9, 3.582647257000619*^9}, {
   3.5826473537299423`*^9, 3.582647396523354*^9}, {3.582647808673315*^9, 
   3.5826478589067116`*^9}, {3.582647907216853*^9, 3.5826483298323283`*^9}, {
   3.5826483683182173`*^9, 3.5826485836305847`*^9}, {3.582648675304236*^9, 
   3.582648978148449*^9}, {3.5826490994583054`*^9, 3.5826491480644855`*^9}, {
   3.5826491968466983`*^9, 3.5826494325552487`*^9}, {3.582649468216781*^9, 
   3.582649579637991*^9}, {3.5828245166666718`*^9, 3.5828246067985*^9}, {
   3.582824660482934*^9, 3.582824692868044*^9}, {3.5828266471212683`*^9, 
   3.582826649323578*^9}, {3.5828268528976045`*^9, 3.5828270656839294`*^9}, {
   3.5828271015643625`*^9, 3.582827252746745*^9}, {3.582827292480382*^9, 
   3.58282759538878*^9}, {3.582827861358651*^9, 3.582827907238557*^9}, {
   3.5828280958419957`*^9, 3.58282818615501*^9}, {3.582828242180162*^9, 
   3.582828434748732*^9}, {3.582828472391797*^9, 3.582828473296638*^9}, {
   3.5828288720548587`*^9, 3.5828289270608644`*^9}, {3.582828996091554*^9, 
   3.582828997448848*^9}, {3.582829062376712*^9, 3.5828290923133864`*^9}, {
   3.5828291230925617`*^9, 3.5828291230925617`*^9}, {3.582829154261697*^9, 
   3.5828292496411166`*^9}, {3.582829696088482*^9, 3.5828298272090425`*^9}, {
   3.582829857395208*^9, 3.5828299073724947`*^9}, {3.582829938886293*^9, 
   3.582830138740411*^9}, {3.582830299281722*^9, 3.582830309156624*^9}, {
   3.5828303690613127`*^9, 3.582830458450905*^9}, {3.582830511148181*^9, 
   3.5828306233913336`*^9}, {3.582830657290502*^9, 3.5828309904978743`*^9}, {
   3.582831350779014*^9, 3.5828313509661884`*^9}, {3.5828465349147787`*^9, 
   3.58284681593784*^9}, {3.5828473671228476`*^9, 3.5828473711013556`*^9}, {
   3.582847483511773*^9, 3.582847682538952*^9}, {3.5828834729759655`*^9, 
   3.5828834916493855`*^9}, {3.5829904849882083`*^9, 3.582990505642833*^9}, 
   3.582991475464223*^9, {3.582991738775687*^9, 3.5829917551598186`*^9}, {
   3.58299205354672*^9, 3.5829921541994867`*^9}, {3.5829922176995573`*^9, 
   3.582992254312211*^9}, {3.58299234762407*^9, 3.5829924276912937`*^9}, {
   3.5829924672033157`*^9, 3.582992483517413*^9}, {3.5829925349888835`*^9, 
   3.582992540801622*^9}, {3.582992580683738*^9, 3.5829925887047844`*^9}, {
   3.582992631182107*^9, 3.582992712080389*^9}, {3.582992869573407*^9, 
   3.582992932049363*^9}, {3.582993037335775*^9, 3.582993193901626*^9}, {
   3.582993225496691*^9, 3.582993287087469*^9}, {3.582993333392355*^9, 
   3.5829933597247314`*^9}, {3.5829949423328447`*^9, 
   3.5829950314931765`*^9}, {3.5830155613156214`*^9, 3.583015569642681*^9}, {
   3.5830824916855044`*^9, 3.5830825036679974`*^9}, {3.583082537836343*^9, 
   3.583082538046367*^9}, {3.583082584155227*^9, 3.583082584809312*^9}, {
   3.583083279606778*^9, 3.5830833258446493`*^9}, {3.583083358227765*^9, 
   3.583083358227765*^9}, {3.5830833986735826`*^9, 3.583083915119087*^9}, {
   3.5830839781781015`*^9, 3.5830839888144536`*^9}, {3.583084019197316*^9, 
   3.5830840877990336`*^9}, {3.583084118494937*^9, 3.583084137663373*^9}, {
   3.5830842024756107`*^9, 3.583084223150238*^9}, {3.583084311297417*^9, 
   3.5830843159470077`*^9}, {3.583084763987956*^9, 3.583084763987956*^9}, {
   3.583149391267118*^9, 3.5831494211933146`*^9}, {3.5831494853323584`*^9, 
   3.583149485333358*^9}, {3.5831495496353455`*^9, 3.583149581603406*^9}, {
   3.583150916222351*^9, 3.583150921426037*^9}, {3.583151302884775*^9, 
   3.5831513028857756`*^9}, {3.5836040396733685`*^9, 3.583604045178037*^9}, {
   3.5838358056983337`*^9, 3.583835838932336*^9}, {3.583835970701598*^9, 
   3.5838359707016687`*^9}, {3.585924330425787*^9, 3.585924336909011*^9}, {
   3.586192319272399*^9, 3.586192319272464*^9}}],

Cell[TextData[{
 "Before doing ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]]],
 ", let\[CloseCurlyQuote]s remember that, in 2D, the Green\[CloseCurlyQuote]s \
function that propagates point source ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      StyleBox["r",
       FontWeight->"Bold"], "'"], ",", 
     SuperscriptBox[
      StyleBox["v",
       FontWeight->"Bold"], "'"]}], ")"}], TraditionalForm]]],
 " to field point ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     StyleBox["r",
      FontWeight->"Bold"], ",", 
     StyleBox["v",
      FontWeight->"Bold"]}], ")"}], TraditionalForm]]],
 " is\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"g", "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      RowBox[{"\[Phi]", ";", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], ",", 
      SuperscriptBox["\[Phi]", "'"]}], ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      TemplateBox[{RowBox[{
          StyleBox["r", FontWeight -> "Bold"], "-", 
          SuperscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "'"]}]},
       "Abs"]], Cell[""], 
     RowBox[{"\[Delta]", "(", 
      RowBox[{"\[Phi]", "-", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]]}], ")"}], 
     RowBox[{"\[Delta]", "(", 
      RowBox[{
       SuperscriptBox["\[Phi]", "'"], "-", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]]}], ")"}]}]}], TraditionalForm]]],
 "\nAssume that the cross-sections remain constant in each ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "n"], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Mu]", "i"], "(", 
     StyleBox["r",
      FontWeight->"Bold"], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "i"], "(", "n", ")"}], "=", 
     RowBox[{"constant", "  ", 
      RowBox[{"\[ForAll]", 
       RowBox[{"r", "\[Element]", 
        RowBox[{
         SubscriptBox["S", "n"], " ", "for", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"i", "=", "a"}], ",", "s", ",", "t"}], ")"}]}]}]}]}]}]}], 
   TraditionalForm]]],
 "\nAgain, use the 1-point quadrature rule to do the integrals over  ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["r",
     FontWeight->"Bold"], "'"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   StyleBox["r",
    FontWeight->"Bold"], TraditionalForm]]],
 " for ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["B", "\[Sigma]"], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[{
  FormBox[
   SubsuperscriptBox["B", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", " ", "m"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["n", "'"], 
       SuperscriptBox["m", "'"]}], ")"}]}], "\[Sigma]"], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{"\[DifferentialD]", 
       StyleBox["\[Phi]",
        FontWeight->"Plain"]}], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      RowBox[{
       SubscriptBox["S", "n"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["\[Phi]", "'"]}], 
        RowBox[{"g", "(", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], ",", 
          RowBox[{"\[Phi]", ";", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]}], ",", 
          SuperscriptBox["\[Phi]", "'"]}], ")"}], 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], "(", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ")"}], 
        RowBox[{
         SubscriptBox["S", 
          SuperscriptBox["n", "'"]], "(", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ")"}], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"+", "\[ImaginaryI]"}], " ", 
          SuperscriptBox["m", "'"], 
          SuperscriptBox["\[Phi]", "'"]}]]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"S", "(", "n", ")"}], 
      RowBox[{"\[DifferentialD]", 
       StyleBox["\[Phi]",
        FontWeight->"Plain"]}], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"S", "(", 
         SuperscriptBox["n", "'"], ")"}], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["\[Phi]", "'"]}], 
        RowBox[{"g", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], ",", 
          RowBox[{"\[Phi]", ";", 
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            SuperscriptBox["n", "'"]]}], ",", 
          SuperscriptBox["\[Phi]", "'"]}], ")"}], 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], "(", 
         SuperscriptBox["n", "'"], ")"}], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"+", "\[ImaginaryI]"}], " ", 
          SuperscriptBox["m", "'"], 
          SuperscriptBox["\[Phi]", "'"]}]]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "t"], "(", 
      SuperscriptBox["n", "'"], ")"}], 
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{"S", "(", 
      SuperscriptBox["n", "'"], ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        StyleBox["\[Phi]",
         FontWeight->"Plain"]}], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["\[Phi]", "'"]}], 
         RowBox[{"g", "(", 
          RowBox[{
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "n"], ",", 
           RowBox[{"\[Phi]", ";", 
            SubscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], 
             SuperscriptBox["n", "'"]]}], ",", 
           SuperscriptBox["\[Phi]", "'"]}], ")"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"+", "\[ImaginaryI]"}], " ", 
           SuperscriptBox["m", "'"], 
           SuperscriptBox["\[Phi]", "'"]}]]}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "t"], "(", 
      SuperscriptBox["n", "'"], ")"}], 
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{"S", "(", 
      SuperscriptBox["n", "'"], ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        StyleBox["\[Phi]",
         FontWeight->"Plain"]}], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["\[Phi]", "'"]}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"+", "\[ImaginaryI]"}], " ", 
           SuperscriptBox["m", "'"], 
           SuperscriptBox["\[Phi]", "'"]}]], 
         FractionBox["1", 
          TemplateBox[{RowBox[{
              SubscriptBox[
               StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
              SubscriptBox[
               StyleBox["r", FontWeight -> "Bold"], 
               SuperscriptBox["n", "'"]]}]},
           "Abs"]], Cell[""], 
         RowBox[{"\[Delta]", "(", 
          RowBox[{"\[Phi]", "-", 
           SubscriptBox["\[Phi]", 
            RowBox[{
             SubscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "n"], "-", 
             SubscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], 
              SuperscriptBox["n", "'"]]}]]}], ")"}], 
         RowBox[{"\[Delta]", "(", 
          RowBox[{
           SuperscriptBox["\[Phi]", "'"], "-", 
           SubscriptBox["\[Phi]", 
            RowBox[{
             SubscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "n"], "-", 
             SubscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], 
              SuperscriptBox["n", "'"]]}]]}], ")"}]}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "t"], "(", 
      SuperscriptBox["n", "'"], ")"}], 
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{"S", "(", 
      SuperscriptBox["n", "'"], ")"}], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[ImaginaryI]", "(", 
          RowBox[{"m", "-", 
           SuperscriptBox["m", "'"]}], ")"}]}], " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]]}]]}]], "/", 
      TemplateBox[{RowBox[{
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           SuperscriptBox["n", "'"]]}]},
       "Abs"]}], Cell[""], 
     RowBox[{"\[ForAll]", 
      RowBox[{"n", "\[NotEqual]", 
       SuperscriptBox["n", "'"]}]}]}]}], TraditionalForm]}]],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["r",
     FontWeight->"Bold"], "n"], TraditionalForm]]],
 " is the center position of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "n"], TraditionalForm]]],
 " (the ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]]],
 "-th triangle)\nNote that the above result diverges for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    SuperscriptBox["n", "'"]}], TraditionalForm]]],
 ", need to calculate the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    SuperscriptBox["n", "'"]}], TraditionalForm]]],
 " elements separately later\nSimilarly, using the 2D Henyey-Greenstein phase \
function from the Liemert paper\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", 
     RowBox[{"\[Phi]", ",", 
      SuperscriptBox["\[Phi]", "'"]}], ")"}], "=", 
    RowBox[{
     RowBox[{"f", "(", 
      RowBox[{"\[Phi]", "-", 
       SuperscriptBox["\[Phi]", "'"]}], ")"}], "=", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", "\[DoubledPi]"}]], 
       FractionBox[
        RowBox[{"1", "-", 
         SuperscriptBox["g", "2"]}], 
        RowBox[{"1", "+", 
         SuperscriptBox["g", "2"], "-", 
         RowBox[{"2", "g", " ", 
          RowBox[{"cos", "(", 
           RowBox[{"\[Phi]", "-", 
            SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]]}], "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", "\[DoubledPi]"}]], 
       RowBox[{
        SubsuperscriptBox["\[Sum]", 
         RowBox[{"m", "=", 
          RowBox[{"-", "\[Infinity]"}]}], "\[Infinity]"], 
        RowBox[{
         SuperscriptBox["g", 
          TemplateBox[{"m"},
           "Abs"]], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"m", "(", 
            RowBox[{"\[Phi]", "-", 
             SuperscriptBox["\[Phi]", "'"]}], ")"}]}]]}]}]}]}]}]}], 
   TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "m"], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       RowBox[{"2", "\[DoubledPi]"}]], 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["\[Phi]", "'"]}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"m", "(", 
          RowBox[{
           SuperscriptBox["\[Phi]", "'"], "-", "\[Phi]"}], ")"}]}]], 
       RowBox[{"f", "(", 
        RowBox[{"\[Phi]", "-", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}], "=", 
     SuperscriptBox["g", 
      TemplateBox[{"m"},
       "Abs"]]}]}], TraditionalForm]]],
 "\nto calculate ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["B", "f"], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[{
  FormBox[
   SubsuperscriptBox["B", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", " ", "m"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["n", "'"], 
       SuperscriptBox["m", "'"]}], ")"}]}], "f"], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"-", 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        StyleBox["r",
         FontWeight->"Bold"]}], 
       RowBox[{"\[DifferentialD]", 
        StyleBox["\[Phi]",
         FontWeight->"Plain"]}], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{
        SubscriptBox["S", "n"], "(", 
        StyleBox["r",
         FontWeight->"Bold"], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["\[Phi]", "'"]}], 
         RowBox[{"g", "(", 
          RowBox[{
           StyleBox["r",
            FontWeight->"Bold"], ",", 
           RowBox[{"\[Phi]", ";", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "'"]}], ",", 
           SuperscriptBox["\[Phi]", "'"]}], ")"}], 
         RowBox[{
          SubscriptBox["\[Mu]", "s"], "(", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ")"}], 
         RowBox[{"\[Integral]", 
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            SuperscriptBox["\[Phi]", "''"]}], 
           RowBox[{"f", "(", 
            RowBox[{
             SuperscriptBox["\[Phi]", "'"], "-", 
             SuperscriptBox["\[Phi]", "''"]}], ")"}], 
           RowBox[{
            SubscriptBox["S", 
             SuperscriptBox["n", "'"]], "(", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "'"], ")"}], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"+", "\[ImaginaryI]"}], " ", 
             SuperscriptBox["m", "'"], 
             SuperscriptBox["\[Phi]", "''"]}]]}]}]}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"-", 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        StyleBox["r",
         FontWeight->"Bold"]}], 
       RowBox[{"\[DifferentialD]", 
        StyleBox["\[Phi]",
         FontWeight->"Plain"]}], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{
        SubscriptBox["S", "n"], "(", 
        StyleBox["r",
         FontWeight->"Bold"], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["\[Phi]", "'"]}], 
         RowBox[{
          SubscriptBox["S", 
           SuperscriptBox["n", "'"]], "(", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ")"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"+", "\[ImaginaryI]"}], " ", 
           SuperscriptBox["m", "'"], 
           SuperscriptBox["\[Phi]", "'"]}]], 
         RowBox[{"g", "(", 
          RowBox[{
           StyleBox["r",
            FontWeight->"Bold"], ",", 
           RowBox[{"\[Phi]", ";", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "'"]}], ",", 
           SuperscriptBox["\[Phi]", "'"]}], ")"}], 
         RowBox[{
          SubscriptBox["\[Mu]", "s"], "(", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ")"}], 
         RowBox[{"\[Integral]", 
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            SuperscriptBox["\[Phi]", "''"]}], 
           RowBox[{"f", "(", 
            RowBox[{
             SuperscriptBox["\[Phi]", "'"], "-", 
             SuperscriptBox["\[Phi]", "''"]}], ")"}], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"+", "\[ImaginaryI]"}], " ", 
             RowBox[{
              SuperscriptBox["m", "'"], "(", 
              RowBox[{
               SuperscriptBox["\[Phi]", "''"], "-", 
               SuperscriptBox["\[Phi]", "'"]}], ")"}]}]]}]}]}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"-", 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        StyleBox["r",
         FontWeight->"Bold"]}], 
       RowBox[{"\[DifferentialD]", 
        StyleBox["\[Phi]",
         FontWeight->"Plain"]}], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       RowBox[{
        SubscriptBox["S", "n"], "(", 
        StyleBox["r",
         FontWeight->"Bold"], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["\[Phi]", "'"]}], 
         RowBox[{
          SubscriptBox["S", 
           SuperscriptBox["n", "'"]], "(", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ")"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"+", "\[ImaginaryI]"}], " ", 
           SuperscriptBox["m", "'"], 
           SuperscriptBox["\[Phi]", "'"]}]], 
         RowBox[{"g", "(", 
          RowBox[{
           StyleBox["r",
            FontWeight->"Bold"], ",", 
           RowBox[{"\[Phi]", ";", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "'"]}], ",", 
           SuperscriptBox["\[Phi]", "'"]}], ")"}], 
         RowBox[{
          SubscriptBox["\[Mu]", "s"], "(", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ")"}], 
         SuperscriptBox["g", 
          TemplateBox[{SuperscriptBox["m", "'"]},
           "Abs"]], 
         RowBox[{"\[ForAll]", 
          RowBox[{"n", "\[NotEqual]", 
           SuperscriptBox["n", "'"]}]}]}]}]}]}]}]}], TraditionalForm]}]],
 "\nCompare to the calculation of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["B", "\[Sigma]"], TraditionalForm]]],
 ", making following replacements in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["B", "\[Sigma]"], TraditionalForm]]],
 ":\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", "minus", ")"}]}], "\[Rule]", 
    RowBox[{"+", 
     RowBox[{"(", "plus", ")"}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Mu]", "t"], "(", 
     SuperscriptBox["n", "'"], ")"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      SuperscriptBox["n", "'"], ")"}], 
     SuperscriptBox["g", 
      TemplateBox[{SuperscriptBox["m", "'"]},
       "Abs"]]}]}], TraditionalForm]]],
 "\nto get\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["B", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}], "f"], "=", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox["n", "'"], ")"}]}], 
     SuperscriptBox["g", 
      TemplateBox[{SuperscriptBox["m", "'"]},
       "Abs"]], 
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{"S", "(", 
      SuperscriptBox["n", "'"], ")"}], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[ImaginaryI]", "(", 
          RowBox[{"m", "-", 
           SuperscriptBox["m", "'"]}], ")"}]}], " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]]}]]}]], "/", 
      TemplateBox[{RowBox[{
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           SuperscriptBox["n", "'"]]}]},
       "Abs"]}], Cell[""], 
     RowBox[{"\[ForAll]", 
      RowBox[{"n", "\[NotEqual]", 
       SuperscriptBox["n", "'"]}]}]}]}], TraditionalForm]]],
 "\nFor ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    SuperscriptBox["n", "'"]}], TraditionalForm]]],
 ", still do the 1-point quadrature for the field point ",
 Cell[BoxData[
  FormBox[
   StyleBox["r",
    FontWeight->"Bold"], TraditionalForm]]],
 ", but treat the source point ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["r",
     FontWeight->"Bold"], "'"], TraditionalForm]]],
 " more carefully\n\t",
 Cell[BoxData[{
  FormBox[
   SubsuperscriptBox["B", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", " ", "m"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"n", " ", 
       SuperscriptBox["m", "'"]}], ")"}]}], "\[Sigma]"], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{"\[DifferentialD]", "\[Phi]"}], " ", 
      RowBox[{
       SubscriptBox["S", "n"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["\[Phi]", "'"]}], 
        RowBox[{"g", "(", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], ",", 
          RowBox[{"\[Phi]", ";", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]}], ",", 
          SuperscriptBox["\[Phi]", "'"]}], ")"}], 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], "(", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ")"}], 
        RowBox[{
         SubscriptBox["S", "n"], "(", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ")"}], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"+", "\[ImaginaryI]"}], " ", 
          SuperscriptBox["m", "'"], 
          SuperscriptBox["\[Phi]", "'"]}]]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "t"], "(", "n", ")"}], 
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", "\[Phi]"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["\[Phi]", "'"]}], 
         FractionBox["1", 
          TemplateBox[{RowBox[{
              SubscriptBox[
               StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
              SubscriptBox[
               StyleBox["r", FontWeight -> "Bold"], 
               SuperscriptBox["n", "'"]]}]},
           "Abs"]], Cell[""], 
         RowBox[{"\[Delta]", "(", 
          RowBox[{"\[Phi]", "-", 
           SubscriptBox["\[Phi]", 
            RowBox[{
             SubscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "n"], "-", 
             SubscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], 
              SuperscriptBox["n", "'"]]}]]}], ")"}], 
         RowBox[{"\[Delta]", "(", 
          RowBox[{
           SuperscriptBox["\[Phi]", "'"], "-", 
           SubscriptBox["\[Phi]", 
            RowBox[{
             SubscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "n"], "-", 
             SubscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], 
              SuperscriptBox["n", "'"]]}]]}], ")"}], 
         RowBox[{
          SubscriptBox["S", "n"], "(", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ")"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"+", "\[ImaginaryI]"}], " ", 
           SuperscriptBox["m", "'"], 
           SuperscriptBox["\[Phi]", "'"]}]]}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    OverscriptBox["=", 
     RowBox[{
      StyleBox["R",
       FontWeight->"Bold"], "=", 
      RowBox[{
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"], "-", 
       SubscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "n"]}]}]], 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "t"], "(", "n", ")"}], 
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", "\[Phi]"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          StyleBox["R",
           FontWeight->"Bold"]}], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["\[Phi]", "'"]}], 
         FractionBox["1", "R"], Cell[""], 
         RowBox[{"\[Delta]", "(", 
          RowBox[{"\[Phi]", "+", 
           SubscriptBox["\[Phi]", 
            StyleBox["R",
             FontWeight->"Bold"]]}], ")"}], 
         RowBox[{"\[Delta]", "(", 
          RowBox[{
           SuperscriptBox["\[Phi]", "'"], "+", 
           SubscriptBox["\[Phi]", 
            StyleBox["R",
             FontWeight->"Bold"]]}], ")"}], 
         RowBox[{
          SubscriptBox["S", "n"], "(", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ")"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"+", "\[ImaginaryI]"}], " ", 
           SuperscriptBox["m", "'"], 
           SuperscriptBox["\[Phi]", "'"]}]]}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "t"], "(", "n", ")"}], 
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       FractionBox[
        RowBox[{"\[DifferentialD]", 
         StyleBox["R",
          FontWeight->"Bold"]}], "R"], 
       RowBox[{
        SubscriptBox["S", "n"], "(", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ")"}], 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", "\[Phi]"}], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
         RowBox[{"\[Delta]", "(", 
          RowBox[{"\[Phi]", "+", 
           SubscriptBox["\[Phi]", 
            StyleBox["R",
             FontWeight->"Bold"]]}], ")"}], 
         RowBox[{"\[Integral]", 
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            SuperscriptBox["\[Phi]", "'"]}], Cell[""], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"+", "\[ImaginaryI]"}], " ", 
             SuperscriptBox["m", "'"], 
             SuperscriptBox["\[Phi]", "'"]}]], 
           RowBox[{"\[Delta]", "(", 
            RowBox[{
             SuperscriptBox["\[Phi]", "'"], "+", 
             SubscriptBox["\[Phi]", 
              StyleBox["R",
               FontWeight->"Bold"]]}], ")"}]}]}]}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "t"], "(", "n", ")"}], 
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", "R"}], 
       RowBox[{"\[DifferentialD]", 
        SubscriptBox["\[Phi]", 
         StyleBox["R",
          FontWeight->"Bold"]]}], 
       RowBox[{
        SubscriptBox["S", "n"], "(", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"m", "-", 
           SuperscriptBox["m", "'"]}], ")"}], 
         SubscriptBox["\[Phi]", 
          StyleBox["R",
           FontWeight->"Bold"]]}]]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "t"], "(", "n", ")"}], 
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", "R"}], " ", 
       RowBox[{
        SubscriptBox["S", "n"], "(", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ")"}], 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          SubscriptBox["\[Phi]", 
           StyleBox["R",
            FontWeight->"Bold"]]}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"m", "-", 
             SuperscriptBox["m", "'"]}], ")"}], 
           SubscriptBox["\[Phi]", 
            StyleBox["R",
             FontWeight->"Bold"]]}]]}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    OverscriptBox["=", 
     RowBox[{
      SubscriptBox["S", "n"], "\[TildeEqual]", 
      RowBox[{"Circle", " ", "of", " ", "area", " ", 
       RowBox[{"S", "(", "n", ")"}]}]}]], 
    RowBox[{"2", "\[Pi]", " ", 
     SubscriptBox["\[Delta]", 
      RowBox[{"m", " ", 
       SuperscriptBox["m", "'"]}]], 
     RowBox[{
      SubscriptBox["\[Mu]", "t"], "(", 
      SuperscriptBox["n", "'"], ")"}], 
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{"Radius", "(", "n", ")"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"2", "\[Pi]", " ", 
     SubscriptBox["\[Delta]", 
      RowBox[{"m", " ", 
       SuperscriptBox["m", "'"]}]], 
     RowBox[{
      SubscriptBox["\[Mu]", "t"], "(", "n", ")"}], 
     RowBox[{"S", "(", "n", ")"}], 
     SqrtBox[
      RowBox[{
       RowBox[{"S", "(", "n", ")"}], "/", "\[Pi]"}]]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", "n", ")"}], 
      SubscriptBox["\[Delta]", 
       RowBox[{"m", " ", 
        SuperscriptBox["m", "'"]}]], 
      SuperscriptBox["\[Pi]", 
       RowBox[{"1", "/", "2"}]], 
      SuperscriptBox[
       RowBox[{"S", "(", "n", ")"}], 
       RowBox[{"3", "/", "2"}]], 
      RowBox[{"\[ForAll]", "n"}]}], "=", 
     SuperscriptBox["n", "'"]}]}], TraditionalForm]}]],
 "\nSimilarly\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["B", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}], "f"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
      SuperscriptBox["g", 
       TemplateBox[{SuperscriptBox["m", "'"]},
        "Abs"]], 
      SubscriptBox["\[Delta]", 
       RowBox[{"m", " ", 
        SuperscriptBox["m", "'"]}]], 
      SuperscriptBox["\[Pi]", 
       RowBox[{"1", "/", "2"}]], 
      SuperscriptBox[
       RowBox[{"S", "(", "n", ")"}], 
       RowBox[{"3", "/", "2"}]], 
      RowBox[{"\[ForAll]", "n"}]}], "=", 
     SuperscriptBox["n", "'"]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.582645189473789*^9, 3.5826454330167446`*^9}, {
   3.582645470940567*^9, 3.582645625407996*^9}, {3.5826456671032887`*^9, 
   3.582646315938328*^9}, {3.5826463549202824`*^9, 3.582646389524682*^9}, {
   3.5826464819244237`*^9, 3.582646518394061*^9}, {3.5826468021451054`*^9, 
   3.5826468203084106`*^9}, {3.5826468531845894`*^9, 
   3.5826468778177223`*^9}, {3.5826469120701275`*^9, 
   3.5826469693814106`*^9}, {3.582647023473307*^9, 3.582647257000619*^9}, {
   3.5826473537299423`*^9, 3.582647396523354*^9}, {3.582647808673315*^9, 
   3.5826478589067116`*^9}, {3.582647907216853*^9, 3.5826483298323283`*^9}, {
   3.5826483683182173`*^9, 3.5826485836305847`*^9}, {3.582648675304236*^9, 
   3.582648978148449*^9}, {3.5826490994583054`*^9, 3.5826491480644855`*^9}, {
   3.5826491968466983`*^9, 3.5826494325552487`*^9}, {3.582649468216781*^9, 
   3.582649579637991*^9}, {3.5828245166666718`*^9, 3.5828246067985*^9}, {
   3.582824660482934*^9, 3.582824692868044*^9}, {3.5828266471212683`*^9, 
   3.582826649323578*^9}, {3.5828268528976045`*^9, 3.5828270656839294`*^9}, {
   3.5828271015643625`*^9, 3.582827252746745*^9}, {3.582827292480382*^9, 
   3.58282759538878*^9}, {3.582827861358651*^9, 3.582827907238557*^9}, {
   3.5828280958419957`*^9, 3.58282818615501*^9}, {3.582828242180162*^9, 
   3.582828434748732*^9}, {3.582828472391797*^9, 3.582828473296638*^9}, {
   3.5828288720548587`*^9, 3.5828289270608644`*^9}, {3.582828996091554*^9, 
   3.582828997448848*^9}, {3.582829062376712*^9, 3.5828290923133864`*^9}, {
   3.5828291230925617`*^9, 3.5828291230925617`*^9}, {3.582829154261697*^9, 
   3.5828292496411166`*^9}, {3.582829696088482*^9, 3.5828298272090425`*^9}, {
   3.582829857395208*^9, 3.5828299073724947`*^9}, {3.582829938886293*^9, 
   3.582830138740411*^9}, {3.582830299281722*^9, 3.582830309156624*^9}, {
   3.5828303690613127`*^9, 3.582830458450905*^9}, {3.582830511148181*^9, 
   3.5828306233913336`*^9}, {3.582830657290502*^9, 3.5828309904978743`*^9}, {
   3.582831350779014*^9, 3.5828313509661884`*^9}, {3.5828465349147787`*^9, 
   3.58284681593784*^9}, {3.5828473671228476`*^9, 3.5828473711013556`*^9}, {
   3.582847483511773*^9, 3.582847682538952*^9}, {3.5828834729759655`*^9, 
   3.582883504738045*^9}, {3.5828837923770328`*^9, 3.5828837923770328`*^9}, {
   3.5829905176423583`*^9, 3.58299062246673*^9}, {3.582991482615137*^9, 
   3.582991489618022*^9}, {3.582991520348926*^9, 3.582991527291811*^9}, {
   3.582991786790789*^9, 3.582991786790789*^9}, {3.5829918247656174`*^9, 
   3.582991866708948*^9}, {3.582993288684718*^9, 3.5829932971807528`*^9}, {
   3.582993366791602*^9, 3.582993589712935*^9}, {3.5829936232472153`*^9, 
   3.58299394660734*^9}, {3.5829939928352165`*^9, 3.582994127214299*^9}, {
   3.582994202759847*^9, 3.582994254727479*^9}, {3.582994368584971*^9, 
   3.5829944144678044`*^9}, {3.582994513126295*^9, 3.582994518563986*^9}, {
   3.5829948020930214`*^9, 3.5829948122953157`*^9}, {3.582995070006771*^9, 
   3.5829951282899475`*^9}, {3.582995186978156*^9, 3.5829953385512466`*^9}, {
   3.582995394701404*^9, 3.582995491981083*^9}, {3.582995534599498*^9, 
   3.582995534599498*^9}, {3.5830767680173063`*^9, 3.583077009030854*^9}, {
   3.5830770436322527`*^9, 3.583077075030242*^9}, {3.5830771123789873`*^9, 
   3.58307711515234*^9}, {3.583084166761099*^9, 3.58308418147394*^9}, {
   3.5830842252355165`*^9, 3.5830842696491528`*^9}, {3.5830843060027437`*^9, 
   3.5830847543517284`*^9}, 3.5830847916574697`*^9, {3.5830848230134544`*^9, 
   3.583085308326354*^9}, {3.583085349580598*^9, 3.583085390481794*^9}, {
   3.583085475983308*^9, 3.583085488549921*^9}, {3.5830855301791954`*^9, 
   3.5830855301791954`*^9}, {3.58308560134524*^9, 3.583085606834964*^9}, {
   3.5831442277629485`*^9, 3.583144241698555*^9}, {3.5833598682066574`*^9, 
   3.583359883650867*^9}, {3.5835869889890103`*^9, 3.58358700573509*^9}, {
   3.585924375046873*^9, 3.5859244057844143`*^9}, {3.586186314842083*^9, 
   3.5861863245772467`*^9}, {3.588275349286728*^9, 3.588275349871766*^9}}],

Cell[TextData[{
 "List the results\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}]], "=", 
    RowBox[{"2", "\[Pi]", " ", 
     RowBox[{"S", "(", "n", ")"}], 
     SubscriptBox["\[Delta]", 
      RowBox[{"n", " ", 
       SuperscriptBox["n", "'"]}]], 
     SubscriptBox["\[Delta]", 
      RowBox[{"m", " ", 
       SuperscriptBox["m", "'"]}]]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["B", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}], "\[Sigma]"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "t"], "(", 
      SuperscriptBox["n", "'"], ")"}], 
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{"S", "(", 
      SuperscriptBox["n", "'"], ")"}], 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[ImaginaryI]", "(", 
          RowBox[{"m", "-", 
           SuperscriptBox["m", "'"]}], ")"}]}], " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]]}]]}], "]"}], "/", 
      TemplateBox[{RowBox[{
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           SuperscriptBox["n", "'"]]}]},
       "Abs"]}], 
     RowBox[{"\[ForAll]", 
      RowBox[{"n", "\[NotEqual]", 
       SuperscriptBox["n", "'"]}]}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["B", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}], "f"], "=", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox["n", "'"], ")"}]}], 
     SuperscriptBox["g", 
      TemplateBox[{SuperscriptBox["m", "'"]},
       "Abs"]], 
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{"S", "(", 
      SuperscriptBox["n", "'"], ")"}], 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[ImaginaryI]", "(", 
          RowBox[{"m", "-", 
           SuperscriptBox["m", "'"]}], ")"}]}], " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]]}]]}], "]"}], "/", 
      TemplateBox[{RowBox[{
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           SuperscriptBox["n", "'"]]}]},
       "Abs"]}], 
     RowBox[{"\[ForAll]", 
      RowBox[{"n", "\[NotEqual]", 
       SuperscriptBox["n", "'"]}]}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["B", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"n", " ", 
        SuperscriptBox["m", "'"]}], ")"}]}], "\[Sigma]"], "=", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", "n", ")"}], 
      SubscriptBox["\[Delta]", 
       RowBox[{"m", " ", 
        SuperscriptBox["m", "'"]}]], 
      SuperscriptBox["\[Pi]", 
       RowBox[{"1", "/", "2"}]], 
      SuperscriptBox[
       RowBox[{"S", "(", "n", ")"}], 
       RowBox[{"3", "/", "2"}]], 
      RowBox[{"\[ForAll]", "n"}]}], "=", 
     SuperscriptBox["n", "'"]}]}], TraditionalForm]]],
 "\t\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["B", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}], "f"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
      SuperscriptBox["g", 
       TemplateBox[{SuperscriptBox["m", "'"]},
        "Abs"]], 
      SubscriptBox["\[Delta]", 
       RowBox[{"m", " ", 
        SuperscriptBox["m", "'"]}]], 
      SuperscriptBox["\[Pi]", 
       RowBox[{"1", "/", "2"}]], 
      SuperscriptBox[
       RowBox[{"S", "(", "n", ")"}], 
       RowBox[{"3", "/", "2"}]], 
      RowBox[{"\[ForAll]", "n"}]}], "=", 
     SuperscriptBox["n", "'"]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["V", 
     RowBox[{"n", " ", "m"}]], "=", 
    RowBox[{
     RowBox[{"S", "(", "n", ")"}], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       SuperscriptBox["\[Phi]", "i"]}]]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.582645189473789*^9, 3.5826454330167446`*^9}, {
   3.582645470940567*^9, 3.582645625407996*^9}, {3.5826456671032887`*^9, 
   3.582646315938328*^9}, {3.5826463549202824`*^9, 3.582646389524682*^9}, {
   3.5826464819244237`*^9, 3.582646518394061*^9}, {3.5826468021451054`*^9, 
   3.5826468203084106`*^9}, {3.5826468531845894`*^9, 
   3.5826468778177223`*^9}, {3.5826469120701275`*^9, 
   3.5826469693814106`*^9}, {3.582647023473307*^9, 3.582647257000619*^9}, {
   3.5826473537299423`*^9, 3.582647396523354*^9}, {3.582647808673315*^9, 
   3.5826478589067116`*^9}, {3.582647907216853*^9, 3.5826483298323283`*^9}, {
   3.5826483683182173`*^9, 3.5826485836305847`*^9}, {3.582648675304236*^9, 
   3.582648978148449*^9}, {3.5826490994583054`*^9, 3.5826491480644855`*^9}, {
   3.5826491968466983`*^9, 3.5826494325552487`*^9}, {3.582649468216781*^9, 
   3.582649579637991*^9}, {3.5828245166666718`*^9, 3.5828246067985*^9}, {
   3.582824660482934*^9, 3.582824692868044*^9}, {3.5828266471212683`*^9, 
   3.582826649323578*^9}, {3.5828268528976045`*^9, 3.5828270656839294`*^9}, {
   3.5828271015643625`*^9, 3.582827252746745*^9}, {3.582827292480382*^9, 
   3.58282759538878*^9}, {3.582827861358651*^9, 3.582827907238557*^9}, {
   3.5828280958419957`*^9, 3.58282818615501*^9}, {3.582828242180162*^9, 
   3.582828434748732*^9}, {3.582828472391797*^9, 3.582828473296638*^9}, {
   3.5828288720548587`*^9, 3.5828289270608644`*^9}, {3.582828996091554*^9, 
   3.582828997448848*^9}, {3.582829062376712*^9, 3.5828290923133864`*^9}, {
   3.5828291230925617`*^9, 3.5828291230925617`*^9}, {3.582829154261697*^9, 
   3.5828292496411166`*^9}, {3.582829696088482*^9, 3.5828298272090425`*^9}, {
   3.582829857395208*^9, 3.5828299073724947`*^9}, {3.582829938886293*^9, 
   3.582830138740411*^9}, {3.582830299281722*^9, 3.582830309156624*^9}, {
   3.5828303690613127`*^9, 3.582830458450905*^9}, {3.582830511148181*^9, 
   3.5828306233913336`*^9}, {3.582830657290502*^9, 3.5828309904978743`*^9}, {
   3.582831350779014*^9, 3.5828313509661884`*^9}, {3.5828465349147787`*^9, 
   3.58284681593784*^9}, {3.5828473671228476`*^9, 3.5828473711013556`*^9}, {
   3.582847483511773*^9, 3.582847682538952*^9}, {3.5828834729759655`*^9, 
   3.582883504738045*^9}, {3.5828837923770328`*^9, 3.5828837923770328`*^9}, {
   3.5829905176423583`*^9, 3.58299062246673*^9}, {3.582991482615137*^9, 
   3.582991489618022*^9}, {3.582991520348926*^9, 3.582991527291811*^9}, {
   3.582991786790789*^9, 3.582991786790789*^9}, {3.5829918247656174`*^9, 
   3.582991866708948*^9}, {3.582993288684718*^9, 3.5829932971807528`*^9}, {
   3.582993366791602*^9, 3.582993589712935*^9}, {3.5829936232472153`*^9, 
   3.58299394660734*^9}, {3.5829939928352165`*^9, 3.582994127214299*^9}, {
   3.582994202759847*^9, 3.582994254727479*^9}, {3.582994368584971*^9, 
   3.5829944144678044`*^9}, {3.582994513126295*^9, 3.582994518563986*^9}, {
   3.5829948020930214`*^9, 3.5829948122953157`*^9}, {3.582995070006771*^9, 
   3.5829951282899475`*^9}, {3.582995186978156*^9, 3.5829953385512466`*^9}, {
   3.582995394701404*^9, 3.582995491981083*^9}, {3.582995534599498*^9, 
   3.582995534599498*^9}, {3.5830767680173063`*^9, 3.583077009030854*^9}, {
   3.5830770436322527`*^9, 3.583077075030242*^9}, {3.5830771123789873`*^9, 
   3.58307711515234*^9}, {3.583084166761099*^9, 3.58308418147394*^9}, {
   3.5830842252355165`*^9, 3.5830842696491528`*^9}, {3.5830843060027437`*^9, 
   3.5830847543517284`*^9}, 3.5830847916574697`*^9, {3.5830848230134544`*^9, 
   3.583085308326354*^9}, {3.583085349580598*^9, 3.583085850831949*^9}, {
   3.5830859297506804`*^9, 3.583085995067979*^9}, {3.583086172781392*^9, 
   3.583086197887577*^9}, {3.5830863462245073`*^9, 3.583086399448209*^9}, {
   3.5830864818466682`*^9, 3.5830865644611673`*^9}, {3.5831406003554335`*^9, 
   3.5831406003554335`*^9}, {3.5831442455760746`*^9, 
   3.5831442542371497`*^9}, {3.583144906046163*^9, 3.583145013553857*^9}, {
   3.5831450566813116`*^9, 3.583145072066265*^9}, {3.5831494797066455`*^9, 
   3.5831494797066455`*^9}, {3.5831504244162655`*^9, 
   3.5831504328303347`*^9}, {3.5831509332155104`*^9, 
   3.5831509499336357`*^9}, {3.583151022363844*^9, 3.583151022363844*^9}, {
   3.583151309593628*^9, 3.583151309593628*^9}, {3.58383601573698*^9, 
   3.5838360157370453`*^9}, {3.5859244081674547`*^9, 3.5859244117709*^9}, {
   3.586192306043029*^9, 3.586192308641103*^9}}],

Cell[TextData[{
 "Summary of results\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "'"], 
        SuperscriptBox["m", "'"]}], ")"}]}]], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"2", "\[Pi]", " ", 
                 RowBox[{"S", "(", "n", ")"}], 
                 RowBox[{"{", 
                  RowBox[{"1", "+", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[Mu]", "t"], "(", "n", ")"}], "-", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
                    SuperscriptBox["g", 
                    TemplateBox[{"m"},
                    "Abs"]]}]}]}]}]}]}], ")"}], "]"}], " ", 
              SqrtBox[
               RowBox[{
                RowBox[{"S", "(", "n", ")"}], "/", "\[Pi]"}]]}], "}"}], 
            SubscriptBox["\[Delta]", 
             RowBox[{"m", " ", 
              SuperscriptBox["m", "'"]}]]}], 
           RowBox[{"n", "=", 
            SuperscriptBox["n", "'"]}]},
          {
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"S", "(", "n", ")"}], "S", 
               RowBox[{"(", 
                SuperscriptBox["n", "'"], ")"}]}], 
              TemplateBox[{RowBox[{
                  SubscriptBox[
                   StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
                  SubscriptBox[
                   StyleBox["r", FontWeight -> "Bold"], 
                   SuperscriptBox["n", "'"]]}]},
               "Abs"]], "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Mu]", "t"], "(", 
               SuperscriptBox["n", "'"], ")"}], "-", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Mu]", "s"], "(", 
                SuperscriptBox["n", "'"], ")"}], 
               SuperscriptBox["g", 
                TemplateBox[{SuperscriptBox["m", "'"]},
                 "Abs"]]}]}], "]"}], 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"\[ImaginaryI]", "(", 
                RowBox[{"m", "-", 
                 SuperscriptBox["m", "'"]}], ")"}]}], " ", 
              SubscriptBox["\[Phi]", 
               RowBox[{
                SubscriptBox[
                 StyleBox["r",
                  FontWeight->"Bold"], "n"], "-", 
                SubscriptBox[
                 StyleBox["r",
                  FontWeight->"Bold"], 
                 SuperscriptBox["n", "'"]]}]]}]]}], 
           RowBox[{"n", "\[NotEqual]", 
            SuperscriptBox["n", "'"]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["V", 
     RowBox[{"n", " ", "m"}]], "=", 
    RowBox[{
     RowBox[{"S", "(", "n", ")"}], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       SuperscriptBox["\[Phi]", "i"]}]]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.583145894967945*^9, 3.5831460335593023`*^9}, {
   3.5831461299825583`*^9, 3.5831461938833017`*^9}, {3.5831494418819466`*^9, 
   3.583149480567752*^9}, {3.5831503911740503`*^9, 3.5831504153521137`*^9}, {
   3.583150935608815*^9, 3.5831509749718547`*^9}, {3.5831510236079993`*^9, 
   3.5831510236079993`*^9}, {3.583151311055814*^9, 3.5831513110568166`*^9}, 
   3.5831518267719917`*^9, 3.583151923613301*^9, {3.583836024887796*^9, 
   3.583836024887865*^9}, {3.585924424942594*^9, 3.5859244330094557`*^9}, {
   3.5859539075080833`*^9, 3.5859539132570467`*^9}, {3.5861923132877607`*^9, 
   3.586192313287826*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Accelerating Calculations on ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"m", "=", 
     RowBox[{"-", "Nd"}]}], ",", "...", ",", "Nd"}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Subtitle",
 CellChangeTimes->{{3.5880703982862873`*^9, 3.588070415227702*^9}}],

Cell[TextData[{
 "Here explains a better way for calculating ",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]]],
 ":\nFor a given ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"n", ",", 
     SuperscriptBox["n", "'"]}], ")"}], TraditionalForm]]],
 " such that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    SuperscriptBox["n", "'"]}], TraditionalForm]]],
 ",\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"Z", "(", 
      RowBox[{"n", ",", "n"}], ")"}], 
     RowBox[{"m", " ", 
      SuperscriptBox["m", "'"]}]], "\[Congruent]", 
    SubscriptBox["Z", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"n", " ", 
        SuperscriptBox["m", "'"]}], ")"}]}]]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[Delta]", 
      RowBox[{"m", " ", 
       SuperscriptBox["m", "'"]}]], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "\[Pi]", " ", 
        RowBox[{"S", "(", "n", ")"}]}], "+", 
       RowBox[{"2", 
        SuperscriptBox["\[Pi]", 
         RowBox[{"1", "/", "2"}]], " ", 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], "(", "n", ")"}], 
        SuperscriptBox[
         RowBox[{"S", "(", "n", ")"}], 
         RowBox[{"3", "/", "2"}]]}], "-", 
       RowBox[{"2", 
        SuperscriptBox["\[Pi]", 
         RowBox[{"1", "/", "2"}]], " ", 
        RowBox[{
         SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
        SuperscriptBox[
         RowBox[{"S", "(", "n", ")"}], 
         RowBox[{"3", "/", "2"}]], 
        SuperscriptBox["g", 
         TemplateBox[{"m"},
          "Abs"]]}]}], "}"}]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[Delta]", 
      RowBox[{"m", " ", 
       SuperscriptBox["m", "'"]}]], "[", 
     RowBox[{
      RowBox[{"Zon1", "(", "n", ")"}], "+", 
      RowBox[{
       RowBox[{"Zon2", "(", "n", ")"}], 
       SuperscriptBox["g", 
        TemplateBox[{"m"},
         "Abs"]]}]}], "]"}]}], TraditionalForm]}]],
 "\nis simply diagonal, where\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Zon1", "(", "n", ")"}], "=", 
    RowBox[{
     RowBox[{"2", "\[Pi]", " ", 
      RowBox[{"S", "(", "n", ")"}]}], "+", 
     RowBox[{"2", 
      SuperscriptBox["\[Pi]", 
       RowBox[{"1", "/", "2"}]], 
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", "n", ")"}], "S", 
      SuperscriptBox[
       RowBox[{"(", "n", ")"}], 
       RowBox[{"3", "/", "2"}]]}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Zon2", "(", "n", ")"}], "=", 
    RowBox[{
     RowBox[{"-", "2"}], 
     SuperscriptBox["\[Pi]", 
      RowBox[{"1", "/", "2"}]], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], "S", 
     SuperscriptBox[
      RowBox[{"(", "n", ")"}], 
      RowBox[{"3", "/", "2"}]]}]}], TraditionalForm]]],
 "\ncan be calculated at the cost of \n\tmemory\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", "Ns", ")"}], TraditionalForm]]],
 "\n\tCPU\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", "Ns", ")"}], TraditionalForm]]],
 "\nFor a given ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"n", ",", 
     SuperscriptBox["n", "'"]}], ")"}], TraditionalForm]]],
 " such that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[NotEqual]", 
    SuperscriptBox["n", "'"]}], TraditionalForm]]],
 ",\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"Z", "(", 
      RowBox[{"n", ",", "n"}], ")"}], 
     RowBox[{"m", " ", 
      SuperscriptBox["m", "'"]}]], "\[Congruent]", 
    SubscriptBox["Z", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", " ", "m"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"n", " ", 
        SuperscriptBox["m", "'"]}], ")"}]}]]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"S", "(", "n", ")"}], "S", 
        RowBox[{"(", 
         SuperscriptBox["n", "'"], ")"}]}], 
       TemplateBox[{RowBox[{
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "'"]]}]},
        "Abs"]], 
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       SuperscriptBox["n", "'"], ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]]}]]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"+", "\[ImaginaryI]"}], " ", 
        SuperscriptBox["m", "'"], " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]]}]]}]]}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"S", "(", "n", ")"}], "S", 
        RowBox[{"(", 
         SuperscriptBox["n", "'"], ")"}]}], 
       TemplateBox[{RowBox[{
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "'"]]}]},
        "Abs"]], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox["n", "'"], ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]]}]]}]], 
      SuperscriptBox["g", 
       TemplateBox[{SuperscriptBox["m", "'"]},
        "Abs"]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"+", "\[ImaginaryI]"}], " ", 
        SuperscriptBox["m", "'"], " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]]}]]}]]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      RowBox[{"Zoff", "(", 
       RowBox[{"n", ",", 
        SuperscriptBox["n", "'"]}], ")"}], 
      SubscriptBox[
       RowBox[{
        RowBox[{
         SubscriptBox["\[Mu]", "t"], "(", 
         SuperscriptBox["n", "'"], ")"}], "[", 
        RowBox[{
         SubscriptBox["\[ScriptV]", 
          RowBox[{"n", " ", 
           SuperscriptBox["n", "'"]}]], "\[Cross]", 
         SubsuperscriptBox["\[ScriptV]", 
          RowBox[{"n", " ", 
           SuperscriptBox["n", "'"]}], "*"]}], "]"}], 
       RowBox[{"m", " ", 
        SuperscriptBox["m", "'"]}]]}], "-", 
     RowBox[{
      RowBox[{"Zoff", "(", 
       RowBox[{"n", ",", 
        SuperscriptBox["n", "'"]}], ")"}], 
      SubscriptBox[
       RowBox[{
        RowBox[{
         SubscriptBox["\[Mu]", "s"], "(", 
         SuperscriptBox["n", "'"], ")"}], "[", 
        RowBox[{
         SubscriptBox["\[ScriptV]", 
          RowBox[{"n", " ", 
           SuperscriptBox["n", "'"]}]], "\[Cross]", 
         RowBox[{"(", 
          RowBox[{"\[ScriptG]", " ", 
           SubsuperscriptBox["\[ScriptV]", 
            RowBox[{"n", " ", 
             SuperscriptBox["n", "'"]}], "*"]}], ")"}]}], "]"}], 
       RowBox[{"m", " ", 
        SuperscriptBox["m", "'"]}]]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"Zoff", "(", 
      RowBox[{"n", ",", 
       SuperscriptBox["n", "'"]}], ")"}], 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[ScriptV]", 
         RowBox[{"n", " ", 
          SuperscriptBox["n", "'"]}]], "\[Cross]", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox["\[Mu]", "t"], "(", 
            SuperscriptBox["n", "'"], ")"}], 
           SubsuperscriptBox["\[ScriptV]", 
            RowBox[{"n", " ", 
             SuperscriptBox["n", "'"]}], "*"]}], "-", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Mu]", "s"], "(", 
            SuperscriptBox["n", "'"], ")"}], "\[ScriptG]", " ", 
           SubsuperscriptBox["\[ScriptV]", 
            RowBox[{"n", " ", 
             SuperscriptBox["n", "'"]}], "*"]}]}], "]"}]}], "}"}], 
      RowBox[{"m", " ", 
       SuperscriptBox["m", "'"]}]]}]}], TraditionalForm]}]],
 "\nSo that such blocks can be calculated using outer product of vectors",
 Cell[BoxData[
  FormBox[Cell[""], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Z", "(", 
     RowBox[{"n", ",", 
      SuperscriptBox["n", "'"]}], ")"}], "=", 
    RowBox[{
     RowBox[{"Zoff", "(", 
      RowBox[{"n", ",", 
       SuperscriptBox["n", "'"]}], ")"}], 
     RowBox[{
      SubscriptBox["\[ScriptV]", 
       RowBox[{"n", " ", 
        SuperscriptBox["n", "'"]}]], "\[Cross]", 
      SubscriptBox["u", 
       RowBox[{"n", " ", 
        SuperscriptBox["n", "'"]}]]}]}]}], TraditionalForm]]],
 "\nwith\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Zoff", "(", 
     RowBox[{"n", ",", 
      SuperscriptBox["n", "'"]}], ")"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"S", 
            RowBox[{"(", "n", ")"}], "S", 
            RowBox[{
             RowBox[{"(", 
              SuperscriptBox["n", "'"], ")"}], "/", 
             TemplateBox[{RowBox[{
                 SubscriptBox[
                  StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
                 SubscriptBox[
                  StyleBox["r", FontWeight -> "Bold"], 
                  SuperscriptBox["n", "'"]]}]},
              "Abs"]}]}], 
           RowBox[{"n", "\[NotEqual]", 
            SuperscriptBox["n", "'"]}]},
          {"0", 
           RowBox[{"n", "=", 
            SuperscriptBox["n", "'"]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], TraditionalForm]]],
 "\tsymmetric ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["N", "s"], "\[Times]", 
    SubscriptBox["N", "s"]}], TraditionalForm]]],
 " matrix\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["\[ScriptV]", 
       RowBox[{"n", " ", 
        SuperscriptBox["n", "'"]}]], ")"}], "m"], "=", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
      SubscriptBox["\[Phi]", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "n"], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]]}]]}], "]"}]}], TraditionalForm]]],
 "\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["N", "s"], "\[Times]", 
    SubscriptBox["N", "s"]}], TraditionalForm]]],
 " vectors of length ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"2", 
     SubscriptBox["N", "d"]}], "+", "1"}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["u", 
       RowBox[{"n", " ", 
        SuperscriptBox["n", "'"]}]], ")"}], "m"], "=", 
    SubscriptBox[
     RowBox[{"[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Mu]", "t"], "(", 
         SuperscriptBox["n", "'"], ")"}], 
        SubsuperscriptBox["\[ScriptV]", 
         RowBox[{"n", " ", 
          SuperscriptBox["n", "'"]}], "*"]}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Mu]", "s"], "(", 
         SuperscriptBox["n", "'"], ")"}], "\[ScriptG]", " ", 
        SubsuperscriptBox["\[ScriptV]", 
         RowBox[{"n", " ", 
          SuperscriptBox["n", "'"]}], "*"]}]}], "]"}], "m"]}], 
   TraditionalForm]]],
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["N", "s"], "\[Times]", 
    SubscriptBox["N", "s"]}], TraditionalForm]]],
 " vectors of length ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"2", 
     SubscriptBox["N", "d"]}], "+", "1"}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", "\[ScriptG]", ")"}], "m"], "=", 
    SuperscriptBox["g", 
     TemplateBox[{"m"},
      "Abs"]]}], TraditionalForm]]],
 "\t\t\t\tvector of length ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"2", 
     SubscriptBox["N", "d"]}], "+", "1"}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{"\[ScriptG]", " ", 
       RowBox[{"\[ScriptV]", "\[Conjugate]"}]}], ")"}], "m"], "=", 
    RowBox[{
     SubscriptBox[
      RowBox[{"(", "\[ScriptG]", ")"}], "m"], 
     SubscriptBox[
      RowBox[{"(", 
       SubsuperscriptBox["\[ScriptV]", 
        RowBox[{"n", " ", 
         SuperscriptBox["n", "'"]}], "*"], ")"}], "m"]}]}], TraditionalForm]]],
 "\t\t\telement-wise product of two vectors\nSummarize:\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"Z", "(", 
       RowBox[{"n", ",", 
        SuperscriptBox["n", "'"]}], ")"}], 
      RowBox[{"m", " ", 
       SuperscriptBox["m", "'"]}]], "\[Congruent]", 
     SubscriptBox["Z", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", " ", "m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["n", "'"], " ", 
         SuperscriptBox["m", "'"]}], ")"}]}]]}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            SubscriptBox["\[Delta]", 
             RowBox[{"m", " ", 
              SuperscriptBox["m", "'"]}]], "[", 
            RowBox[{
             RowBox[{"Zon1", 
              RowBox[{"(", "n", ")"}]}], "+", 
             RowBox[{"Zon2", 
              RowBox[{"(", "n", ")"}], 
              SuperscriptBox["g", 
               TemplateBox[{"m"},
                "Abs"]]}]}], "]"}], 
           RowBox[{"n", "=", 
            SuperscriptBox["n", "'"]}]},
          {
           RowBox[{
            RowBox[{"Zoff", "(", 
             RowBox[{"n", ",", 
              SuperscriptBox["n", "'"]}], ")"}], 
            SubscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["\[ScriptV]", 
                RowBox[{"n", " ", 
                 SuperscriptBox["n", "'"]}]], "\[Cross]", 
               SubscriptBox["u", 
                RowBox[{"n", " ", 
                 SuperscriptBox["n", "'"]}]]}], ")"}], 
             RowBox[{"m", " ", 
              SuperscriptBox["m", "'"]}]]}], 
           RowBox[{"n", "\[NotEqual]", 
            SuperscriptBox["n", "'"]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], TraditionalForm]]],
 "\nwhere\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Zon1", "(", "n", ")"}], "=", 
    RowBox[{
     RowBox[{"2", "\[Pi]", " ", 
      RowBox[{"S", "(", "n", ")"}]}], "+", 
     RowBox[{"2", 
      SuperscriptBox["\[Pi]", 
       RowBox[{"1", "/", "2"}]], 
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", "n", ")"}], "S", 
      SuperscriptBox[
       RowBox[{"(", "n", ")"}], 
       RowBox[{"3", "/", "2"}]]}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Zon2", "(", "n", ")"}], "=", 
    RowBox[{
     RowBox[{"-", "2"}], 
     SuperscriptBox["\[Pi]", 
      RowBox[{"1", "/", "2"}]], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], "S", 
     SuperscriptBox[
      RowBox[{"(", "n", ")"}], 
      RowBox[{"3", "/", "2"}]]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Zoff", "(", 
     RowBox[{"n", ",", 
      SuperscriptBox["n", "'"]}], ")"}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{"S", 
            RowBox[{"(", "n", ")"}], "S", 
            RowBox[{
             RowBox[{"(", 
              SuperscriptBox["n", "'"], ")"}], "/", 
             TemplateBox[{RowBox[{
                 SubscriptBox[
                  StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
                 SubscriptBox[
                  StyleBox["r", FontWeight -> "Bold"], 
                  SuperscriptBox["n", "'"]]}]},
              "Abs"]}]}], 
           RowBox[{"n", "\[NotEqual]", 
            SuperscriptBox["n", "'"]}]},
          {"0", 
           RowBox[{"n", "=", 
            SuperscriptBox["n", "'"]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], TraditionalForm]]],
 "\tsymmetric ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["N", "s"], "\[Times]", 
    SubscriptBox["N", "s"]}], TraditionalForm]]],
 " matrix\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["\[ScriptV]", 
       RowBox[{"n", " ", 
        SuperscriptBox["n", "'"]}]], ")"}], "m"], "=", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
      SubscriptBox["\[Phi]", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "n"], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]]}]]}], "]"}]}], TraditionalForm]]],
 "\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["N", "s"], "\[Times]", 
    SubscriptBox["N", "s"]}], TraditionalForm]]],
 " vectors of length ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"2", 
     SubscriptBox["N", "d"]}], "+", "1"}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["u", 
       RowBox[{"n", " ", 
        SuperscriptBox["n", "'"]}]], ")"}], "m"], "=", 
    SubscriptBox[
     RowBox[{"[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Mu]", "t"], "(", 
         SuperscriptBox["n", "'"], ")"}], 
        SubsuperscriptBox["\[ScriptV]", 
         RowBox[{"n", " ", 
          SuperscriptBox["n", "'"]}], "*"]}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Mu]", "s"], "(", 
         SuperscriptBox["n", "'"], ")"}], "\[ScriptG]", " ", 
        SubsuperscriptBox["\[ScriptV]", 
         RowBox[{"n", " ", 
          SuperscriptBox["n", "'"]}], "*"]}]}], "]"}], "m"]}], 
   TraditionalForm]]],
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["N", "s"], "\[Times]", 
    SubscriptBox["N", "s"]}], TraditionalForm]]],
 " vectors of length ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"2", 
     SubscriptBox["N", "d"]}], "+", "1"}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", "\[ScriptG]", ")"}], "m"], "=", 
    SuperscriptBox["g", 
     TemplateBox[{"m"},
      "Abs"]]}], TraditionalForm]]],
 "\t\t\t\tvector of length ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"2", 
     SubscriptBox["N", "d"]}], "+", "1"}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{"\[ScriptG]", " ", 
       RowBox[{"\[ScriptV]", "\[Conjugate]"}]}], ")"}], "m"], "=", 
    RowBox[{
     SubscriptBox[
      RowBox[{"(", "\[ScriptG]", ")"}], "m"], 
     SubscriptBox[
      RowBox[{"(", 
       SubsuperscriptBox["\[ScriptV]", 
        RowBox[{"n", " ", 
         SuperscriptBox["n", "'"]}], "*"], ")"}], "m"]}]}], TraditionalForm]]],
 "\t\t\telement-wise product of two vectors"
}], "Text",
 CellChangeTimes->{{3.583150634881611*^9, 3.583150675769758*^9}, {
   3.5831507608062186`*^9, 3.58315081254679*^9}, {3.5831518684572897`*^9, 
   3.5831519128219304`*^9}, {3.5831519553617783`*^9, 
   3.5831520205320563`*^9}, {3.583152056711405*^9, 3.5831521589987345`*^9}, {
   3.5831583505730467`*^9, 3.583158432553033*^9}, {3.5831587367041087`*^9, 
   3.583158813929916*^9}, {3.5831685341904287`*^9, 3.5831685393727865`*^9}, 
   3.583168912183615*^9, {3.5831690062585897`*^9, 3.5831690068136697`*^9}, {
   3.5831690497183547`*^9, 3.583169050058374*^9}, {3.5831690814234257`*^9, 
   3.5831691406437035`*^9}, {3.5831691820259604`*^9, 3.583169182517023*^9}, {
   3.5831884792035418`*^9, 3.583188515299223*^9}, {3.58318989988562*^9, 
   3.583189974147106*^9}, 3.5831900071459293`*^9, {3.583281238556258*^9, 
   3.5832812432051344`*^9}, {3.58328190541745*^9, 3.5832819180849233`*^9}, {
   3.5832820012180758`*^9, 3.583282001966885*^9}, {3.583282380148609*^9, 
   3.583282510004428*^9}, {3.583282632886943*^9, 3.583282667410223*^9}, {
   3.5833598876289124`*^9, 3.5833598962089577`*^9}, {3.583585006401021*^9, 
   3.5835851330441437`*^9}, 3.5835853300846367`*^9, {3.5859244571272306`*^9, 
   3.585924507486714*^9}, {3.585953923294178*^9, 3.585953969639113*^9}, {
   3.586194973099668*^9, 3.5861950054523783`*^9}, {3.5861954910607433`*^9, 
   3.586195525257677*^9}, {3.5861955555146837`*^9, 3.58619558633484*^9}, {
   3.5861956191581593`*^9, 3.586195652905553*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Matrix-Vector Product without Assembling the Matrix\
\>", "Subtitle",
 CellChangeTimes->{{3.588070426029787*^9, 3.588070445892524*^9}}],

Cell[TextData[{
 "The matrix-vector multiplication operation without assembling the matrix\n\
(Have used Einstein\[CloseCurlyQuote]s convention to sum over repeated \
indices except when otherwise specified)\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Y", 
     RowBox[{"n", " ", "m"}]], "=", 
    RowBox[{
     SubscriptBox["Z", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", " ", "m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["n", "'"], 
         SuperscriptBox["m", "'"]}], ")"}]}]], 
     SubscriptBox["X", 
      RowBox[{
       SuperscriptBox["n", "'"], 
       SuperscriptBox["m", "'"]}]]}]}], TraditionalForm]]],
 "\nLet\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"X", "(", 
      SuperscriptBox["n", "'"], ")"}], 
     SuperscriptBox["m", "'"]], "\[Congruent]", 
    SubscriptBox["X", 
     RowBox[{
      SuperscriptBox["n", "'"], 
      SuperscriptBox["m", "'"]}]]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"Y", "(", "n", ")"}], "m"], "\[Congruent]", 
     SubscriptBox["Y", 
      RowBox[{"n", " ", "m"}]]}], "=", 
    RowBox[{
     SubscriptBox["Z", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", " ", "m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["n", "'"], 
         SuperscriptBox["m", "'"]}], ")"}]}]], 
     SubscriptBox["X", 
      RowBox[{
       SuperscriptBox["n", "'"], 
       SuperscriptBox["m", "'"]}]]}]}], TraditionalForm]]],
 "\nwith\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"Z", "(", 
       RowBox[{"n", ",", 
        SuperscriptBox["n", "'"]}], ")"}], 
      RowBox[{"m", " ", 
       SuperscriptBox["m", "'"]}]], "\[Congruent]", 
     SubscriptBox["Z", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", " ", "m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["n", "'"], " ", 
         SuperscriptBox["m", "'"]}], ")"}]}]]}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            SubscriptBox["\[Delta]", 
             RowBox[{"m", " ", 
              SuperscriptBox["m", "'"]}]], "[", 
            RowBox[{
             RowBox[{"Zon1", 
              RowBox[{"(", "n", ")"}]}], "+", 
             RowBox[{"Zon2", 
              RowBox[{"(", "n", ")"}], 
              SuperscriptBox["g", 
               TemplateBox[{"m"},
                "Abs"]]}]}], "]"}], 
           RowBox[{"n", "=", 
            SuperscriptBox["n", "'"]}]},
          {
           RowBox[{
            RowBox[{"Zoff", "(", 
             RowBox[{"n", ",", 
              SuperscriptBox["n", "'"]}], ")"}], 
            SubscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["\[ScriptV]", 
                RowBox[{"n", " ", 
                 SuperscriptBox["n", "'"]}]], "\[Cross]", 
               SubscriptBox["u", 
                RowBox[{"n", " ", 
                 SuperscriptBox["n", "'"]}]]}], ")"}], 
             RowBox[{"m", " ", 
              SuperscriptBox["m", "'"]}]]}], 
           RowBox[{"n", "\[NotEqual]", 
            SuperscriptBox["n", "'"]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], TraditionalForm]]],
 "\nWe can write\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"Y", "(", "n", ")"}], "m"], "=", 
    RowBox[{
     SubscriptBox[
      RowBox[{"Z", "(", 
       RowBox[{"n", ",", "n"}], ")"}], 
      RowBox[{"m", " ", 
       SuperscriptBox["m", "'"]}]], 
     SubscriptBox[
      RowBox[{"X", "(", 
       SuperscriptBox["n", "'"], ")"}], 
      SuperscriptBox["m", "'"]]}]}], TraditionalForm]]],
 "\nComputing each ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Y", "(", "n", ")"}], TraditionalForm]]],
 " is easy:\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"Y", "(", "n", ")"}], "m"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       RowBox[{"Z", "(", 
        RowBox[{"n", ",", "n"}], ")"}], 
       RowBox[{"m", " ", 
        SuperscriptBox["m", "'"]}]], 
      SubscriptBox[
       RowBox[{"X", "(", 
        SuperscriptBox["n", "'"], ")"}], 
       SuperscriptBox["m", "'"]]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"Z", "(", 
         RowBox[{"n", ",", "n"}], ")"}], 
        RowBox[{"m", " ", 
         SuperscriptBox["m", "'"]}]], 
       SubscriptBox[
        RowBox[{"X", "(", "n", ")"}], 
        SuperscriptBox["m", "'"]]}], "+", 
      RowBox[{
       SubscriptBox["\[Sum]", 
        RowBox[{"n", "\[NotEqual]", 
         SuperscriptBox["n", "'"]}]], 
       RowBox[{
        SubscriptBox[
         RowBox[{"Z", "(", 
          RowBox[{"n", ",", "n"}], ")"}], 
         RowBox[{"m", " ", 
          SuperscriptBox["m", "'"]}]], 
        SubscriptBox[
         RowBox[{"X", "(", "n", ")"}], 
         SuperscriptBox["m", "'"]]}]}]}]}]}], TraditionalForm]]],
 "\nFirst do the diagonal part, i.e., ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    SuperscriptBox["n", "'"]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"Z", "(", 
      RowBox[{"n", ",", "n"}], ")"}], 
     RowBox[{"m", " ", 
      SuperscriptBox["m", "'"]}]], 
    SubscriptBox[
     RowBox[{"X", "(", "n", ")"}], 
     SuperscriptBox["m", "'"]]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[Sum]", 
      SuperscriptBox["m", "'"]], 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Delta]", 
        RowBox[{"m", " ", 
         SuperscriptBox["m", "'"]}]], "[", 
       RowBox[{
        RowBox[{"Zon1", "(", "n", ")"}], "+", 
        RowBox[{
         RowBox[{"Zon2", "(", "n", ")"}], 
         SuperscriptBox["g", 
          TemplateBox[{"m"},
           "Abs"]]}]}], "]"}], 
      SubscriptBox[
       RowBox[{"X", "(", "n", ")"}], 
       SuperscriptBox["m", "'"]]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{
       RowBox[{"Zon1", "(", "n", ")"}], "+", 
       RowBox[{
        RowBox[{"Zon2", "(", "n", ")"}], 
        SuperscriptBox["g", 
         TemplateBox[{"m"},
          "Abs"]]}]}], "]"}], 
     SubscriptBox[
      RowBox[{"X", "(", "n", ")"}], "m"]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      RowBox[{"Zon1", "(", "n", ")"}], 
      SubscriptBox[
       RowBox[{"X", "(", "n", ")"}], "m"]}], "+", 
     RowBox[{
      RowBox[{"Zon2", "(", "n", ")"}], 
      SuperscriptBox["g", 
       TemplateBox[{"m"},
        "Abs"]], 
      SubscriptBox[
       RowBox[{"X", "(", "n", ")"}], "m"]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    SubscriptBox[
     RowBox[{"[", 
      RowBox[{
       RowBox[{
        RowBox[{"Zon1", "(", "n", ")"}], 
        RowBox[{"X", "(", "n", ")"}]}], "+", 
       RowBox[{
        RowBox[{"Zon2", "(", "n", ")"}], "\[ScriptG]", " ", 
        RowBox[{"X", "(", "n", ")"}]}]}], "]"}], "m"]}], TraditionalForm]}]],
 "\nThen the off-diagonal part, i.e., ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[NotEqual]", 
    SuperscriptBox["n", "'"]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"Z", "(", 
      RowBox[{"n", ",", "n"}], ")"}], 
     RowBox[{"m", " ", 
      SuperscriptBox["m", "'"]}]], 
    SubscriptBox[
     RowBox[{"X", "(", "n", ")"}], 
     SuperscriptBox["m", "'"]]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[Sum]", 
      SuperscriptBox["m", "'"]], 
     RowBox[{
      RowBox[{"Zoff", "(", 
       RowBox[{"n", ",", 
        SuperscriptBox["n", "'"]}], ")"}], 
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[ScriptV]", 
          RowBox[{"n", " ", 
           SuperscriptBox["n", "'"]}]], "\[Cross]", 
         SubscriptBox["u", 
          RowBox[{"n", " ", 
           SuperscriptBox["n", "'"]}]]}], ")"}], 
       RowBox[{"m", " ", 
        SuperscriptBox["m", "'"]}]], 
      SubscriptBox[
       RowBox[{"X", "(", "n", ")"}], 
       SuperscriptBox["m", "'"]]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"Zoff", "(", 
      RowBox[{"n", ",", 
       SuperscriptBox["n", "'"]}], ")"}], 
     SubscriptBox[
      RowBox[{"(", 
       SubscriptBox["\[ScriptV]", 
        RowBox[{"n", " ", 
         SuperscriptBox["n", "'"]}]], ")"}], "m"], 
     RowBox[{
      SubscriptBox["\[Sum]", 
       SuperscriptBox["m", "'"]], 
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SubscriptBox["u", 
          RowBox[{"n", " ", 
           SuperscriptBox["n", "'"]}]], ")"}], 
        SuperscriptBox["m", "'"]], 
       SubscriptBox[
        RowBox[{"X", "(", "n", ")"}], 
        SuperscriptBox["m", "'"]]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"Zoff", "(", 
      RowBox[{"n", ",", 
       SuperscriptBox["n", "'"]}], ")"}], 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        SubscriptBox["\[ScriptV]", 
         RowBox[{"n", " ", 
          SuperscriptBox["n", "'"]}]], ")"}], "m"], "[", 
      RowBox[{
       SubscriptBox["u", 
        RowBox[{"n", " ", 
         SuperscriptBox["n", "'"]}]], "\[CenterDot]", 
       RowBox[{"X", "(", "n", ")"}]}], "]"}]}]}], TraditionalForm]}]],
 "\nSo that in the vectorial form\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Y", "(", "n", ")"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Zon1", "(", "n", ")"}], 
      RowBox[{"X", "(", "n", ")"}]}], "+", 
     RowBox[{
      RowBox[{"Zon2", "(", "n", ")"}], "\[ScriptG]", " ", 
      RowBox[{"X", "(", "n", ")"}]}], "+", 
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{
        SuperscriptBox["n", "'"], "\[NotEqual]", "n"}]], 
      RowBox[{
       RowBox[{
        RowBox[{"Zoff", "(", 
         RowBox[{"n", ",", 
          SuperscriptBox["n", "'"]}], ")"}], "[", 
        RowBox[{
         RowBox[{"X", "(", "n", ")"}], "\[CenterDot]", 
         SubscriptBox["u", 
          RowBox[{"n", " ", 
           SuperscriptBox["n", "'"]}]]}], "]"}], 
       SubscriptBox["\[ScriptV]", 
        RowBox[{"n", " ", 
         SuperscriptBox["n", "'"]}]]}]}]}]}], TraditionalForm]]],
 "\nNote that the diagonal elements ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Zoff", "(", 
     RowBox[{"n", ",", "n"}], ")"}], "=", "0"}], TraditionalForm]]],
 "\nSo that\n",
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Y", "(", "n", ")"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Zon1", "(", "n", ")"}], 
      RowBox[{"X", "(", "n", ")"}]}], "+", 
     RowBox[{
      RowBox[{"Zon2", "(", "n", ")"}], "\[ScriptG]", " ", 
      RowBox[{"X", "(", "n", ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{
        SuperscriptBox["n", "'"], "=", "1"}], "Ns"], 
      RowBox[{
       RowBox[{
        RowBox[{"Zoff", "(", 
         RowBox[{"n", ",", 
          SuperscriptBox["n", "'"]}], ")"}], "[", 
        RowBox[{
         RowBox[{"X", "(", "n", ")"}], "\[CenterDot]", 
         SubscriptBox["u", 
          RowBox[{"n", " ", 
           SuperscriptBox["n", "'"]}]]}], "]"}], 
       SubscriptBox["\[ScriptV]", 
        RowBox[{"n", " ", 
         SuperscriptBox["n", "'"]}]]}]}]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.5832816502135067`*^9, 3.5832818761352673`*^9}, {
   3.5832819376474223`*^9, 3.5832823450015125`*^9}, {3.5832825268995185`*^9, 
   3.5832826260541277`*^9}, {3.5832826814034386`*^9, 3.583282681855978*^9}, {
   3.5832830873999214`*^9, 3.5832831740901113`*^9}, {3.583316754881017*^9, 
   3.5833167599979815`*^9}, {3.5835851459537783`*^9, 3.583585284153764*^9}, {
   3.583587020635775*^9, 3.583587020942813*^9}, {3.583836190366993*^9, 
   3.583836190900292*^9}, 3.586175303703561*^9, {3.586195240477561*^9, 
   3.586195314172488*^9}, {3.586195440781975*^9, 3.5861954433236723`*^9}, {
   3.586195706617508*^9, 3.586195726775175*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Taking out the Ballistic Term", "Subtitle",
 CellChangeTimes->{{3.588070456092277*^9, 3.588070471531708*^9}}],

Cell[TextData[{
 "The plane wave incidence\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Psi]", "i"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     RowBox[{"\[Delta]", "(", 
      RowBox[{"\[Phi]", "-", 
       SuperscriptBox["\[Phi]", "i"]}], ")"}], "=", 
     RowBox[{
      SubscriptBox["lim", 
       RowBox[{"Nd", "\[Rule]", "\[Infinity]"}]], 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", "\[Pi]"}]], 
       RowBox[{
        SubsuperscriptBox["\[Sum]", 
         RowBox[{"m", "=", 
          RowBox[{"-", "Nd"}]}], "Nd"], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"m", "(", 
           RowBox[{"\[Phi]", "-", 
            SuperscriptBox["\[Phi]", "i"]}], ")"}]}]]}]}]}]}]}], 
   TraditionalForm]]],
 "\nhas an infinitely extended discrete Fourier spectrum of equal strenth ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"1", "/", "2"}], "\[Pi]"}], TraditionalForm]]],
 "\nAny truncation would miss out the high frequency components\nWe may at \
first naively expect that as ",
 Cell[BoxData[
  FormBox["Nd", TraditionalForm]]],
 " grows, the solution becomes more accurate\nWe tested the solver with \
non-scattering pure absorption medium\nFor moderate ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Nd", "=", 
    RowBox[{"10", "~", "20"}]}], TraditionalForm]]],
 ", good match with the theoretical exponential decay\nFor high ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Nd", ">", "30"}], TraditionalForm]]],
 ", the solution deviates dramatically - the method breaks down there\nThis \
seemingly weird phenamenon is understood (not detailed here) as a result from \
the singularity of the incidence wave"
}], "Text",
 CellChangeTimes->{{3.586175309215116*^9, 3.586175774000725*^9}, {
  3.586175828375896*^9, 3.586175854822186*^9}, {3.586176034950746*^9, 
  3.586176121194162*^9}}],

Cell[TextData[{
 "Here on we try to eleminate the singularity!\nThe RTE reads, in its general \
form (no longer 2D)\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{"\[Psi]", "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         StyleBox["v",
          FontWeight->"Bold"]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Psi]", "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        StyleBox["s",
         FontWeight->"Bold"]}], ")"}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"f", "(", 
         RowBox[{
          StyleBox["s",
           FontWeight->"Bold"], "\[CenterDot]", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}], 
        RowBox[{"\[Psi]", "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}]}]}]}], "+", 
     RowBox[{"q", "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", 
       StyleBox["s",
        FontWeight->"Bold"]}], ")"}]}]}], TraditionalForm]]],
 "\nWrite\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Psi]", "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      StyleBox["v",
       FontWeight->"Bold"]}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Psi]", "b"], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", 
       StyleBox["v",
        FontWeight->"Bold"]}], ")"}], "+", 
     RowBox[{
      SubscriptBox["\[Psi]", "sc"], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", 
       StyleBox["v",
        FontWeight->"Bold"]}], ")"}]}]}], TraditionalForm]]],
 "\nThe subscript ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]]],
 " stands for ",
 StyleBox["ballistic",
  FontSlant->"Italic"],
 ", ",
 Cell[BoxData[
  FormBox[
   StyleBox["sc",
    FontSlant->"Italic"], TraditionalForm]]],
 " stands for ",
 StyleBox["scattering",
  FontSlant->"Italic"],
 "\nPlug in RTE to get\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        SubscriptBox["\[Psi]", "b"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         StyleBox["v",
          FontWeight->"Bold"]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       SubscriptBox["\[Psi]", "b"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        StyleBox["s",
         FontWeight->"Bold"]}], ")"}]}], "+", 
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        SubscriptBox["\[Psi]", "sc"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         StyleBox["v",
          FontWeight->"Bold"]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       SubscriptBox["\[Psi]", "sc"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        StyleBox["s",
         FontWeight->"Bold"]}], ")"}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"f", "(", 
         RowBox[{
          StyleBox["s",
           FontWeight->"Bold"], "\[CenterDot]", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}], 
        RowBox[{
         SubscriptBox["\[Psi]", "b"], "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}]}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"f", "(", 
         RowBox[{
          StyleBox["s",
           FontWeight->"Bold"], "\[CenterDot]", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}], 
        RowBox[{
         SubscriptBox["\[Psi]", "sc"], "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}]}]}]}], "+", 
     RowBox[{"q", "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", 
       StyleBox["s",
        FontWeight->"Bold"]}], ")"}]}]}], TraditionalForm]]],
 "\nWe may make ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", "b"], TraditionalForm]]],
 " the field due to the absorption (non-scattering) medium and the singular \
source ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        SubscriptBox["\[Psi]", "b"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         StyleBox["v",
          FontWeight->"Bold"]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       SubscriptBox["\[Psi]", "b"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        StyleBox["s",
         FontWeight->"Bold"]}], ")"}]}]}], "=", 
    RowBox[{"q", "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      StyleBox["s",
       FontWeight->"Bold"]}], ")"}]}], TraditionalForm]]],
 "\nThe solution to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", "b"], TraditionalForm]]],
 " is well known to be exponentially decaying\nThe remaining part, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", "sc"], TraditionalForm]]],
 ", is the field due to scattering of a better behaved source\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        SubscriptBox["\[Psi]", "sc"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         StyleBox["v",
          FontWeight->"Bold"]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       SubscriptBox["\[Psi]", "sc"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        StyleBox["s",
         FontWeight->"Bold"]}], ")"}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"f", "(", 
         RowBox[{
          StyleBox["s",
           FontWeight->"Bold"], "\[CenterDot]", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}], 
        RowBox[{
         SubscriptBox["\[Psi]", "sc"], "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}]}]}]}], "+", 
     RowBox[{
      SubscriptBox["q", "b"], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", 
       StyleBox["s",
        FontWeight->"Bold"]}], ")"}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["q", "b"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      StyleBox["s",
       FontWeight->"Bold"]}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         StyleBox["s",
          FontWeight->"Bold"], "'"]}], 
       RowBox[{"f", "(", 
        RowBox[{
         StyleBox["s",
          FontWeight->"Bold"], "\[CenterDot]", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], ")"}], 
       RowBox[{
        SubscriptBox["\[Psi]", "b"], "(", 
        RowBox[{
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ",", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], ")"}]}]}]}]}], TraditionalForm]]],
 "\nUnlike the original source, the discrete Fourier spectrum of this new \
source, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "b"], "(", 
    RowBox[{
     StyleBox["r",
      FontWeight->"Bold"], ",", 
     StyleBox["s",
      FontWeight->"Bold"]}], ")"}], TraditionalForm]]],
 ", is suppressed by the phase function, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     StyleBox["s",
      FontWeight->"Bold"], "\[CenterDot]", 
     SuperscriptBox[
      StyleBox["s",
       FontWeight->"Bold"], "'"]}], ")"}], TraditionalForm]]],
 " at high frequencies\nOur solver no longer suffers from the large-Nd problem"
}], "Text",
 CellChangeTimes->{{3.586175309215116*^9, 3.586175774000725*^9}, {
   3.586175828375896*^9, 3.586175854822186*^9}, {3.586176034950746*^9, 
   3.586176123273279*^9}, {3.586176184278186*^9, 3.586176347237232*^9}, {
   3.5861763773782997`*^9, 3.586176811577477*^9}, {3.5861769431163273`*^9, 
   3.586177124198826*^9}, 3.587747195373726*^9, {3.587755824150757*^9, 
   3.587755966157588*^9}, {3.587763157372237*^9, 3.587763158448042*^9}}],

Cell[TextData[{
 "Translate into 2D\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        SubscriptBox["\[Psi]", "b"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       SubscriptBox["\[Psi]", "b"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "=", 
    RowBox[{"q", "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        SubscriptBox["\[Psi]", "sc"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       SubscriptBox["\[Psi]", "sc"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["\[Phi]", "'"]}], 
        RowBox[{"f", "(", 
         RowBox[{"\[Phi]", "-", 
          SuperscriptBox["\[Phi]", "'"]}], ")"}], 
        RowBox[{
         SubscriptBox["\[Psi]", "sc"], "(", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], ",", 
          SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}], "+", 
     RowBox[{
      SubscriptBox["q", "b"], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["q", "b"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["\[Phi]", "'"]}], 
       RowBox[{"f", "(", 
        RowBox[{"\[Phi]", "-", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}], 
       RowBox[{
        SubscriptBox["\[Psi]", "b"], "(", 
        RowBox[{
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ",", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}]}], TraditionalForm]]],
 "\nThe solution\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Psi]", "b"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     RowBox[{"\[Delta]", "(", 
      RowBox[{"\[Phi]", "-", 
       SuperscriptBox["\[Phi]", "i"]}], ")"}], 
     RowBox[{"Exp", "(", 
      RowBox[{"-", 
       RowBox[{
        SubscriptBox["\[Integral]", 
         SubscriptBox["C", 
          StyleBox["r",
           FontWeight->"Bold"]]], 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], 
         RowBox[{"\[DifferentialD]", "l"}]}]}]}], ")"}]}]}], 
   TraditionalForm]]],
 "\nwhere\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     StyleBox["s",
      FontWeight->"Bold"], "i"], "=", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["cos\[Phi]", "i"], ",", 
      SuperscriptBox["sin\[Phi]", "i"]}], ")"}]}], TraditionalForm]]],
 "\tis the unit wave vector of the incidence wave\n\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", 
    StyleBox["r",
     FontWeight->"Bold"]], TraditionalForm]]],
 "\t\t\tis the half-line starting at ",
 Cell[BoxData[
  FormBox[
   StyleBox["r",
    FontWeight->"Bold"], TraditionalForm]]],
 " and in the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", 
    SuperscriptBox[
     StyleBox["s",
      FontWeight->"Bold"], "i"]}], TraditionalForm]]],
 " direction\nPerfom the finite-element expansion of the equation of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", "sc"], TraditionalForm]]],
 ", calculate the coefficient matrices\nThis time, the only difference is the \
source term in the RTE, or just the right hand side of the liear equation\n\
(note that we should still use the same free space Green\[CloseCurlyQuote]s \
function)\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Psi]", "sc", "i"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[DifferentialD]", "2"], 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["\[Phi]", "'"]}], 
      RowBox[{"g", "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        RowBox[{"\[Phi]", ";", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], ",", 
        SuperscriptBox["\[Phi]", "'"]}], ")"}], 
      RowBox[{
       SubscriptBox["q", "b"], "(", 
       RowBox[{
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ",", 
        SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["V", "sc"], ")"}], 
     RowBox[{"n", " ", "m"}]], "=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{"\[DifferentialD]", 
       StyleBox["\[Phi]",
        FontWeight->"Plain"]}], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      RowBox[{
       SubsuperscriptBox["\[Psi]", 
        RowBox[{"n", " ", "m"}], "*"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], 
      RowBox[{
       SubsuperscriptBox["\[Psi]", "sc", "i"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}]}], TraditionalForm]]],
 "\nUse the 2D free space Green\[CloseCurlyQuote]s function and the test \
function\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"g", "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      RowBox[{"\[Phi]", ";", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], ",", 
      SuperscriptBox["\[Phi]", "'"]}], ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      TemplateBox[{RowBox[{
          StyleBox["r", FontWeight -> "Bold"], "-", 
          SuperscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "'"]}]},
       "Abs"]], Cell[""], 
     RowBox[{"\[Delta]", "(", 
      RowBox[{"\[Phi]", "-", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]]}], ")"}], 
     RowBox[{"\[Delta]", "(", 
      RowBox[{
       SuperscriptBox["\[Phi]", "'"], "-", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]]}], ")"}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox[" ",
     FontWeight->"Plain"], 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Psi]", 
       RowBox[{"n", " ", "m"}]], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["S", "n"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]]}]}]}], 
   TraditionalForm]]],
 "\nCalculate in the order of: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Psi]", "b"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "b"], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["\[Psi]", "sc", "i"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "\[Rule]", 
      SubscriptBox[
       RowBox[{"(", 
        SubscriptBox["V", "sc"], ")"}], 
       RowBox[{"n", " ", "m"}]]}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["q", "b"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["\[Phi]", "'"]}], 
       RowBox[{"f", "(", 
        RowBox[{"\[Phi]", "-", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}], 
       RowBox[{
        SubscriptBox["\[Psi]", "b"], "(", 
        RowBox[{
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ",", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["\[Phi]", "'"]}], 
       RowBox[{"f", "(", 
        RowBox[{"\[Phi]", "-", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}], 
       RowBox[{"\[Delta]", "(", 
        RowBox[{
         SuperscriptBox["\[Phi]", "'"], "-", 
         SuperscriptBox["\[Phi]", "i"]}], ")"}], 
       RowBox[{"Exp", "(", 
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["\[Integral]", 
           SubscriptBox["C", 
            StyleBox["r",
             FontWeight->"Bold"]]], 
          RowBox[{
           SubscriptBox["\[Mu]", "t"], 
           RowBox[{"\[DifferentialD]", "l"}]}]}]}], ")"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     RowBox[{"f", "(", 
      RowBox[{"\[Phi]", "-", 
       SuperscriptBox["\[Phi]", "i"]}], ")"}], 
     RowBox[{"Exp", "(", 
      RowBox[{"-", 
       RowBox[{
        SubscriptBox["\[Integral]", 
         SubscriptBox["C", 
          StyleBox["r",
           FontWeight->"Bold"]]], 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], 
         RowBox[{"\[DifferentialD]", "l"}]}]}]}], ")"}]}]}], 
   TraditionalForm]}]],
 "\n\t\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Psi]", "sc", "i"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[DifferentialD]", "2"], 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["\[Phi]", "'"]}], 
      RowBox[{"g", "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        RowBox[{"\[Phi]", ";", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], ",", 
        SuperscriptBox["\[Phi]", "'"]}], ")"}], 
      RowBox[{
       SubscriptBox["q", "b"], "(", 
       RowBox[{
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ",", 
        SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[DifferentialD]", "2"], 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["\[Phi]", "'"]}], 
      RowBox[{"g", "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        RowBox[{"\[Phi]", ";", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], ",", 
        SuperscriptBox["\[Phi]", "'"]}], ")"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SuperscriptBox["\[Phi]", "'"], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}], 
      RowBox[{"Exp", "(", 
       RowBox[{"-", 
        RowBox[{
         SubscriptBox["\[Integral]", 
          SubscriptBox["C", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]]], 
         RowBox[{
          SubscriptBox["\[Mu]", "t"], 
          RowBox[{"\[DifferentialD]", 
           SuperscriptBox["l", "'"]}]}]}]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[DifferentialD]", "2"], 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["\[Phi]", "'"]}], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           StyleBox["r", FontWeight -> "Bold"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], Cell[""], 
      RowBox[{"\[Delta]", "(", 
       RowBox[{"\[Phi]", "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}], ")"}], 
      RowBox[{"\[Delta]", "(", 
       RowBox[{
        SuperscriptBox["\[Phi]", "'"], "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}], ")"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SuperscriptBox["\[Phi]", "'"], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}], 
      RowBox[{"Exp", "(", 
       RowBox[{"-", 
        RowBox[{
         SubscriptBox["\[Integral]", 
          SubscriptBox["C", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]]], 
         RowBox[{
          SubscriptBox["\[Mu]", "t"], 
          RowBox[{"\[DifferentialD]", 
           SuperscriptBox["l", "'"]}]}]}]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[DifferentialD]", "2"], 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      FractionBox[
       RowBox[{"\[Delta]", "(", 
        RowBox[{"\[Phi]", "-", 
         SubscriptBox["\[Phi]", 
          RowBox[{
           StyleBox["r",
            FontWeight->"Bold"], "-", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]}]]}], ")"}], 
       TemplateBox[{RowBox[{
           StyleBox["r", FontWeight -> "Bold"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], Cell[""], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}], 
      RowBox[{"Exp", "(", 
       RowBox[{"-", 
        RowBox[{
         SubscriptBox["\[Integral]", 
          SubscriptBox["C", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]]], 
         RowBox[{
          SubscriptBox["\[Mu]", "t"], 
          RowBox[{"\[DifferentialD]", 
           SuperscriptBox["l", "'"]}]}]}]}], ")"}]}]}]}], TraditionalForm]}]],
 "\n\t\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["V", "sc"], ")"}], 
     RowBox[{"n", " ", "m"}]], "=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{"\[DifferentialD]", 
       StyleBox["\[Phi]",
        FontWeight->"Plain"]}], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      RowBox[{
       SubsuperscriptBox["\[Psi]", 
        RowBox[{"n", " ", "m"}], "*"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], 
      RowBox[{
       SubsuperscriptBox["\[Psi]", "sc", "i"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{"\[DifferentialD]", 
       StyleBox["\[Phi]",
        FontWeight->"Plain"]}], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      RowBox[{
       SubscriptBox["S", "n"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[DifferentialD]", "2"], 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], 
        FractionBox[
         RowBox[{"\[Delta]", "(", 
          RowBox[{"\[Phi]", "-", 
           SubscriptBox["\[Phi]", 
            RowBox[{
             StyleBox["r",
              FontWeight->"Bold"], "-", 
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "'"]}]]}], ")"}], 
         TemplateBox[{RowBox[{
             StyleBox["r", FontWeight -> "Bold"], "-", 
             SuperscriptBox[
              StyleBox["r", FontWeight -> "Bold"], "'"]}]},
          "Abs"]], Cell[""], 
        RowBox[{
         SubscriptBox["\[Mu]", "s"], "(", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ")"}], 
        RowBox[{"f", "(", 
         RowBox[{
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox["r",
             FontWeight->"Bold"], "-", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "'"]}]], "-", 
          SuperscriptBox["\[Phi]", "i"]}], ")"}], 
        RowBox[{"Exp", "(", 
         RowBox[{"-", 
          RowBox[{
           SubscriptBox["\[Integral]", 
            SubscriptBox["C", 
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "'"]]], 
           RowBox[{
            SubscriptBox["\[Mu]", "t"], 
            RowBox[{"\[DifferentialD]", 
             SuperscriptBox["l", "'"]}]}]}]}], ")"}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      RowBox[{
       SubscriptBox["S", "n"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[DifferentialD]", "2"], 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], 
        FractionBox["1", 
         TemplateBox[{RowBox[{
             StyleBox["r", FontWeight -> "Bold"], "-", 
             SuperscriptBox[
              StyleBox["r", FontWeight -> "Bold"], "'"]}]},
          "Abs"]], Cell[""], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox["r",
             FontWeight->"Bold"], "-", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "'"]}]]}]], 
        RowBox[{
         SubscriptBox["\[Mu]", "s"], "(", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ")"}], 
        RowBox[{"f", "(", 
         RowBox[{
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox["r",
             FontWeight->"Bold"], "-", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "'"]}]], "-", 
          SuperscriptBox["\[Phi]", "i"]}], ")"}], 
        RowBox[{"Exp", "(", 
         RowBox[{"-", 
          RowBox[{
           SubscriptBox["\[Integral]", 
            SubscriptBox["C", 
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "'"]]], 
           RowBox[{
            SubscriptBox["\[Mu]", "t"], 
            RowBox[{"\[DifferentialD]", 
             SuperscriptBox["l", "'"]}]}]}]}], ")"}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[DifferentialD]", "2"], 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"]}], 
       FractionBox["1", 
        TemplateBox[{RowBox[{
            SubscriptBox[
             StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
            SuperscriptBox[
             StyleBox["r", FontWeight -> "Bold"], "'"]}]},
         "Abs"]], Cell[""], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
         SubscriptBox["\[Phi]", 
          RowBox[{
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "n"], "-", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]}]]}]], 
       RowBox[{
        SubscriptBox["\[Mu]", "s"], "(", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ")"}], 
       RowBox[{"f", "(", 
        RowBox[{
         SubscriptBox["\[Phi]", 
          RowBox[{
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "n"], "-", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]}]], "-", 
         SuperscriptBox["\[Phi]", "i"]}], ")"}], 
       RowBox[{"Exp", "(", 
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["\[Integral]", 
           SubscriptBox["C", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "'"]]], 
          RowBox[{
           SubscriptBox["\[Mu]", "t"], 
           RowBox[{"\[DifferentialD]", 
            SuperscriptBox["l", "'"]}]}]}]}], ")"}]}]}]}]}], 
   TraditionalForm]}]],
 "\nThe integral over ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["r",
     FontWeight->"Bold"], "'"], TraditionalForm]]],
 " is carried over the whole volume of interest\nThe integral can be divided \
into two parts\nFirst, the self term, i.e., the integral over ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "n"], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"S", "(", "n", ")"}], 
    RowBox[{
     SubscriptBox["\[Integral]", 
      SubscriptBox["S", "n"]], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[DifferentialD]", "2"], 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], Cell[""], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}]], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}], 
      RowBox[{"Exp", "(", 
       RowBox[{"-", 
        RowBox[{
         SubscriptBox["\[Integral]", 
          SubscriptBox["C", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]]], 
         RowBox[{
          SubscriptBox["\[Mu]", "t"], 
          RowBox[{"\[DifferentialD]", 
           SuperscriptBox["l", "'"]}]}]}]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    OverscriptBox["\[TildeEqual]", 
     RowBox[{
      StyleBox["R",
       FontWeight->"Bold"], "=", 
      RowBox[{
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"], "-", 
       SubscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "n"]}]}]], 
    RowBox[{
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{
      SubscriptBox["\[Integral]", 
       SubscriptBox["S", "n"]], 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[DifferentialD]", "2"], 
         StyleBox["R",
          FontWeight->"Bold"]}], "R"], Cell[""], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
         SubscriptBox["\[Phi]", 
          RowBox[{"-", 
           StyleBox["R",
            FontWeight->"Bold"]}]]}]], 
       RowBox[{
        SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
       RowBox[{"f", "(", 
        RowBox[{
         SubscriptBox["\[Phi]", 
          RowBox[{"-", 
           StyleBox["R",
            FontWeight->"Bold"]}]], "-", 
         SuperscriptBox["\[Phi]", "i"]}], ")"}], 
       RowBox[{"Exp", "(", 
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["\[Integral]", 
           SubscriptBox["C", "n"]], 
          RowBox[{
           SubscriptBox["\[Mu]", "t"], 
           RowBox[{"\[DifferentialD]", 
            SuperscriptBox["l", "'"]}]}]}]}], ")"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
     RowBox[{"Exp", "(", 
      RowBox[{"-", 
       RowBox[{
        SubscriptBox["\[Integral]", 
         SubscriptBox["C", "n"]], 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["l", "'"]}]}]}]}], ")"}], 
     RowBox[{
      SubscriptBox["\[Integral]", 
       SubscriptBox["S", "n"]], 
      RowBox[{
       RowBox[{"\[DifferentialD]", "R"}], 
       RowBox[{"\[DifferentialD]", 
        SubscriptBox["\[Phi]", 
         StyleBox["R",
          FontWeight->"Bold"]]}], Cell[""], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
         SubscriptBox["\[Phi]", 
          RowBox[{"-", 
           StyleBox["R",
            FontWeight->"Bold"]}]]}]], 
       RowBox[{"f", "(", 
        RowBox[{
         SubscriptBox["\[Phi]", 
          RowBox[{"-", 
           StyleBox["R",
            FontWeight->"Bold"]}]], "-", 
         SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    OverscriptBox["=", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SubscriptBox["\[Phi]", 
        StyleBox["R",
         FontWeight->"Bold"]]}], "=", 
      RowBox[{"\[DifferentialD]", 
       SubscriptBox["\[Phi]", 
        StyleBox[
         RowBox[{"-", "R"}],
         FontWeight->"Bold"]]}]}]], 
    RowBox[{
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
     RowBox[{"Exp", "(", 
      RowBox[{"-", 
       RowBox[{
        SubscriptBox["\[Integral]", 
         SubscriptBox["C", "n"]], 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["l", "'"]}]}]}]}], ")"}], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       SubscriptBox["R", "n"]], 
      RowBox[{
       RowBox[{"\[DifferentialD]", "R"}], 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "0", 
         RowBox[{"2", "\[Pi]"}]], 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          SubscriptBox["\[Phi]", 
           StyleBox[
            RowBox[{"-", "R"}],
            FontWeight->"Bold"]]}], Cell[""], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
           SubscriptBox["\[Phi]", 
            RowBox[{"-", 
             StyleBox["R",
              FontWeight->"Bold"]}]]}]], 
         RowBox[{"f", "(", 
          RowBox[{
           SubscriptBox["\[Phi]", 
            RowBox[{"-", 
             StyleBox["R",
              FontWeight->"Bold"]}]], "-", 
           SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
     RowBox[{"Exp", "(", 
      RowBox[{"-", 
       RowBox[{
        SubscriptBox["\[Integral]", 
         SubscriptBox["C", "n"]], 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["l", "'"]}]}]}]}], ")"}], 
     SubscriptBox["R", "n"], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       RowBox[{"2", "\[Pi]"}]], 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SubscriptBox["\[Phi]", 
         StyleBox[
          RowBox[{"-", "R"}],
          FontWeight->"Bold"]]}], Cell[""], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"m", "(", 
          RowBox[{
           SuperscriptBox["\[Phi]", "i"], "-", 
           SubscriptBox["\[Phi]", 
            RowBox[{"-", 
             StyleBox["R",
              FontWeight->"Bold"]}]]}], ")"}]}]], 
       RowBox[{"f", "(", 
        RowBox[{
         SubscriptBox["\[Phi]", 
          RowBox[{"-", 
           StyleBox["R",
            FontWeight->"Bold"]}]], "-", 
         SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
     RowBox[{"Exp", "(", 
      RowBox[{"-", 
       RowBox[{
        SubscriptBox["\[Integral]", 
         SubscriptBox["C", "n"]], 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["l", "'"]}]}]}]}], ")"}], 
     SqrtBox[
      RowBox[{
       RowBox[{"S", "(", "n", ")"}], "/", "\[Pi]"}]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       SuperscriptBox["\[Phi]", "i"]}]], 
     SuperscriptBox["g", 
      TemplateBox[{"m"},
       "Abs"]]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"S", "(", "n", ")"}], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       SuperscriptBox["\[Phi]", "i"]}]], 
     SuperscriptBox["g", 
      TemplateBox[{"m"},
       "Abs"]], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
     SqrtBox[
      RowBox[{
       RowBox[{"S", "(", "n", ")"}], "/", "\[Pi]"}]], 
     RowBox[{"Exp", "(", 
      RowBox[{"-", 
       RowBox[{
        SubscriptBox["\[Integral]", 
         SubscriptBox["C", "n"]], 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["l", "'"]}]}]}]}], ")"}]}]}], TraditionalForm]}]],
 "\nwhere\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["R", "n"], "=", 
    SqrtBox[
     RowBox[{
      RowBox[{"S", "(", "n", ")"}], "/", "\[Pi]"}]]}], TraditionalForm]]],
 " \tis the the radius of the equi-area circle of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "n"], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", "n"], "=", 
    SubscriptBox["C", 
     SubscriptBox[
      StyleBox["r",
       FontWeight->"Bold"], "n"]]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "m"], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       RowBox[{"2", "\[DoubledPi]"}]], 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["\[Phi]", "'"]}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"m", "(", 
          RowBox[{
           SuperscriptBox["\[Phi]", "'"], "-", "\[Phi]"}], ")"}]}]], 
       RowBox[{"f", "(", 
        RowBox[{"\[Phi]", "-", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}], "=", 
     SuperscriptBox["g", 
      TemplateBox[{"m"},
       "Abs"]]}]}], TraditionalForm]]],
 "\nCompared with the original incidence term\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["V", 
     RowBox[{"n", " ", "m"}]], "=", 
    RowBox[{
     RowBox[{"S", "(", "n", ")"}], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       SuperscriptBox["\[Phi]", "i"]}]]}]}], TraditionalForm]]],
 "\nSecond, the external terms\nDo the integral over an arbitray ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", 
    SuperscriptBox["n", "'"]], TraditionalForm]]],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["n", "'"], "\[NotEqual]", "n"}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"S", "(", "n", ")"}], 
    RowBox[{
     SubscriptBox["\[Integral]", 
      SubscriptBox["S", 
       SuperscriptBox["n", "'"]]], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[DifferentialD]", "2"], 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], Cell[""], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}]], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}], 
      RowBox[{"Exp", "(", 
       RowBox[{"-", 
        RowBox[{
         SubscriptBox["\[Integral]", 
          SubscriptBox["C", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]]], 
         RowBox[{
          SubscriptBox["\[Mu]", "t"], 
          RowBox[{"\[DifferentialD]", 
           SuperscriptBox["l", "'"]}]}]}]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"\[TildeEqual]", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"S", "(", "n", ")"}], 
       RowBox[{"S", "(", 
        SuperscriptBox["n", "'"], ")"}]}], 
      TemplateBox[{RowBox[{
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           SuperscriptBox["n", "'"]]}]},
       "Abs"]], Cell[""], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "n"], "-", 
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "'"]]}]]}]], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      SuperscriptBox["n", "'"], ")"}], 
     RowBox[{"f", "(", 
      RowBox[{
       SubscriptBox["\[Phi]", 
        RowBox[{
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "n"], "-", 
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "'"]]}]], "-", 
       SuperscriptBox["\[Phi]", "i"]}], ")"}], 
     RowBox[{"Exp", "(", 
      RowBox[{"-", 
       RowBox[{
        SubscriptBox["\[Integral]", 
         SubscriptBox["C", 
          SuperscriptBox["n", "'"]]], 
        RowBox[{
         SubscriptBox["\[Mu]", "t"], 
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox["l", "'"]}]}]}]}], ")"}]}]}], TraditionalForm]}]],
 "\nLet\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"damp", "(", "n", ")"}], "=", 
    RowBox[{"Exp", "(", 
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[Integral]", 
        SubscriptBox["C", "n"]], 
       RowBox[{
        SubscriptBox["\[Mu]", "t"], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["l", "'"]}]}]}]}], ")"}]}], TraditionalForm]]],
 "\t\tarray of ",
 Cell[BoxData[
  FormBox["Ns", TraditionalForm]]],
 " real numbers\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"r2rF", "(", 
     RowBox[{"n", ",", 
      SuperscriptBox["n", "'"]}], ")"}], "=", 
    RowBox[{"f", "(", 
     RowBox[{
      SubscriptBox["\[Phi]", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "n"], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]]}]], "-", 
      SuperscriptBox["\[Phi]", "i"]}], ")"}]}], TraditionalForm]]],
 "\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"Ns", "\[Times]", "Ns"}], TraditionalForm]]],
 " real numbers\nRecall that\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Zoff", "(", 
     RowBox[{"n", ",", 
      SuperscriptBox["n", "'"]}], ")"}], "=", 
    RowBox[{
     RowBox[{"S", "(", "n", ")"}], 
     RowBox[{
      RowBox[{"S", "(", 
       SuperscriptBox["n", "'"], ")"}], "/", 
      TemplateBox[{RowBox[{
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           SuperscriptBox["n", "'"]]}]},
       "Abs"]}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["v", 
       RowBox[{"n", " ", 
        SuperscriptBox["n", "'"]}]], ")"}], "m"], "=", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
      SubscriptBox["\[Phi]", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "n"], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]]}]]}], "]"}]}], TraditionalForm]]],
 "\nExpress the self- and external terms of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["V", "~"], 
    RowBox[{"(", 
     RowBox[{"n", " ", "m"}], ")"}]], TraditionalForm]]],
 " as\n\tself term:\n\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"S", "(", "n", ")"}], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
      SuperscriptBox["\[Phi]", "i"]}]], 
    SuperscriptBox["g", 
     TemplateBox[{"m"},
      "Abs"]], 
    RowBox[{
     SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
    SqrtBox[
     RowBox[{
      RowBox[{"S", "(", "n", ")"}], "/", "\[Pi]"}]], 
    RowBox[{"damp", "(", "n", ")"}]}], TraditionalForm]]],
 "\n\texternal terms:\n\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Zoff", "(", 
     RowBox[{"n", ",", 
      SuperscriptBox["n", "'"]}], ")"}], Cell[""], 
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["v", 
       RowBox[{"n", " ", 
        SuperscriptBox["n", "'"]}]], ")"}], "m"], 
    RowBox[{
     SubscriptBox["\[Mu]", "s"], "(", 
     SuperscriptBox["n", "'"], ")"}], 
    RowBox[{"r2rF", "(", 
     RowBox[{"n", ",", 
      SuperscriptBox["n", "'"]}], ")"}], 
    RowBox[{"damp", "(", 
     SuperscriptBox["n", "'"], ")"}]}], TraditionalForm]]],
 "\nSo that the new source term vector is\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["V", "sc"], ")"}], 
     RowBox[{"n", " ", "m"}]], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "(", "n", ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SuperscriptBox["\[Phi]", "i"]}]], 
      SuperscriptBox["g", 
       TemplateBox[{"m"},
        "Abs"]], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
      SqrtBox[
       RowBox[{
        RowBox[{"S", "(", "n", ")"}], "/", "\[Pi]"}]], 
      RowBox[{"damp", "(", "n", ")"}]}], "+", 
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{
        SuperscriptBox["n", "'"], "\[NotEqual]", "n"}]], 
      RowBox[{
       RowBox[{"Zoff", "(", 
        RowBox[{"n", ",", 
         SuperscriptBox["n", "'"]}], ")"}], Cell[""], 
       SubscriptBox[
        RowBox[{"(", 
         SubscriptBox["v", 
          RowBox[{"n", " ", 
           SuperscriptBox["n", "'"]}]], ")"}], "m"], 
       RowBox[{
        SubscriptBox["\[Mu]", "s"], "(", 
        SuperscriptBox["n", "'"], ")"}], 
       RowBox[{"r2rF", "(", 
        RowBox[{"n", ",", 
         SuperscriptBox["n", "'"]}], ")"}], 
       RowBox[{"damp", "(", 
        SuperscriptBox["n", "'"], ")"}]}]}]}]}], TraditionalForm]]],
 "\nNote that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Zoff", "(", 
     RowBox[{"n", ",", "n"}], ")"}], "=", "0"}], TraditionalForm]]],
 ", so that\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["V", "sc"], ")"}], 
     RowBox[{"n", " ", "m"}]], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "(", "n", ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SuperscriptBox["\[Phi]", "i"]}]], 
      SuperscriptBox["g", 
       TemplateBox[{"m"},
        "Abs"]], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
      SqrtBox[
       RowBox[{
        RowBox[{"S", "(", "n", ")"}], "/", "\[Pi]"}]], 
      RowBox[{"damp", "(", "n", ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{
        SuperscriptBox["n", "'"], "=", "1"}], "Ns"], 
      RowBox[{
       RowBox[{"Zoff", "(", 
        RowBox[{"n", ",", 
         SuperscriptBox["n", "'"]}], ")"}], Cell[""], 
       SubscriptBox[
        RowBox[{"(", 
         SubscriptBox["v", 
          RowBox[{"n", " ", 
           SuperscriptBox["n", "'"]}]], ")"}], "m"], 
       RowBox[{
        SubscriptBox["\[Mu]", "s"], "(", 
        SuperscriptBox["n", "'"], ")"}], 
       RowBox[{"r2rF", "(", 
        RowBox[{"n", ",", 
         SuperscriptBox["n", "'"]}], ")"}], 
       RowBox[{"damp", "(", 
        SuperscriptBox["n", "'"], ")"}]}]}]}]}], TraditionalForm]]],
 "\nLet\[CloseCurlyQuote]s temprarily treat ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["V", "~"], 
    RowBox[{"(", 
     RowBox[{"n", " ", "m"}], ")"}]], TraditionalForm]]],
 " as the components of a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[Times]", "m"}], TraditionalForm]]],
 " matrix to speed up calculation\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["V", "sc"], ")"}], 
     RowBox[{"n", " ", "m"}]], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
      SqrtBox[
       RowBox[{
        RowBox[{"S", "(", "n", ")"}], "/", "\[Pi]"}]], 
      RowBox[{"damp", "(", "n", ")"}], 
      SubscriptBox["V", 
       RowBox[{"n", " ", "m"}]], 
      SubscriptBox["\[ScriptG]", "m"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{
        SuperscriptBox["n", "'"], "=", "1"}], "Ns"], 
      RowBox[{
       RowBox[{"Zoff", "(", 
        RowBox[{"n", ",", 
         SuperscriptBox["n", "'"]}], ")"}], 
       RowBox[{"r2rF", "(", 
        RowBox[{"n", ",", 
         SuperscriptBox["n", "'"]}], ")"}], 
       RowBox[{"damp", "(", 
        SuperscriptBox["n", "'"], ")"}], 
       RowBox[{
        SubscriptBox["\[Mu]", "s"], "(", 
        SuperscriptBox["n", "'"], ")"}], 
       SubscriptBox[
        RowBox[{"(", 
         SubscriptBox["v", 
          RowBox[{"n", " ", 
           SuperscriptBox["n", "'"]}]], ")"}], "m"]}]}]}]}], 
   TraditionalForm]]],
 "\nSuch a format allows vectorization and intrinsic matrix operations, thus \
would be faster"
}], "Text",
 CellChangeTimes->{{3.586177175484004*^9, 3.586177228022156*^9}, {
   3.586177279871866*^9, 3.586177469386742*^9}, {3.586177510201112*^9, 
   3.5861775230538473`*^9}, {3.5861775901609173`*^9, 3.586177694412952*^9}, {
   3.586177737500887*^9, 3.5861777385860987`*^9}, {3.586177774965343*^9, 
   3.586177838313899*^9}, {3.586177897721486*^9, 3.586178087922144*^9}, {
   3.586178209384025*^9, 3.586178242273665*^9}, {3.58617831594983*^9, 
   3.586178411086779*^9}, {3.586178480653502*^9, 3.586178577012224*^9}, {
   3.5861786420935907`*^9, 3.586178712540103*^9}, {3.586181929778222*^9, 
   3.5861819606127253`*^9}, {3.586182201202607*^9, 3.586182208675177*^9}, {
   3.58618227733489*^9, 3.586182412631028*^9}, {3.586182443274184*^9, 
   3.586182478116477*^9}, {3.586182522374699*^9, 3.58618257117446*^9}, {
   3.586182690970069*^9, 3.586182729895026*^9}, {3.586182780362979*^9, 
   3.586182918052641*^9}, {3.586183051677718*^9, 3.586183104629982*^9}, {
   3.5861831601274853`*^9, 3.586183225771626*^9}, {3.586183361221064*^9, 
   3.5861834088889437`*^9}, {3.58618345774513*^9, 3.5861834882789917`*^9}, {
   3.5861836465472918`*^9, 3.586183658930058*^9}, {3.586183710313706*^9, 
   3.586183905603464*^9}, {3.586183947855208*^9, 3.5861840295303173`*^9}, {
   3.5861855814184017`*^9, 3.5861857098059263`*^9}, {3.586185781819758*^9, 
   3.586186097677055*^9}, {3.586186147264943*^9, 3.58618627940386*^9}, {
   3.586186342245667*^9, 3.586186481702841*^9}, {3.586186556629674*^9, 
   3.586186867649356*^9}, {3.58618726481667*^9, 3.5861872961996326`*^9}, {
   3.586187328241601*^9, 3.586187489641727*^9}, {3.586187549410334*^9, 
   3.5861877128009157`*^9}, {3.586187750499837*^9, 3.586187777884162*^9}, {
   3.5861878666155853`*^9, 3.586188150953326*^9}, {3.586188240132799*^9, 
   3.586188606805257*^9}, {3.5861922745800047`*^9, 3.5861922962660303`*^9}, {
   3.5861957401236773`*^9, 3.586195745428372*^9}, {3.586196067822795*^9, 
   3.58619610081031*^9}, 3.5861963295770473`*^9, {3.587747962391115*^9, 
   3.5877479623911753`*^9}, 3.5877544816804667`*^9, {3.587755973274032*^9, 
   3.5877561681292562`*^9}}],

Cell[TextData[{
 "Summary\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["V", "sc"], ")"}], 
     RowBox[{"n", " ", "m"}]], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", "n", ")"}], 
      SqrtBox[
       RowBox[{
        RowBox[{"S", "(", "n", ")"}], "/", "\[Pi]"}]], 
      RowBox[{"damp", "(", "n", ")"}], 
      SubscriptBox["V", 
       RowBox[{"n", " ", "m"}]], 
      SubscriptBox["\[ScriptG]", "m"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{
        SuperscriptBox["n", "'"], "=", "1"}], "Ns"], 
      RowBox[{
       RowBox[{"Zoff", "(", 
        RowBox[{"n", ",", 
         SuperscriptBox["n", "'"]}], ")"}], 
       RowBox[{"r2rF", "(", 
        RowBox[{"n", ",", 
         SuperscriptBox["n", "'"]}], ")"}], 
       RowBox[{"damp", "(", 
        SuperscriptBox["n", "'"], ")"}], 
       RowBox[{
        SubscriptBox["\[Mu]", "s"], "(", 
        SuperscriptBox["n", "'"], ")"}], 
       SubscriptBox[
        RowBox[{"(", 
         SubscriptBox["v", 
          RowBox[{"n", " ", 
           SuperscriptBox["n", "'"]}]], ")"}], "m"]}]}]}]}], 
   TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"damp", "(", "n", ")"}], "=", 
    RowBox[{"Exp", "(", 
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[Integral]", 
        SubscriptBox["C", "n"]], 
       RowBox[{
        SubscriptBox["\[Mu]", "t"], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["l", "'"]}]}]}]}], ")"}]}], TraditionalForm]]],
 "\t\tarray of ",
 Cell[BoxData[
  FormBox["Ns", TraditionalForm]]],
 " real numbers\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"r2rF", "(", 
     RowBox[{"n", ",", 
      SuperscriptBox["n", "'"]}], ")"}], "=", 
    RowBox[{"f", "(", 
     RowBox[{
      SubscriptBox["\[Phi]", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "n"], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]]}]], "-", 
      SuperscriptBox["\[Phi]", "i"]}], ")"}]}], TraditionalForm]]],
 "\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"Ns", "\[Times]", "Ns"}], TraditionalForm]]],
 " real numbers\nSome codes illustrating matrices operations:"
}], "Text",
 CellChangeTimes->{{3.586196236321821*^9, 3.586196311744913*^9}, {
  3.586196358048889*^9, 3.586196406869481*^9}, {3.586196571020335*^9, 
  3.586196579425563*^9}, {3.587756173556015*^9, 3.587756173556076*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "V", ",", "G", ",", "S", ",", "Vnew", ",", "v", ",", "g", ",", "s"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["v", 
      RowBox[{"i", ",", "j"}]], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["g", "j"], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["s", "i"], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vnew", "=", 
   RowBox[{"S", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"V", "\[Transpose]"}], "G"}], ")"}], "\[Transpose]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Vnew", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "V", ",", "G", ",", "S", ",", "Vnew", ",", "v", ",", "g", ",", "s"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.586193111041441*^9, 3.586193232095752*^9}, {
  3.586193356416944*^9, 3.586193395489588*^9}, {3.586196180789276*^9, 
  3.586196197861377*^9}, {3.586196971637163*^9, 3.586196973916953*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SubscriptBox["g", "1"], " ", 
       SubscriptBox["s", "1"], " ", 
       SubscriptBox["v", 
        RowBox[{"1", ",", "1"}]]}], 
      RowBox[{
       SubscriptBox["g", "2"], " ", 
       SubscriptBox["s", "1"], " ", 
       SubscriptBox["v", 
        RowBox[{"1", ",", "2"}]]}], 
      RowBox[{
       SubscriptBox["g", "3"], " ", 
       SubscriptBox["s", "1"], " ", 
       SubscriptBox["v", 
        RowBox[{"1", ",", "3"}]]}]},
     {
      RowBox[{
       SubscriptBox["g", "1"], " ", 
       SubscriptBox["s", "2"], " ", 
       SubscriptBox["v", 
        RowBox[{"2", ",", "1"}]]}], 
      RowBox[{
       SubscriptBox["g", "2"], " ", 
       SubscriptBox["s", "2"], " ", 
       SubscriptBox["v", 
        RowBox[{"2", ",", "2"}]]}], 
      RowBox[{
       SubscriptBox["g", "3"], " ", 
       SubscriptBox["s", "2"], " ", 
       SubscriptBox["v", 
        RowBox[{"2", ",", "3"}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.586193151082653*^9, 3.586193232447447*^9}, {
   3.586193374232267*^9, 3.5861933958588133`*^9}, {3.586196191697104*^9, 
   3.58619620531653*^9}, 3.586196974685954*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Something New", "Subtitle",
 CellChangeTimes->{{3.588070487483971*^9, 3.588070489339265*^9}}],

Cell[TextData[{
 "However, the new ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"(", 
     SubscriptBox["V", "sc"], ")"}], 
    RowBox[{"n", " ", "m"}]], TraditionalForm]]],
 " is not smooth enough\n(swith to general form from now)\nHigh noise at \
large ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"m"},
    "Abs"], TraditionalForm]]],
 " indicates that some component of delta function is still in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Psi]", "sc"], "(", 
    RowBox[{
     StyleBox["r",
      FontWeight->"Bold"], ",", 
     StyleBox["s",
      FontWeight->"Bold"]}], ")"}], TraditionalForm]]],
 "\nLet\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Psi]", "sc"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], 
      StyleBox[",",
       FontWeight->"Plain"], 
      StyleBox["s",
       FontWeight->"Bold"]}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Psi]", "sb"], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], 
       StyleBox[",",
        FontWeight->"Plain"], 
       StyleBox["s",
        FontWeight->"Bold"]}], ")"}], "+", 
     RowBox[{
      OverscriptBox["\[Psi]", "~"], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], 
       StyleBox[",",
        FontWeight->"Plain"], 
       StyleBox["s",
        FontWeight->"Bold"]}], ")"}]}]}], TraditionalForm]]],
 "\nThe subscript ",
 Cell[BoxData[
  FormBox[
   StyleBox["sb",
    FontSlant->"Italic"], TraditionalForm]]],
 " stands for scattering and ballistic\nThe tilded psi is expected to be \
smooth and small compared to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", "b"], TraditionalForm]]],
 "\nPlug in the following equation\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        SubscriptBox["\[Psi]", "sc"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         StyleBox["v",
          FontWeight->"Bold"]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       SubscriptBox["\[Psi]", "sc"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        StyleBox["s",
         FontWeight->"Bold"]}], ")"}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"f", "(", 
         RowBox[{
          StyleBox["s",
           FontWeight->"Bold"], "\[CenterDot]", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}], 
        RowBox[{
         SubscriptBox["\[Psi]", "sc"], "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}]}]}]}], "+", 
     RowBox[{
      SubscriptBox["q", "b"], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", 
       StyleBox["s",
        FontWeight->"Bold"]}], ")"}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["q", "b"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      StyleBox["s",
       FontWeight->"Bold"]}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         StyleBox["s",
          FontWeight->"Bold"], "'"]}], 
       RowBox[{"f", "(", 
        RowBox[{
         StyleBox["s",
          FontWeight->"Bold"], "\[CenterDot]", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], ")"}], 
       RowBox[{
        SubscriptBox["\[Psi]", "b"], "(", 
        RowBox[{
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ",", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], ")"}]}]}]}]}], TraditionalForm]]],
 "\nto get\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        SubscriptBox["\[Psi]", "sb"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         StyleBox["v",
          FontWeight->"Bold"]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       SubscriptBox["\[Psi]", "sb"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        StyleBox["s",
         FontWeight->"Bold"]}], ")"}]}], "+", 
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        OverscriptBox["\[Psi]", "~"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         StyleBox["v",
          FontWeight->"Bold"]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       OverscriptBox["\[Psi]", "~"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        StyleBox["s",
         FontWeight->"Bold"]}], ")"}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"f", "(", 
         RowBox[{
          StyleBox["s",
           FontWeight->"Bold"], "\[CenterDot]", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}], 
        RowBox[{
         SubscriptBox["\[Psi]", "sb"], "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}]}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"f", "(", 
         RowBox[{
          StyleBox["s",
           FontWeight->"Bold"], "\[CenterDot]", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}], 
        RowBox[{
         OverscriptBox["\[Psi]", "~"], "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}]}]}]}], "+", 
     RowBox[{
      SubscriptBox["q", "b"], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", 
       StyleBox["s",
        FontWeight->"Bold"]}], ")"}]}]}], TraditionalForm]]],
 "\nLet\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        SubscriptBox["\[Psi]", "sb"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         StyleBox["v",
          FontWeight->"Bold"]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       SubscriptBox["\[Psi]", "sb"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        StyleBox["s",
         FontWeight->"Bold"]}], ")"}]}]}], "=", 
    RowBox[{
     SubscriptBox["q", "b"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      StyleBox["s",
       FontWeight->"Bold"]}], ")"}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        OverscriptBox["\[Psi]", "~"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         StyleBox["v",
          FontWeight->"Bold"]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       OverscriptBox["\[Psi]", "~"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        StyleBox["s",
         FontWeight->"Bold"]}], ")"}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"f", "(", 
         RowBox[{
          StyleBox["s",
           FontWeight->"Bold"], "\[CenterDot]", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}], 
        RowBox[{
         OverscriptBox["\[Psi]", "~"], "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "'"]}], ")"}]}]}]}], "+", 
     RowBox[{
      SubscriptBox["q", "sb"], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", 
       StyleBox["s",
        FontWeight->"Bold"]}], ")"}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["q", "sb"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      StyleBox["s",
       FontWeight->"Bold"]}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         StyleBox["s",
          FontWeight->"Bold"], "'"]}], 
       RowBox[{"f", "(", 
        RowBox[{
         StyleBox["s",
          FontWeight->"Bold"], "\[CenterDot]", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], ")"}], 
       RowBox[{
        SubscriptBox["\[Psi]", "sb"], "(", 
        RowBox[{
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ",", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], ")"}]}]}]}]}], TraditionalForm]]],
 "\nWhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "b"], TraditionalForm]]],
 " is given by\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["q", "b"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      StyleBox["s",
       FontWeight->"Bold"]}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         StyleBox["s",
          FontWeight->"Bold"], "'"]}], 
       RowBox[{"f", "(", 
        RowBox[{
         StyleBox["s",
          FontWeight->"Bold"], "\[CenterDot]", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], ")"}], 
       RowBox[{
        SubscriptBox["\[Psi]", "b"], "(", 
        RowBox[{
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ",", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "'"]}], ")"}]}]}]}]}], TraditionalForm]]],
 "\nThe trick is to accurately evaluate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", "sb"], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.5877546591416063`*^9, 3.587754780171927*^9}, {
   3.587754837604998*^9, 3.587754868866865*^9}, {3.587755076513427*^9, 
   3.58775508843118*^9}, {3.58775516658142*^9, 3.587755193348472*^9}, {
   3.587756184210396*^9, 3.5877561971282177`*^9}, {3.587756302574592*^9, 
   3.587756661007721*^9}, {3.587763121872944*^9, 3.5877631855239353`*^9}, {
   3.5877632155350037`*^9, 3.5877633897653837`*^9}, {3.587828849132683*^9, 
   3.587828947614891*^9}, 3.587829081297731*^9}],

Cell[TextData[{
 "Now, let\[CloseCurlyQuote]s again switch back to 2D\nSummary of equation \
dependencies:\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Psi]", "=", 
    RowBox[{
     SubscriptBox["\[Psi]", "b"], "+", 
     SubscriptBox["\[Psi]", "sb"], "+", 
     OverscriptBox["\[Psi]", "~"]}]}], TraditionalForm]]],
 "\n\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        SubscriptBox["\[Psi]", "b"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       SubscriptBox["\[Psi]", "b"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "=", 
    RowBox[{"q", "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}], TraditionalForm]]],
 "\n\t\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"q", "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
     RowBox[{
      RowBox[{
      "point", " ", "source", " ", "far", " ", "down", " ", "the", " ", 
       "direction", " ", "of"}], "-", 
      SuperscriptBox[
       StyleBox["s",
        FontWeight->"Bold"], "i"]}]}], ",", " ", 
    RowBox[{"strength", " ", "equals", " ", "distance"}]}], TraditionalForm]]],
 "\t\t\n\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        SubscriptBox["\[Psi]", "sb"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       SubscriptBox["\[Psi]", "sb"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "=", 
    RowBox[{
     SubscriptBox["q", "b"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}], TraditionalForm]]],
 "\n\t\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["q", "b"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["\[Phi]", "'"]}], 
       RowBox[{"f", "(", 
        RowBox[{"\[Phi]", "-", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}], 
       RowBox[{
        SubscriptBox["\[Psi]", "b"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}]}], TraditionalForm]]],
 "\n\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["s",
       FontWeight->"Bold"], "\[CenterDot]", 
      RowBox[{"\[Del]", 
       RowBox[{
        OverscriptBox["\[Psi]", "~"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{
       OverscriptBox["\[Psi]", "~"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["\[Phi]", "'"]}], 
        RowBox[{"f", "(", 
         RowBox[{"\[Phi]", "-", 
          SuperscriptBox["\[Phi]", "'"]}], ")"}], 
        RowBox[{
         OverscriptBox["\[Psi]", "~"], "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}], "+", 
     RowBox[{
      SubscriptBox["q", "sb"], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}], TraditionalForm]]],
 "\n\t\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["q", "sb"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["\[Phi]", "'"]}], 
       RowBox[{"f", "(", 
        RowBox[{"\[Phi]", "-", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}], 
       RowBox[{
        SubscriptBox["\[Psi]", "sb"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}]}], TraditionalForm]]],
 "\t\nThe ballistic term and the test function are well known\n\t",
 Cell[BoxData[
  FormBox[
   FormBox[
    RowBox[{
     RowBox[{
      SubscriptBox["\[Psi]", "b"], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
     RowBox[{
      RowBox[{"\[Delta]", "(", 
       RowBox[{"\[Phi]", "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}], 
      RowBox[{"Exp", "(", 
       RowBox[{"-", 
        RowBox[{
         SubscriptBox["\[Integral]", 
          SubscriptBox["C", 
           StyleBox["r",
            FontWeight->"Bold"]]], 
         RowBox[{
          SubscriptBox["\[Mu]", "t"], 
          RowBox[{"\[DifferentialD]", "l"}]}]}]}], ")"}]}]}],
    TraditionalForm], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"g", "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      RowBox[{"\[Phi]", ";", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], ",", 
      SuperscriptBox["\[Phi]", "'"]}], ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      TemplateBox[{RowBox[{
          StyleBox["r", FontWeight -> "Bold"], "-", 
          SuperscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "'"]}]},
       "Abs"]], Cell[""], 
     RowBox[{"\[Delta]", "(", 
      RowBox[{"\[Phi]", "-", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]]}], ")"}], 
     RowBox[{"\[Delta]", "(", 
      RowBox[{
       SuperscriptBox["\[Phi]", "'"], "-", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]]}], ")"}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["g", "t"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      RowBox[{"\[Phi]", ";", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], ",", 
      SuperscriptBox["\[Phi]", "'"]}], ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      TemplateBox[{RowBox[{
          StyleBox["r", FontWeight -> "Bold"], "-", 
          SuperscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "'"]}]},
       "Abs"]], Cell[""], 
     RowBox[{"\[Delta]", "(", 
      RowBox[{"\[Phi]", "-", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]]}], ")"}], 
     RowBox[{"\[Delta]", "(", 
      RowBox[{
       SuperscriptBox["\[Phi]", "'"], "-", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]]}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Tau]", "(", 
        RowBox[{
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], "\[Rule]", 
         StyleBox["r",
          FontWeight->"Bold"]}], ")"}]}], "]"}]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox[" ",
     FontWeight->"Plain"], 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Psi]", 
       RowBox[{"n", " ", "m"}]], "(", 
      RowBox[{
       StyleBox["r",
        FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["S", "n"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Phi]"}]]}]}]}], 
   TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Tau]", "(", 
     RowBox[{
      SuperscriptBox[
       StyleBox["r",
        FontWeight->"Bold"], "'"], "\[Rule]", 
      StyleBox["r",
       FontWeight->"Bold"]}], ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Integral]", 
      SubscriptBox["C", 
       RowBox[{
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], "\[Rule]", 
        StyleBox["r",
         FontWeight->"Bold"]}]]], 
     RowBox[{
      SubscriptBox["\[Mu]", "t"], 
      RowBox[{"\[DifferentialD]", "l"}]}]}]}], TraditionalForm]]],
 "\t\toptical length along the line ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     StyleBox["r",
      FontWeight->"Bold"], "'"], "\[Rule]", 
    StyleBox["r",
     FontWeight->"Bold"]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Tau]", "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", 
      RowBox[{"-", 
       SuperscriptBox[
        StyleBox["s",
         FontWeight->"Bold"], "i"]}]}], ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Integral]", 
      SubscriptBox["C", 
       StyleBox["r",
        FontWeight->"Bold"]]], 
     RowBox[{
      SubscriptBox["\[Mu]", "t"], 
      RowBox[{"\[DifferentialD]", "l"}]}]}]}], TraditionalForm]]],
 "\nThe new input vector ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["V", "~"], 
    RowBox[{"n", " ", "m"}]], TraditionalForm]]],
 " can be calculated in the following order\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Psi]", "b"], "\[Rule]", 
    RowBox[{
     SubscriptBox["q", "b"], "\[Rule]", 
     RowBox[{
      SubscriptBox["\[Psi]", "sb"], "\[Rule]", 
      RowBox[{
       SubscriptBox["q", "sb"], "\[Rule]", 
       RowBox[{
        SubsuperscriptBox["\[Psi]", "sb", "i"], "\[Rule]", 
        SubscriptBox[
         OverscriptBox["V", "~"], 
         RowBox[{"n", " ", "m"}]]}]}]}]}]}], TraditionalForm]]],
 "\nStart:\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["q", "b"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     RowBox[{"f", "(", 
      RowBox[{"\[Phi]", "-", 
       SuperscriptBox["\[Phi]", "i"]}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Tau]", "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         RowBox[{"-", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}]}]}], 
   TraditionalForm]]],
 " (already done)\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Psi]", "sb"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["\[Phi]", "'"]}], 
      RowBox[{
       SubscriptBox["g", "t"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        RowBox[{"\[Phi]", ";", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], ",", 
        SuperscriptBox["\[Phi]", "'"]}], ")"}], 
      RowBox[{
       SubscriptBox["q", "b"], "(", 
       RowBox[{
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ",", 
        SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["\[Phi]", "'"]}], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           StyleBox["r", FontWeight -> "Bold"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], Cell[""], 
      RowBox[{"\[Delta]", "(", 
       RowBox[{"\[Phi]", "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}], ")"}], 
      RowBox[{"\[Delta]", "(", 
       RowBox[{
        SuperscriptBox["\[Phi]", "'"], "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], "\[Rule]", 
          StyleBox["r",
           FontWeight->"Bold"]}], ")"}]}], "]"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SuperscriptBox["\[Phi]", "'"], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           StyleBox["r", FontWeight -> "Bold"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], Cell[""], 
      RowBox[{"\[Delta]", "(", 
       RowBox[{"\[Phi]", "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], "\[Rule]", 
          StyleBox["r",
           FontWeight->"Bold"]}], ")"}]}], "]"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}]}]}]}], 
   TraditionalForm]}]],
 "\n\t\n\t\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["q", "sb"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["\[Phi]", "'"]}], 
       RowBox[{"f", "(", 
        RowBox[{"\[Phi]", "-", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}], 
       RowBox[{
        SubscriptBox["\[Psi]", "sb"], "(", 
        RowBox[{
         StyleBox["r",
          FontWeight->"Bold"], ",", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["\[Phi]", "'"]}], 
       RowBox[{"f", "(", 
        RowBox[{"\[Phi]", "-", 
         SuperscriptBox["\[Phi]", "'"]}], ")"}], 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[DifferentialD]", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}], 
         FractionBox["1", 
          TemplateBox[{RowBox[{
              StyleBox["r", FontWeight -> "Bold"], "-", 
              SuperscriptBox[
               StyleBox["r", FontWeight -> "Bold"], "'"]}]},
           "Abs"]], Cell[""], 
         RowBox[{"\[Delta]", "(", 
          RowBox[{
           SuperscriptBox["\[Phi]", "'"], "-", 
           SubscriptBox["\[Phi]", 
            RowBox[{
             StyleBox["r",
              FontWeight->"Bold"], "-", 
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "'"]}]]}], ")"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"\[Tau]", "(", 
            RowBox[{
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "'"], "\[Rule]", 
             StyleBox["r",
              FontWeight->"Bold"]}], ")"}]}], "]"}], 
         RowBox[{
          SubscriptBox["\[Mu]", "s"], "(", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"], ")"}], 
         RowBox[{"f", "(", 
          RowBox[{
           SubscriptBox["\[Phi]", 
            RowBox[{
             StyleBox["r",
              FontWeight->"Bold"], "-", 
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "'"]}]], "-", 
           SuperscriptBox["\[Phi]", "i"]}], ")"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"\[Tau]", "(", 
            RowBox[{
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "'"], ",", 
             RowBox[{"-", 
              SuperscriptBox[
               StyleBox["s",
                FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}]}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      StyleBox["r",
       FontWeight->"Bold"], ")"}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"]}], 
       FractionBox["1", 
        TemplateBox[{RowBox[{
            StyleBox["r", FontWeight -> "Bold"], "-", 
            SuperscriptBox[
             StyleBox["r", FontWeight -> "Bold"], "'"]}]},
         "Abs"]], 
       RowBox[{"f", "(", 
        RowBox[{"\[Phi]", "-", 
         SubscriptBox["\[Phi]", 
          RowBox[{
           StyleBox["r",
            FontWeight->"Bold"], "-", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]}]]}], ")"}], Cell[""], 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"\[Tau]", "(", 
          RowBox[{
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"], "\[Rule]", 
           StyleBox["r",
            FontWeight->"Bold"]}], ")"}]}], "]"}], 
       RowBox[{
        SubscriptBox["\[Mu]", "s"], "(", 
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ")"}], 
       RowBox[{"f", "(", 
        RowBox[{
         SubscriptBox["\[Phi]", 
          RowBox[{
           StyleBox["r",
            FontWeight->"Bold"], "-", 
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"]}]], "-", 
         SuperscriptBox["\[Phi]", "i"]}], ")"}], 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"\[Tau]", "(", 
          RowBox[{
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"], ",", 
           RowBox[{"-", 
            SuperscriptBox[
             StyleBox["s",
              FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}]}]}]}]}], 
   TraditionalForm]}]],
 "\n\t\n\t\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Psi]", "sb", "i"], "(", 
     RowBox[{
      StyleBox["r",
       FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["\[Phi]", "'"]}], 
      RowBox[{"g", "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", 
        RowBox[{"\[Phi]", ";", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], ",", 
        SuperscriptBox["\[Phi]", "'"]}], ")"}], 
      RowBox[{
       SubscriptBox["q", "sb"], "(", 
       RowBox[{
        SuperscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "'"], ",", 
        SuperscriptBox["\[Phi]", "'"]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["\[Phi]", "'"]}], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           StyleBox["r", FontWeight -> "Bold"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], Cell[""], 
      RowBox[{"\[Delta]", "(", 
       RowBox[{"\[Phi]", "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}], ")"}], 
      RowBox[{"\[Delta]", "(", 
       RowBox[{
        SuperscriptBox["\[Phi]", "'"], "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}], ")"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"], ")"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "''"]}], 
        FractionBox["1", 
         TemplateBox[{RowBox[{
             SuperscriptBox[
              StyleBox["r", FontWeight -> "Bold"], "'"], "-", 
             SuperscriptBox[
              StyleBox["r", FontWeight -> "Bold"], "''"]}]},
          "Abs"]], 
        RowBox[{"f", "(", 
         RowBox[{
          SuperscriptBox["\[Phi]", "'"], "-", 
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox[
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "'"],
             FontWeight->"Bold"], "-", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "''"]}]]}], ")"}], Cell[""], 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"\[Tau]", "(", 
           RowBox[{
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "''"], "\[Rule]", 
            StyleBox[
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "'"],
             FontWeight->"Bold"]}], ")"}]}], "]"}], 
        RowBox[{
         SubscriptBox["\[Mu]", "s"], "(", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "''"], ")"}], 
        RowBox[{"f", "(", 
         RowBox[{
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox[
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "'"],
             FontWeight->"Bold"], "-", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "''"]}]], "-", 
          SuperscriptBox["\[Phi]", "i"]}], ")"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"\[Tau]", "(", 
           RowBox[{
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "''"], ",", 
            RowBox[{"-", 
             SuperscriptBox[
              StyleBox["s",
               FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "''"]}], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           StyleBox["r", FontWeight -> "Bold"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], Cell[""], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "''"]}]},
        "Abs"]], 
      RowBox[{"\[Delta]", "(", 
       RowBox[{"\[Phi]", "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}], ")"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]], "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"]}]]}], ")"}], Cell[""], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"], "\[Rule]", 
          StyleBox[
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"],
           FontWeight->"Bold"]}], ")"}]}], "]"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "''"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}]}]}]}], 
   TraditionalForm]}]],
 "\n\t\n\t\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["V", "~"], 
     RowBox[{"n", " ", "m"}]], "=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{"\[DifferentialD]", 
       StyleBox["\[Phi]",
        FontWeight->"Plain"]}], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      RowBox[{
       SubsuperscriptBox["\[Psi]", 
        RowBox[{"n", " ", "m"}], "*"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}], 
      RowBox[{
       SubsuperscriptBox["\[Psi]", "sb", "i"], "(", 
       RowBox[{
        StyleBox["r",
         FontWeight->"Bold"], ",", "\[Phi]"}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{"\[DifferentialD]", 
       StyleBox["\[Phi]",
        FontWeight->"Plain"]}], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      RowBox[{
       SubscriptBox["S", "n"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "\[Phi]"}]], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "''"]}], 
        FractionBox["1", 
         TemplateBox[{RowBox[{
             StyleBox["r", FontWeight -> "Bold"], "-", 
             SuperscriptBox[
              StyleBox["r", FontWeight -> "Bold"], "'"]}]},
          "Abs"]], Cell[""], 
        FractionBox["1", 
         TemplateBox[{RowBox[{
             SuperscriptBox[
              StyleBox["r", FontWeight -> "Bold"], "'"], "-", 
             SuperscriptBox[
              StyleBox["r", FontWeight -> "Bold"], "''"]}]},
          "Abs"]], 
        RowBox[{"\[Delta]", "(", 
         RowBox[{"\[Phi]", "-", 
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox["r",
             FontWeight->"Bold"], "-", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "'"]}]]}], ")"}], 
        RowBox[{
         SubscriptBox["\[Mu]", "s"], "(", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], ")"}], 
        RowBox[{"f", "(", 
         RowBox[{
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox["r",
             FontWeight->"Bold"], "-", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "'"]}]], "-", 
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox[
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "'"],
             FontWeight->"Bold"], "-", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "''"]}]]}], ")"}], Cell[""], 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"\[Tau]", "(", 
           RowBox[{
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "''"], "\[Rule]", 
            StyleBox[
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "'"],
             FontWeight->"Bold"]}], ")"}]}], "]"}], 
        RowBox[{
         SubscriptBox["\[Mu]", "s"], "(", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "''"], ")"}], 
        RowBox[{"f", "(", 
         RowBox[{
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox[
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], "'"],
             FontWeight->"Bold"], "-", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "''"]}]], "-", 
          SuperscriptBox["\[Phi]", "i"]}], ")"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"\[Tau]", "(", 
           RowBox[{
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "''"], ",", 
            RowBox[{"-", 
             SuperscriptBox[
              StyleBox["s",
               FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["r",
        FontWeight->"Bold"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "''"]}], 
      StyleBox[" ",
       FontWeight->"Bold"], 
      RowBox[{
       SubscriptBox["S", "n"], "(", 
       StyleBox["r",
        FontWeight->"Bold"], ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}]], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           StyleBox["r", FontWeight -> "Bold"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], Cell[""], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "''"]}]},
        "Abs"]], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox["r",
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]], "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"]}]]}], ")"}], Cell[""], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"], "\[Rule]", 
          StyleBox[
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"],
           FontWeight->"Bold"]}], ")"}]}], "]"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "''"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    OverscriptBox["=", 
     RowBox[{"omitting", " ", 
      RowBox[{"S", "(", "n", ")"}]}]], 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "''"]}], 
      StyleBox[" ",
       FontWeight->"Bold"], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}]], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], Cell[""], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "''"]}]},
        "Abs"]], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]], "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"]}]]}], ")"}], Cell[""], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"], "\[Rule]", 
          StyleBox[
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"],
           FontWeight->"Bold"]}], ")"}]}], "]"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "''"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], "'"],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}]}]}]}], 
   TraditionalForm]}]],
 "\n\nThe double integral entails an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", 
    SuperscriptBox["Ns", "3"], ")"}], TraditionalForm]]],
 " operation\nBut anyway let\[CloseCurlyQuote]s do it to the very end"
}], "Text",
 CellChangeTimes->{{3.5878290870398808`*^9, 3.587829183544075*^9}, {
   3.587829524578683*^9, 3.587829529568454*^9}, {3.587829604079156*^9, 
   3.587829818771845*^9}, {3.5878304337511997`*^9, 3.58783047027884*^9}, {
   3.587830765992237*^9, 3.5878308041870737`*^9}, {3.587831683054422*^9, 
   3.587831724638543*^9}, {3.587832449098173*^9, 3.5878324536302347`*^9}, {
   3.587915177334012*^9, 3.587915573437076*^9}, {3.5879156872601852`*^9, 
   3.587915724621091*^9}, {3.58791623560361*^9, 3.5879162795488653`*^9}, {
   3.587916342203022*^9, 3.587916467410817*^9}, {3.5879165440429087`*^9, 
   3.587916786399815*^9}, {3.587917457717649*^9, 3.58791746162886*^9}, {
   3.587917500160083*^9, 3.587917772616354*^9}, {3.587917956146175*^9, 
   3.587918010818708*^9}, {3.587918065178464*^9, 3.587918117844468*^9}, {
   3.5879182180367537`*^9, 3.587918234060238*^9}, 3.587918277476198*^9, {
   3.5879215782643967`*^9, 3.587921639682993*^9}, {3.587922758989297*^9, 
   3.587922759482315*^9}, {3.587937588230006*^9, 3.587937617283722*^9}, 
   3.588092355243882*^9, 3.588092604107059*^9}],

Cell[TextData[{
 "The integrals over ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["r",
     FontWeight->"Bold"], "'"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["r",
     FontWeight->"Bold"], "''"], TraditionalForm]]],
 " are discretized into summations over mesh triangles\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "''"]}]}]}], "\[Rule]", 
    SubscriptBox["\[Sum]", 
     RowBox[{
      SuperscriptBox["n", "'"], 
      SuperscriptBox["n", "''"]}]]}], TraditionalForm]]],
 "\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["n", "'"], ",", 
    RowBox[{
     SuperscriptBox["n", "''"], "=", "1"}], ",", "2", ",", "...", ",", "Ns"}],
    TraditionalForm]]],
 "\nEach term in the summation (omitting ",
 Cell[BoxData[
  FormBox[
   RowBox[{"S", "(", "n", ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["n", "'"], "\[NotEqual]", "n"}], ",", 
    RowBox[{
     SuperscriptBox["n", "''"], "\[NotEqual]", 
     SuperscriptBox["n", "'"]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"S", "(", "n", ")"}], 
    FractionBox[
     RowBox[{"S", "(", 
      SuperscriptBox["n", "'"], ")"}], 
     TemplateBox[{RowBox[{
         StyleBox[
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           StyleBox["n", FontWeight -> "Plain"]], FontWeight -> "Bold"], "-", 
         SubscriptBox[
          StyleBox["r", FontWeight -> "Bold"], 
          SuperscriptBox["n", "'"]]}]},
      "Abs"]], Cell[""], 
    FractionBox[
     RowBox[{"S", "(", 
      SuperscriptBox["n", "''"], ")"}], 
     TemplateBox[{RowBox[{
         SubscriptBox[
          StyleBox["r", FontWeight -> "Bold"], 
          SuperscriptBox["n", "'"]], "-", 
         SubscriptBox[
          StyleBox["r", FontWeight -> "Bold"], 
          SuperscriptBox["n", "''"]]}]},
      "Abs"]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
      SubscriptBox["\[Phi]", 
       RowBox[{
        StyleBox[
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          StyleBox["n",
           FontWeight->"Plain"]],
         FontWeight->"Bold"], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]]}]]}]], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{"\[Tau]", "(", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "''"]], "\[Rule]", 
        StyleBox[
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox[
           StyleBox["n",
            FontWeight->"Plain"], 
           StyleBox["'",
            FontWeight->"Plain"]]],
         FontWeight->"Bold"]}], ")"}]}], "]"}], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{"\[Tau]", "(", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "''"]], ",", 
        RowBox[{"-", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
    RowBox[{
     SubscriptBox["\[Mu]", "s"], "(", 
     SuperscriptBox["n", "'"], ")"}], 
    RowBox[{
     SubscriptBox["\[Mu]", "s"], "(", 
     SuperscriptBox["n", "''"], ")"}], 
    RowBox[{"f", "(", 
     RowBox[{
      SubscriptBox["\[Phi]", 
       RowBox[{
        StyleBox[
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          StyleBox["n",
           FontWeight->"Plain"]],
         FontWeight->"Bold"], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]]}]], "-", 
      SubscriptBox["\[Phi]", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "''"]]}]]}], ")"}], Cell[""], 
    RowBox[{"f", "(", 
     RowBox[{
      SubscriptBox["\[Phi]", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "''"]]}]], "-", 
      SuperscriptBox["\[Phi]", "i"]}], ")"}]}], TraditionalForm]]],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["n", "'"], "=", "n"}], ",", 
    RowBox[{
     SuperscriptBox["n", "''"], "\[NotEqual]", 
     SuperscriptBox["n", "'"]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{"\[Integral]", 
    RowBox[{
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox[
       StyleBox["r",
        FontWeight->"Bold"], "'"]}], 
     FractionBox["1", 
      TemplateBox[{RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            StyleBox["n", FontWeight -> "Plain"]], FontWeight -> "Bold"], "-", 
          SuperscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "'"]}]},
       "Abs"]], Cell[""], 
     FractionBox[
      RowBox[{"S", "(", 
       SuperscriptBox["n", "''"], ")"}], 
      TemplateBox[{RowBox[{
          SuperscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "'"], "-", 
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           SuperscriptBox["n", "''"]]}]},
       "Abs"]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox[
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           StyleBox["n",
            FontWeight->"Plain"]],
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Tau]", "(", 
        RowBox[{
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "''"]], "\[Rule]", 
         StyleBox[
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"],
          FontWeight->"Bold"]}], ")"}]}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Tau]", "(", 
        RowBox[{
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "''"]], ",", 
         RowBox[{"-", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      SuperscriptBox[
       StyleBox["r",
        FontWeight->"Bold"], "'"], ")"}], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      SuperscriptBox["n", "''"], ")"}], 
     RowBox[{"f", "(", 
      RowBox[{
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox[
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           StyleBox["n",
            FontWeight->"Plain"]],
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]], "-", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], "-", 
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "''"]]}]]}], ")"}], Cell[""], 
     RowBox[{"f", "(", 
      RowBox[{
       SubscriptBox["\[Phi]", 
        RowBox[{
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"], "-", 
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "''"]]}]], "-", 
       SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           StyleBox[
            SubscriptBox[
             StyleBox["r", FontWeight -> "Bold"], 
             StyleBox["n", FontWeight -> "Plain"]], FontWeight -> "Bold"], 
           "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], Cell[""], 
      FractionBox[
       RowBox[{"S", "(", 
        SuperscriptBox["n", "''"], ")"}], 
       TemplateBox[{RowBox[{
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "'"]], "-", 
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "''"]]}]},
        "Abs"]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}]], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]], "\[Rule]", 
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox[
             SuperscriptBox["n", "'"],
             FontWeight->"Plain"]],
           FontWeight->"Bold"]}], ")"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox["n", "'"], ")"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox["n", "''"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]]}]], "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]]}]]}], ")"}], Cell[""], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           StyleBox[
            SubscriptBox[
             StyleBox["r", FontWeight -> "Bold"], 
             StyleBox["n", FontWeight -> "Plain"]], FontWeight -> "Bold"], 
           "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], Cell[""], 
      FractionBox[
       RowBox[{"S", "(", 
        SuperscriptBox["n", "''"], ")"}], 
       TemplateBox[{RowBox[{
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "'"]], "-", 
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "''"]]}]},
        "Abs"]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}]], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]], "\[Rule]", 
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox[
             SuperscriptBox["n", "'"],
             FontWeight->"Plain"]],
           FontWeight->"Bold"]}], ")"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox["n", "'"], ")"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox["n", "''"], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]], "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]]}]]}], ")"}], Cell[""], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           StyleBox[
            SubscriptBox[
             StyleBox["r", FontWeight -> "Bold"], 
             StyleBox["n", FontWeight -> "Plain"]], FontWeight -> "Bold"], 
           "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}]], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]], "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]]}]]}], ")"}], 
      FractionBox[
       RowBox[{"S", "(", 
        SuperscriptBox["n", "''"], ")"}], 
       TemplateBox[{RowBox[{
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "'"]], "-", 
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "''"]]}]},
        "Abs"]], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]], "\[Rule]", 
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox[
             SuperscriptBox["n", "'"],
             FontWeight->"Plain"]],
           FontWeight->"Bold"]}], ")"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox["n", "'"], ")"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox["n", "''"], ")"}], Cell[""], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    OverscriptBox["=", 
     RowBox[{
      StyleBox["R",
       FontWeight->"Bold"], "=", 
      RowBox[{
       SubscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "n"], "-", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}]}]], 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["R",
        FontWeight->"Bold"]}], 
      FractionBox["1", "R"], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         StyleBox["R",
          FontWeight->"Bold"]]}]], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         SubscriptBox["\[Phi]", 
          StyleBox["R",
           FontWeight->"Bold"]]], "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]]}]]}], ")"}], 
      FractionBox[
       RowBox[{"S", "(", 
        SuperscriptBox["n", "''"], ")"}], 
       TemplateBox[{RowBox[{
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "'"]], "-", 
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "''"]]}]},
        "Abs"]], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]], "\[Rule]", 
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox[
             SuperscriptBox["n", "'"],
             FontWeight->"Plain"]],
           FontWeight->"Bold"]}], ")"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox["n", "'"], ")"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox["n", "''"], ")"}], Cell[""], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", "R"}], 
      RowBox[{"\[DifferentialD]", 
       SubscriptBox["\[Phi]", 
        StyleBox["R",
         FontWeight->"Bold"]]}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"m", "(", 
         RowBox[{
          SubscriptBox["\[Phi]", 
           StyleBox["R",
            FontWeight->"Bold"]], "-", 
          SubscriptBox["\[Phi]", 
           RowBox[{
            SubscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], 
             SuperscriptBox["n", "'"]], "-", 
            SubscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], 
             SuperscriptBox["n", "''"]]}]]}], ")"}]}]], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         StyleBox["R",
          FontWeight->"Bold"]], "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]]}]]}], ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]]}]]}]], 
      FractionBox[
       RowBox[{"S", "(", 
        SuperscriptBox["n", "''"], ")"}], 
       TemplateBox[{RowBox[{
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "'"]], "-", 
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "''"]]}]},
        "Abs"]], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]], "\[Rule]", 
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox[
             SuperscriptBox["n", "'"],
             FontWeight->"Plain"]],
           FontWeight->"Bold"]}], ")"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox["n", "'"], ")"}], 
      RowBox[{
       SubscriptBox["\[Mu]", "s"], "(", 
       SuperscriptBox["n", "''"], ")"}], Cell[""], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"S", "(", "n", ")"}], "/", "\[Pi]"}]], 
     SuperscriptBox["g", 
      TemplateBox[{"m"},
       "Abs"]], 
     FractionBox[
      RowBox[{"S", "(", 
       SuperscriptBox["n", "''"], ")"}], 
      TemplateBox[{RowBox[{
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           SuperscriptBox["n", "''"]]}]},
       "Abs"]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "'"]], "-", 
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "''"]]}]]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Tau]", "(", 
        RowBox[{
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "''"]], "\[Rule]", 
         StyleBox[
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           StyleBox[
            SuperscriptBox["n", "'"],
            FontWeight->"Plain"]],
          FontWeight->"Bold"]}], ")"}]}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Tau]", "(", 
        RowBox[{
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "''"]], ",", 
         RowBox[{"-", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      SuperscriptBox["n", "'"], ")"}], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      SuperscriptBox["n", "''"], ")"}], Cell[""], 
     RowBox[{"f", "(", 
      RowBox[{
       SubscriptBox["\[Phi]", 
        RowBox[{
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "'"]], "-", 
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "''"]]}]], "-", 
       SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}], TraditionalForm]}]],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["n", "'"], "\[NotEqual]", "n"}], ",", 
    RowBox[{
     SuperscriptBox["n", "''"], "=", 
     SuperscriptBox["n", "'"]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{"\[Integral]", 
    RowBox[{
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox[
       StyleBox["r",
        FontWeight->"Bold"], "''"]}], 
     FractionBox[
      RowBox[{"S", "(", 
       SuperscriptBox["n", "'"], ")"}], 
      TemplateBox[{RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            StyleBox["n", FontWeight -> "Plain"]], FontWeight -> "Bold"], "-", 
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           SuperscriptBox["n", "'"]]}]},
       "Abs"]], Cell[""], 
     FractionBox["1", 
      TemplateBox[{RowBox[{
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SuperscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "''"]}]},
       "Abs"]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox[
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           StyleBox["n",
            FontWeight->"Plain"]],
          FontWeight->"Bold"], "-", 
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "'"]]}]]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Tau]", "(", 
        RowBox[{
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "''"], "\[Rule]", 
         StyleBox[
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox[
            StyleBox["n",
             FontWeight->"Plain"], 
            StyleBox["'",
             FontWeight->"Plain"]]],
          FontWeight->"Bold"]}], ")"}]}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Tau]", "(", 
        RowBox[{
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "''"]], ",", 
         RowBox[{"-", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      SuperscriptBox["n", "'"], ")"}], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      SuperscriptBox["n", "''"], ")"}], 
     RowBox[{"f", "(", 
      RowBox[{
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox[
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           StyleBox["n",
            FontWeight->"Plain"]],
          FontWeight->"Bold"], "-", 
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "'"]]}]], "-", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "'"]], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "''"]}]]}], ")"}], Cell[""], 
     RowBox[{"f", "(", 
      RowBox[{
       SubscriptBox["\[Phi]", 
        RowBox[{
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "'"]], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "''"]}]], "-", 
       SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "''"]}], Cell[""], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "'"]], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "''"]}]},
        "Abs"]], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]]}]], "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"]}]]}], ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["\[Mu]", "t"], "(", 
          SuperscriptBox["n", "'"], ")"}]}], 
        TemplateBox[{RowBox[{
            SubscriptBox[
             StyleBox["r", FontWeight -> "Bold"], 
             SuperscriptBox["n", "'"]], "-", 
            SuperscriptBox[
             StyleBox["r", FontWeight -> "Bold"], "''"]}]},
         "Abs"]}]], 
      FractionBox[
       RowBox[{"S", "(", 
        SuperscriptBox["n", "'"], ")"}], 
       TemplateBox[{RowBox[{
           StyleBox[
            SubscriptBox[
             StyleBox["r", FontWeight -> "Bold"], 
             StyleBox["n", FontWeight -> "Plain"]], FontWeight -> "Bold"], 
           "-", 
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "'"]]}]},
        "Abs"]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]]}]]}]], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
      RowBox[{
       SubsuperscriptBox["\[Mu]", "s", "2"], "(", 
       SuperscriptBox["n", "'"], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    OverscriptBox["=", 
     RowBox[{
      StyleBox["R",
       FontWeight->"Bold"], "=", 
      RowBox[{
       SubscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], 
        SuperscriptBox["n", "'"]], "-", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "''"]}]}]], 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       StyleBox["R",
        FontWeight->"Bold"]}], Cell[""], 
      FractionBox["1", "R"], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         StyleBox["R",
          FontWeight->"Bold"]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]]}]], "-", 
        SubscriptBox["\[Phi]", 
         StyleBox["R",
          FontWeight->"Bold"]]}], ")"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["\[Mu]", "t"], "(", 
          SuperscriptBox["n", "'"], ")"}]}], "R"}]], 
      FractionBox[
       RowBox[{"S", "(", 
        SuperscriptBox["n", "'"], ")"}], 
       TemplateBox[{RowBox[{
           StyleBox[
            SubscriptBox[
             StyleBox["r", FontWeight -> "Bold"], 
             StyleBox["n", FontWeight -> "Plain"]], FontWeight -> "Bold"], 
           "-", 
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            SuperscriptBox["n", "'"]]}]},
        "Abs"]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "'"]]}]]}]], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           SuperscriptBox["n", "''"]], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
      RowBox[{
       SubsuperscriptBox["\[Mu]", "s", "2"], "(", 
       SuperscriptBox["n", "'"], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", "R"}], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["\[Mu]", "t"], "(", 
          SuperscriptBox["n", "'"], ")"}]}], "R"}]], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SubscriptBox["\[Phi]", 
          StyleBox["R",
           FontWeight->"Bold"]]}], Cell[""], 
        RowBox[{"f", "(", 
         RowBox[{
          SubscriptBox["\[Phi]", 
           StyleBox["R",
            FontWeight->"Bold"]], "-", 
          SuperscriptBox["\[Phi]", "i"]}], ")"}], 
        RowBox[{"f", "(", 
         RowBox[{
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox[
             SubscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], 
              StyleBox["n",
               FontWeight->"Plain"]],
             FontWeight->"Bold"], "-", 
            SubscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], 
             SuperscriptBox["n", "'"]]}]], "-", 
          SubscriptBox["\[Phi]", 
           StyleBox["R",
            FontWeight->"Bold"]]}], ")"}], 
        FractionBox[
         RowBox[{"S", "(", 
          SuperscriptBox["n", "'"], ")"}], 
         TemplateBox[{RowBox[{
             StyleBox[
              SubscriptBox[
               StyleBox["r", FontWeight -> "Bold"], 
               StyleBox["n", FontWeight -> "Plain"]], FontWeight -> "Bold"], 
             "-", 
             SubscriptBox[
              StyleBox["r", FontWeight -> "Bold"], 
              SuperscriptBox["n", "'"]]}]},
          "Abs"]], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox[
             SubscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], 
              StyleBox["n",
               FontWeight->"Plain"]],
             FontWeight->"Bold"], "-", 
            SubscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], 
             SuperscriptBox["n", "'"]]}]]}]], 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"\[Tau]", "(", 
           RowBox[{
            SubscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], 
             SuperscriptBox["n", "''"]], ",", 
            RowBox[{"-", 
             SuperscriptBox[
              StyleBox["s",
               FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
        RowBox[{
         SubsuperscriptBox["\[Mu]", "s", "2"], "(", 
         SuperscriptBox["n", "'"], ")"}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", 
       RowBox[{"Exp", "(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           SubscriptBox["\[Mu]", "t"], "(", 
           SuperscriptBox["n", "'"], ")"}]}], 
         SqrtBox[
          RowBox[{
           RowBox[{"S", "(", 
            SuperscriptBox["n", "'"], ")"}], "/", "\[Pi]"}]]}], ")"}]}], 
      RowBox[{
       SubscriptBox["\[Mu]", "t"], "(", 
       SuperscriptBox["n", "'"], ")"}]], 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[DifferentialD]", 
        SubscriptBox["\[Phi]", 
         StyleBox["R",
          FontWeight->"Bold"]]}], Cell[""], 
       RowBox[{"f", "(", 
        RowBox[{
         SubscriptBox["\[Phi]", 
          StyleBox["R",
           FontWeight->"Bold"]], "-", 
         SuperscriptBox["\[Phi]", "i"]}], ")"}], 
       RowBox[{"f", "(", 
        RowBox[{
         SubscriptBox["\[Phi]", 
          RowBox[{
           StyleBox[
            SubscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], 
             StyleBox["n",
              FontWeight->"Plain"]],
            FontWeight->"Bold"], "-", 
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            SuperscriptBox["n", "'"]]}]], "-", 
         SubscriptBox["\[Phi]", 
          StyleBox["R",
           FontWeight->"Bold"]]}], ")"}], 
       FractionBox[
        RowBox[{"S", "(", 
         SuperscriptBox["n", "'"], ")"}], 
        TemplateBox[{RowBox[{
            StyleBox[
             SubscriptBox[
              StyleBox["r", FontWeight -> "Bold"], 
              StyleBox["n", FontWeight -> "Plain"]], FontWeight -> "Bold"], 
            "-", 
            SubscriptBox[
             StyleBox["r", FontWeight -> "Bold"], 
             SuperscriptBox["n", "'"]]}]},
         "Abs"]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
         SubscriptBox["\[Phi]", 
          RowBox[{
           StyleBox[
            SubscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], 
             StyleBox["n",
              FontWeight->"Plain"]],
            FontWeight->"Bold"], "-", 
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            SuperscriptBox["n", "'"]]}]]}]], 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"\[Tau]", "(", 
          RowBox[{
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            SuperscriptBox["n", "''"]], ",", 
           RowBox[{"-", 
            SuperscriptBox[
             StyleBox["s",
              FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
       RowBox[{
        SubsuperscriptBox["\[Mu]", "s", "2"], "(", 
        SuperscriptBox["n", "'"], ")"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"\[TildeEqual]", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"S", "(", 
        SuperscriptBox["n", "'"], ")"}], "/", "\[Pi]"}]], 
     RowBox[{
      SubscriptBox["f", 
       SuperscriptBox["g", "2"]], "(", 
      RowBox[{
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox[
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           StyleBox["n",
            FontWeight->"Plain"]],
          FontWeight->"Bold"], "-", 
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "'"]]}]], "-", 
       SuperscriptBox["\[Phi]", "i"]}], ")"}], 
     FractionBox[
      RowBox[{"S", "(", 
       SuperscriptBox["n", "'"], ")"}], 
      TemplateBox[{RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], 
            StyleBox["n", FontWeight -> "Plain"]], FontWeight -> "Bold"], "-", 
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           SuperscriptBox["n", "'"]]}]},
       "Abs"]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox[
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           StyleBox["n",
            FontWeight->"Plain"]],
          FontWeight->"Bold"], "-", 
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "'"]]}]]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Tau]", "(", 
        RowBox[{
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "'"]], ",", 
         RowBox[{"-", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
     RowBox[{
      SubsuperscriptBox["\[Mu]", "s", "2"], "(", 
      SuperscriptBox["n", "'"], ")"}]}]}], TraditionalForm]}]],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     SuperscriptBox["n", "'"], "=", 
     SuperscriptBox["n", "''"]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{"\[Integral]", 
    RowBox[{
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox[
       StyleBox["r",
        FontWeight->"Bold"], "'"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox[
       StyleBox["r",
        FontWeight->"Bold"], "''"]}], 
     StyleBox[" ",
      FontWeight->"Bold"], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox[
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           StyleBox["n",
            FontWeight->"Plain"]],
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]]}]], 
     FractionBox["1", 
      TemplateBox[{RowBox[{
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
          SuperscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "'"]}]},
       "Abs"]], Cell[""], 
     FractionBox["1", 
      TemplateBox[{RowBox[{
          SuperscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "'"], "-", 
          SuperscriptBox[
           StyleBox["r", FontWeight -> "Bold"], "''"]}]},
       "Abs"]], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      SuperscriptBox[
       StyleBox["r",
        FontWeight->"Bold"], "'"], ")"}], 
     RowBox[{"f", "(", 
      RowBox[{
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox[
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           StyleBox["n",
            FontWeight->"Plain"]],
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "'"]}]], "-", 
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox[
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           StyleBox["'",
            FontWeight->"Plain"]],
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "''"]}]]}], ")"}], Cell[""], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Tau]", "(", 
        RowBox[{
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "''"], "\[Rule]", 
         StyleBox[
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"],
          FontWeight->"Bold"]}], ")"}]}], "]"}], 
     RowBox[{
      SubscriptBox["\[Mu]", "s"], "(", 
      SuperscriptBox[
       StyleBox["r",
        FontWeight->"Bold"], "''"], ")"}], 
     RowBox[{"f", "(", 
      RowBox[{
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox[
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           StyleBox["'",
            FontWeight->"Plain"]],
          FontWeight->"Bold"], "-", 
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "''"]}]], "-", 
       SuperscriptBox["\[Phi]", "i"]}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Tau]", "(", 
        RowBox[{
         SuperscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "''"], ",", 
         RowBox[{"-", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "''"]}], 
      StyleBox[" ",
       FontWeight->"Bold"], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}]], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], Cell[""], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "''"]}]},
        "Abs"]], 
      RowBox[{
       SubsuperscriptBox["\[Mu]", "s", "2"], "(", "n", ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]], "-", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["'",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"]}]]}], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["'",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "''"]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}]], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], 
      RowBox[{
       SubsuperscriptBox["\[Mu]", "s", "2"], "(", "n", ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["r", "''"]}], 
        FractionBox["1", 
         TemplateBox[{RowBox[{
             SuperscriptBox[
              StyleBox["r", FontWeight -> "Bold"], "'"], "-", 
             SuperscriptBox[
              StyleBox["r", FontWeight -> "Bold"], "''"]}]},
          "Abs"]], 
        StyleBox[" ",
         FontWeight->"Bold"], 
        RowBox[{"f", "(", 
         RowBox[{
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox[
             SubscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], 
              StyleBox["n",
               FontWeight->"Plain"]],
             FontWeight->"Bold"], "-", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "'"]}]], "-", 
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox[
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], 
              StyleBox["'",
               FontWeight->"Plain"]],
             FontWeight->"Bold"], "-", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "''"]}]]}], ")"}], 
        RowBox[{"f", "(", 
         RowBox[{
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox[
             SuperscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], 
              StyleBox["'",
               FontWeight->"Plain"]],
             FontWeight->"Bold"], "-", 
            SuperscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], "''"]}]], "-", 
          SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox[
        StyleBox["r",
         FontWeight->"Bold"], "'"]}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          SuperscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "'"]}]]}]], 
      FractionBox["1", 
       TemplateBox[{RowBox[{
           SubscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "n"], "-", 
           SuperscriptBox[
            StyleBox["r", FontWeight -> "Bold"], "'"]}]},
        "Abs"]], 
      RowBox[{
       SubsuperscriptBox["\[Mu]", "s", "2"], "(", "n", ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"\[Tau]", "(", 
         RowBox[{
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], "n"], ",", 
          RowBox[{"-", 
           SuperscriptBox[
            StyleBox["s",
             FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
      SqrtBox[
       RowBox[{
        RowBox[{"S", "(", "n", ")"}], "/", "\[Pi]"}]], 
      RowBox[{
       SubscriptBox["f", 
        SuperscriptBox["g", "2"]], "(", 
       RowBox[{
        SubscriptBox["\[Phi]", 
         RowBox[{
          StyleBox[
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["n",
             FontWeight->"Plain"]],
           FontWeight->"Bold"], "-", 
          StyleBox[
           SuperscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            StyleBox["'",
             FontWeight->"Plain"]],
           FontWeight->"Bold"]}]], "-", 
        SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"S", "(", "n", ")"}], "/", "\[Pi]"}]], 
     SuperscriptBox["g", 
      RowBox[{"2", 
       TemplateBox[{"m"},
        "Abs"]}]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       SuperscriptBox["\[Phi]", "i"]}]], 
     RowBox[{
      SubsuperscriptBox["\[Mu]", "s", "2"], "(", "n", ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Tau]", "(", 
        RowBox[{
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "n"], ",", 
         RowBox[{"-", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
     SqrtBox[
      RowBox[{
       RowBox[{"S", "(", "n", ")"}], "/", "\[Pi]"}]]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"S", "(", "n", ")"}], 
     SuperscriptBox["\[Pi]", 
      RowBox[{"-", "1"}]], 
     SuperscriptBox["g", 
      RowBox[{"2", 
       TemplateBox[{"m"},
        "Abs"]}]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       SuperscriptBox["\[Phi]", "i"]}]], 
     RowBox[{
      SubsuperscriptBox["\[Mu]", "s", "2"], "(", "n", ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Tau]", "(", 
        RowBox[{
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], "n"], ",", 
         RowBox[{"-", 
          SuperscriptBox[
           StyleBox["s",
            FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}]}]}], 
   TraditionalForm]}]]
}], "Text",
 CellChangeTimes->{{3.587921774642013*^9, 3.5879218016583843`*^9}, {
   3.587921847773251*^9, 3.5879220962114*^9}, {3.5879221436035433`*^9, 
   3.587922190028626*^9}, 3.5879222960313673`*^9, {3.587922772917643*^9, 
   3.58792281736369*^9}, {3.5879229787426977`*^9, 3.5879231531832314`*^9}, {
   3.587923194105761*^9, 3.587923442656145*^9}, {3.587923496062714*^9, 
   3.5879235455852537`*^9}, {3.587923576964254*^9, 3.587923578907333*^9}, {
   3.5879236358201637`*^9, 3.5879236404638844`*^9}, {3.5879237141561317`*^9, 
   3.587923848748012*^9}, {3.587923885416091*^9, 3.587923957058136*^9}, {
   3.587923991822275*^9, 3.587924222098357*^9}, {3.587935769620461*^9, 
   3.587935838304522*^9}, {3.587935957496117*^9, 3.587935968246101*^9}, {
   3.5879362734123077`*^9, 3.587936291650622*^9}, {3.587936598028349*^9, 
   3.587936598322103*^9}, {3.587936632392811*^9, 3.587936634321622*^9}, {
   3.587936785445764*^9, 3.58793684429528*^9}, {3.587936942491232*^9, 
   3.5879370934808693`*^9}, {3.587937126530929*^9, 3.587937187394618*^9}, {
   3.587937233801668*^9, 3.587937233801744*^9}, {3.587937596409107*^9, 
   3.587937627669639*^9}, {3.587937861416706*^9, 3.587937874826281*^9}}],

Cell[TextData[{
 "Have used the fact that the convolution of two phase functions is just \
another phase function\n\t",
 Cell[BoxData[{
  FormBox[
   RowBox[{"\[Integral]", 
    RowBox[{
     RowBox[{"\[DifferentialD]", 
      SubscriptBox["\[Phi]", 
       StyleBox["R",
        FontWeight->"Bold"]]}], Cell[""], 
     RowBox[{
      SubscriptBox["f", "g"], "(", 
      RowBox[{
       SubscriptBox["\[Phi]", 
        StyleBox["R",
         FontWeight->"Bold"]], "-", 
       SuperscriptBox["\[Phi]", "i"]}], ")"}], 
     RowBox[{
      SubscriptBox["f", "g"], "(", 
      RowBox[{
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox[
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           StyleBox["n",
            FontWeight->"Plain"]],
          FontWeight->"Bold"], "-", 
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "'"]]}]], "-", 
       SubscriptBox["\[Phi]", 
        StyleBox["R",
         FontWeight->"Bold"]]}], ")"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"\[DifferentialD]", 
       SubscriptBox["\[Phi]", 
        StyleBox["R",
         FontWeight->"Bold"]]}], Cell[""], 
      FractionBox["1", 
       RowBox[{"2", "\[DoubledPi]"}]], 
      RowBox[{
       SubsuperscriptBox["\[Sum]", 
        RowBox[{
         SubscriptBox["m", "1"], "=", 
         RowBox[{"-", "\[Infinity]"}]}], "\[Infinity]"], 
       RowBox[{
        SuperscriptBox["g", 
         TemplateBox[{SubscriptBox["m", "1"]},
          "Abs"]], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SubscriptBox["m", "1"], "(", 
           RowBox[{
            SubscriptBox["\[Phi]", 
             StyleBox["R",
              FontWeight->"Bold"]], "-", 
            SuperscriptBox["\[Phi]", "i"]}], ")"}]}]], 
        FractionBox["1", 
         RowBox[{"2", "\[DoubledPi]"}]], 
        RowBox[{
         SubsuperscriptBox["\[Sum]", 
          RowBox[{
           SubscriptBox["m", "2"], "=", 
           RowBox[{"-", "\[Infinity]"}]}], "\[Infinity]"], 
         RowBox[{
          SuperscriptBox["g", 
           TemplateBox[{SubscriptBox["m", "2"]},
            "Abs"]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             SubscriptBox["m", "2"], "(", 
             RowBox[{
              SubscriptBox["\[Phi]", 
               RowBox[{
                StyleBox[
                 SubscriptBox[
                  StyleBox["r",
                   FontWeight->"Bold"], 
                  StyleBox["n",
                   FontWeight->"Plain"]],
                 FontWeight->"Bold"], "-", 
                SubscriptBox[
                 StyleBox["r",
                  FontWeight->"Bold"], 
                 SuperscriptBox["n", "'"]]}]], "-", 
              SubscriptBox["\[Phi]", 
               StyleBox["R",
                FontWeight->"Bold"]]}], ")"}]}]]}]}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", 
       SuperscriptBox["\[DoubledPi]", "2"]}]], 
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        SubscriptBox["m", "2"]}]], 
      RowBox[{"\[Integral]", 
       RowBox[{
        RowBox[{"\[DifferentialD]", 
         SubscriptBox["\[Phi]", 
          StyleBox["R",
           FontWeight->"Bold"]]}], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", "(", 
           RowBox[{
            SubscriptBox["m", "1"], "-", 
            SubscriptBox["m", "2"]}], ")"}], 
          SubscriptBox["\[Phi]", 
           StyleBox["R",
            FontWeight->"Bold"]]}]], 
        SuperscriptBox["g", 
         RowBox[{
          TemplateBox[{SubscriptBox["m", "1"]},
           "Abs"], "+", 
          TemplateBox[{SubscriptBox["m", "2"]},
           "Abs"]}]], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          SubscriptBox["m", "1"], 
          SuperscriptBox["\[Phi]", "i"]}]], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["m", "2"], 
          SubscriptBox["\[Phi]", 
           RowBox[{
            StyleBox[
             SubscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], 
              StyleBox["n",
               FontWeight->"Plain"]],
             FontWeight->"Bold"], "-", 
            SubscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], 
             SuperscriptBox["n", "'"]]}]]}]]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", 
       SuperscriptBox["\[DoubledPi]", "2"]}]], 
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{
        SubscriptBox["m", "1"], ",", 
        SubscriptBox["m", "2"]}]], 
      RowBox[{"2", "\[Pi]", " ", 
       SubscriptBox["\[Delta]", 
        RowBox[{
         SubscriptBox["m", "1"], 
         SubscriptBox["m", "2"]}]], 
       SuperscriptBox["g", 
        RowBox[{
         TemplateBox[{SubscriptBox["m", "1"]},
          "Abs"], "+", 
         TemplateBox[{SubscriptBox["m", "2"]},
          "Abs"]}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         SubscriptBox["m", "1"], 
         SuperscriptBox["\[Phi]", "i"]}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["m", "2"], 
         SubscriptBox["\[Phi]", 
          RowBox[{
           StyleBox[
            SubscriptBox[
             StyleBox["r",
              FontWeight->"Bold"], 
             StyleBox["n",
              FontWeight->"Plain"]],
            FontWeight->"Bold"], "-", 
           SubscriptBox[
            StyleBox["r",
             FontWeight->"Bold"], 
            SuperscriptBox["n", "'"]]}]]}]]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "\[Pi]"}]], 
     RowBox[{
      SubscriptBox["\[Sum]", "m"], 
      RowBox[{
       SuperscriptBox["g", 
        RowBox[{"2", 
         TemplateBox[{"m"},
          "Abs"]}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"m", "(", 
          RowBox[{
           SubscriptBox["\[Phi]", 
            RowBox[{
             StyleBox[
              SubscriptBox[
               StyleBox["r",
                FontWeight->"Bold"], 
               StyleBox["n",
                FontWeight->"Plain"]],
              FontWeight->"Bold"], "-", 
             SubscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], 
              SuperscriptBox["n", "'"]]}]], "-", 
           SuperscriptBox["\[Phi]", "i"]}], ")"}]}]]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", "\[Pi]"}]], 
      FractionBox[
       RowBox[{"1", "-", 
        SuperscriptBox["g", "4"]}], 
       RowBox[{"1", "+", 
        SuperscriptBox["g", "4"], "-", 
        RowBox[{"2", 
         SuperscriptBox["g", "2"], 
         RowBox[{"cos", "(", 
          RowBox[{
           SubscriptBox["\[Phi]", 
            RowBox[{
             StyleBox[
              SubscriptBox[
               StyleBox["r",
                FontWeight->"Bold"], 
               StyleBox["n",
                FontWeight->"Plain"]],
              FontWeight->"Bold"], "-", 
             SubscriptBox[
              StyleBox["r",
               FontWeight->"Bold"], 
              SuperscriptBox["n", "'"]]}]], "-", 
           SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}]]}], "\[Congruent]", 
     RowBox[{
      SubscriptBox["f", 
       SuperscriptBox["g", "2"]], "(", 
      RowBox[{
       SubscriptBox["\[Phi]", 
        RowBox[{
         StyleBox[
          SubscriptBox[
           StyleBox["r",
            FontWeight->"Bold"], 
           StyleBox["n",
            FontWeight->"Plain"]],
          FontWeight->"Bold"], "-", 
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox["n", "'"]]}]], "-", 
       SuperscriptBox["\[Phi]", "i"]}], ")"}]}]}], TraditionalForm]}],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.587934174679728*^9, 3.587934316860717*^9}, {
  3.587934354493987*^9, 3.587934627991393*^9}, {3.5879363733753157`*^9, 
  3.587936426649056*^9}, {3.587937007055653*^9, 3.58793700799905*^9}, {
  3.587937244903071*^9, 3.58793725307542*^9}}],

Cell[TextData[{
 "Summary (not omitting ",
 Cell[BoxData[
  FormBox[
   RowBox[{"S", "(", "n", ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "):\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["V", "~"], 
     RowBox[{"n", " ", "m"}]], "=", 
    SubsuperscriptBox["\[Sum]", 
     RowBox[{
      SuperscriptBox["n", "'"], ",", 
      RowBox[{
       SuperscriptBox["n", "''"], "=", "1"}]}], "Ns"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["n", "'"], "\[NotEqual]", "n"}], ",", 
    RowBox[{
     SuperscriptBox["n", "''"], "\[NotEqual]", 
     SuperscriptBox["n", "'"]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"S", "(", "n", ")"}], 
    RowBox[{"S", "(", 
     SuperscriptBox["n", "'"], ")"}], 
    RowBox[{"S", "(", 
     SuperscriptBox["n", "''"], ")"}], 
    FractionBox["1", 
     TemplateBox[{RowBox[{
         StyleBox[
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           StyleBox["n", FontWeight -> "Plain"]], FontWeight -> "Bold"], "-", 
         SubscriptBox[
          StyleBox["r", FontWeight -> "Bold"], 
          SuperscriptBox["n", "'"]]}]},
      "Abs"]], Cell[""], 
    FractionBox["1", 
     TemplateBox[{RowBox[{
         SubscriptBox[
          StyleBox["r", FontWeight -> "Bold"], 
          SuperscriptBox["n", "'"]], "-", 
         SubscriptBox[
          StyleBox["r", FontWeight -> "Bold"], 
          SuperscriptBox["n", "''"]]}]},
      "Abs"]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
      SubscriptBox["\[Phi]", 
       RowBox[{
        StyleBox[
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          StyleBox["n",
           FontWeight->"Plain"]],
         FontWeight->"Bold"], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]]}]]}]], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{"\[Tau]", "(", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "''"]], "\[Rule]", 
        StyleBox[
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          SuperscriptBox[
           StyleBox["n",
            FontWeight->"Plain"], 
           StyleBox["'",
            FontWeight->"Plain"]]],
         FontWeight->"Bold"]}], ")"}]}], "]"}], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{"\[Tau]", "(", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "''"]], ",", 
        RowBox[{"-", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
    RowBox[{
     SubscriptBox["\[Mu]", "s"], "(", 
     SuperscriptBox["n", "'"], ")"}], 
    RowBox[{
     SubscriptBox["\[Mu]", "s"], "(", 
     SuperscriptBox["n", "''"], ")"}], 
    RowBox[{"f", "(", 
     RowBox[{
      SubscriptBox["\[Phi]", 
       RowBox[{
        StyleBox[
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          StyleBox["n",
           FontWeight->"Plain"]],
         FontWeight->"Bold"], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]]}]], "-", 
      SubscriptBox["\[Phi]", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "''"]]}]]}], ")"}], Cell[""], 
    RowBox[{"f", "(", 
     RowBox[{
      SubscriptBox["\[Phi]", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "''"]]}]], "-", 
      SuperscriptBox["\[Phi]", "i"]}], ")"}]}], TraditionalForm]]],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["n", "'"], "=", "n"}], ",", 
    RowBox[{
     SuperscriptBox["n", "''"], "\[NotEqual]", 
     SuperscriptBox["n", "'"]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["S", 
      RowBox[{"3", "/", "2"}]], "(", "n", ")"}], 
    SuperscriptBox["\[Pi]", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]], 
    SuperscriptBox["g", 
     TemplateBox[{"m"},
      "Abs"]], 
    FractionBox[
     RowBox[{"S", "(", 
      SuperscriptBox["n", "''"], ")"}], 
     TemplateBox[{RowBox[{
         SubscriptBox[
          StyleBox["r", FontWeight -> "Bold"], 
          SuperscriptBox["n", "'"]], "-", 
         SubscriptBox[
          StyleBox["r", FontWeight -> "Bold"], 
          SuperscriptBox["n", "''"]]}]},
      "Abs"]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
      SubscriptBox["\[Phi]", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "''"]]}]]}]], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{"\[Tau]", "(", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "''"]], "\[Rule]", 
        StyleBox[
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          StyleBox[
           SuperscriptBox["n", "'"],
           FontWeight->"Plain"]],
         FontWeight->"Bold"]}], ")"}]}], "]"}], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{"\[Tau]", "(", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "''"]], ",", 
        RowBox[{"-", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
    RowBox[{
     SubscriptBox["\[Mu]", "s"], "(", 
     SuperscriptBox["n", "'"], ")"}], 
    RowBox[{
     SubscriptBox["\[Mu]", "s"], "(", 
     SuperscriptBox["n", "''"], ")"}], Cell[""], 
    RowBox[{"f", "(", 
     RowBox[{
      SubscriptBox["\[Phi]", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "''"]]}]], "-", 
      SuperscriptBox["\[Phi]", "i"]}], ")"}]}], TraditionalForm]]],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["n", "'"], "\[NotEqual]", "n"}], ",", 
    RowBox[{
     SuperscriptBox["n", "''"], "=", 
     SuperscriptBox["n", "'"]}]}], TraditionalForm]]],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"S", "(", "n", ")"}], 
    RowBox[{
     SuperscriptBox["S", 
      RowBox[{"1", "/", "2"}]], "(", 
     SuperscriptBox["n", "'"], ")"}], 
    SuperscriptBox["\[Pi]", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]], 
    RowBox[{
     SubscriptBox["f", 
      SuperscriptBox["g", "2"]], "(", 
     RowBox[{
      SubscriptBox["\[Phi]", 
       RowBox[{
        StyleBox[
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          StyleBox["n",
           FontWeight->"Plain"]],
         FontWeight->"Bold"], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]]}]], "-", 
      SuperscriptBox["\[Phi]", "i"]}], ")"}], 
    FractionBox[
     RowBox[{"S", "(", 
      SuperscriptBox["n", "'"], ")"}], 
     TemplateBox[{RowBox[{
         StyleBox[
          SubscriptBox[
           StyleBox["r", FontWeight -> "Bold"], 
           StyleBox["n", FontWeight -> "Plain"]], FontWeight -> "Bold"], "-", 
         SubscriptBox[
          StyleBox["r", FontWeight -> "Bold"], 
          SuperscriptBox["n", "'"]]}]},
      "Abs"]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
      SubscriptBox["\[Phi]", 
       RowBox[{
        StyleBox[
         SubscriptBox[
          StyleBox["r",
           FontWeight->"Bold"], 
          StyleBox["n",
           FontWeight->"Plain"]],
         FontWeight->"Bold"], "-", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]]}]]}]], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{"\[Tau]", "(", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], 
         SuperscriptBox["n", "'"]], ",", 
        RowBox[{"-", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}], 
    RowBox[{
     SubsuperscriptBox["\[Mu]", "s", "2"], "(", 
     SuperscriptBox["n", "'"], ")"}]}], TraditionalForm]]],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     SuperscriptBox["n", "'"], "=", 
     SuperscriptBox["n", "''"]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["S", "2"], "(", "n", ")"}], 
    SuperscriptBox["\[Pi]", 
     RowBox[{"-", "1"}]], 
    SuperscriptBox["g", 
     RowBox[{"2", 
      TemplateBox[{"m"},
       "Abs"]}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
      SuperscriptBox["\[Phi]", "i"]}]], 
    RowBox[{
     SubsuperscriptBox["\[Mu]", "s", "2"], "(", "n", ")"}], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{"\[Tau]", "(", 
       RowBox[{
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "n"], ",", 
        RowBox[{"-", 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Bold"], "i"]}]}], ")"}]}], "]"}]}], TraditionalForm]]],
 "\nwhere\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["f", "g"], "(", "\[Phi]", ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "\[Pi]"}]], 
     FractionBox[
      RowBox[{"1", "-", 
       SuperscriptBox["g", "2"]}], 
      RowBox[{"1", "+", 
       SuperscriptBox["g", "2"], "-", 
       RowBox[{"2", "g", " ", 
        RowBox[{"cos", "(", "\[Phi]", ")"}]}]}]]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["f", 
      SuperscriptBox["g", "2"]], "(", "\[Phi]", ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "\[Pi]"}]], 
     FractionBox[
      RowBox[{"1", "-", 
       SuperscriptBox["g", "4"]}], 
      RowBox[{"1", "+", 
       SuperscriptBox["g", "4"], "-", 
       RowBox[{"2", 
        SuperscriptBox["g", "2"], 
        RowBox[{"cos", "(", "\[Phi]", ")"}]}]}]]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.587937261172411*^9, 3.587937263587049*^9}, {
  3.5879373085534363`*^9, 3.587937325971547*^9}, {3.587937636862196*^9, 
  3.5879377063877077`*^9}, {3.587937877602014*^9, 3.5879380142645683`*^9}}]
}, Open  ]]
},
WindowSize->{717, 852},
WindowMargins->{{Automatic, 8}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{612, 792}},
ShowSelection->True,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 20, \
2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 148, 3, 51, "Subtitle"],
Cell[730, 27, 30044, 1080, 1187, "Text"],
Cell[30777, 1109, 12991, 430, 565, "Text"],
Cell[43771, 1541, 22008, 670, 771, "Text"],
Cell[65782, 2213, 37804, 1136, 1325, "Text"],
Cell[103589, 3351, 9660, 242, 232, "Text"],
Cell[113252, 3595, 5361, 143, 137, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118650, 3743, 299, 9, 52, "Subtitle"],
Cell[118952, 3754, 25369, 807, 954, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144358, 4566, 145, 3, 51, "Subtitle"],
Cell[144506, 4571, 13548, 441, 680, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158091, 5017, 115, 1, 51, "Subtitle"],
Cell[158209, 5020, 1966, 55, 220, "Text"],
Cell[160178, 5077, 11081, 391, 409, "Text"],
Cell[171262, 5470, 48673, 1592, 2014, "Text"],
Cell[219938, 7064, 2547, 86, 159, "Text"],
Cell[CellGroupData[{
Cell[222510, 7154, 1470, 44, 139, "Input"],
Cell[223983, 7200, 1666, 50, 51, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[225698, 7256, 99, 1, 51, "Subtitle"],
Cell[225800, 7259, 13081, 469, 442, "Text"],
Cell[238884, 7730, 41892, 1382, 1339, "Text"],
Cell[280779, 9114, 60712, 1979, 1483, "Text"],
Cell[341494, 11095, 8840, 280, 303, "Text"],
Cell[350337, 11377, 11358, 397, 428, "Text"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
