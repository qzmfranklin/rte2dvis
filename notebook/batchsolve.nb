(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     98065,       2333]
NotebookOptionsPosition[     97103,       2298]
NotebookOutlinePosition[     97440,       2313]
CellTagsIndexPosition[     97397,       2310]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<Developer`\>\"", "]"}], "\n", 
 RowBox[{"Needs", "[", "\"\<CCompilerDriver`\>\"", "]"}], "\n", 
 RowBox[{"Needs", "[", "\"\<Developer`\>\"", "]"}], "\n", 
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "ReadMSHFile", ",", "DumpMSHFileTo2DATFiles", ",", 
   "ReadMSHFileFrom2DATFiles"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"ReadMSHFile", "[", "filename_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "SkipStreamNumbers", ",", "ReadStreamNumbers", ",", "meshStr", 
      ",", "nNodes", ",", "nodesTable", ",", "nElements", ",", "nPoints", ",",
       "nLines", ",", "nTriangles", ",", "trianglesTable", ",", "temp"}], 
     "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"SkipStreamNumbers", "=", 
      RowBox[{
       RowBox[{"Skip", "[", 
        RowBox[{"#1", ",", 
         RowBox[{"Table", "[", 
          RowBox[{"Number", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Range", "[", "#2", "]"}]}], "}"}]}], "]"}]}], "]"}], 
       "&"}]}], ";", "\n", 
     RowBox[{"ReadStreamNumbers", "=", 
      RowBox[{
       RowBox[{"Read", "[", 
        RowBox[{"#1", ",", 
         RowBox[{"Table", "[", 
          RowBox[{"Number", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Range", "[", "#2", "]"}]}], "}"}]}], "]"}]}], "]"}], 
       "&"}]}], ";", "\n", 
     RowBox[{"meshStr", "=", 
      RowBox[{"OpenRead", "[", "filename", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Find", "[", 
      RowBox[{"meshStr", ",", "\"\<$Nodes\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nNodes", "=", 
      RowBox[{"Read", "[", 
       RowBox[{"meshStr", ",", "Number"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nodesTable", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0.0", ",", 
        RowBox[{"{", 
         RowBox[{"nNodes", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "nNodes"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Skip", "[", 
         RowBox[{"meshStr", ",", "Number"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "nodesTable", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
          "=", 
         RowBox[{"N", "@", 
          RowBox[{"ReadStreamNumbers", "[", 
           RowBox[{"meshStr", ",", "2"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Skip", "[", 
         RowBox[{"meshStr", ",", "Number"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Find", "[", 
      RowBox[{"meshStr", ",", "\"\<$Elements\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nElements", "=", 
      RowBox[{"Read", "[", 
       RowBox[{"meshStr", ",", "Number"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nPoints", "=", "0"}], ";", 
     RowBox[{"nLines", "=", "0"}], ";", 
     RowBox[{"nTriangles", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"trianglesTable", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0.0", ",", 
        RowBox[{"{", 
         RowBox[{"nElements", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "nElements"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Skip", "[", 
         RowBox[{"meshStr", ",", "Number"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"temp", "=", 
         RowBox[{"Read", "[", 
          RowBox[{"meshStr", ",", "Number"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"temp", "\[Equal]", "15"}], ",", 
          RowBox[{
           RowBox[{"nPoints", "++"}], ";", 
           RowBox[{"SkipStreamNumbers", "[", 
            RowBox[{"meshStr", ",", "4"}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"temp", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"nLines", "++"}], ";", 
           RowBox[{"SkipStreamNumbers", "[", 
            RowBox[{"meshStr", ",", "5"}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"temp", "\[Equal]", "2"}], ",", 
          RowBox[{
           RowBox[{"nTriangles", "++"}], ";", 
           RowBox[{"SkipStreamNumbers", "[", 
            RowBox[{"meshStr", ",", "3"}], "]"}], ";", 
           RowBox[{
            RowBox[{
            "trianglesTable", "\[LeftDoubleBracket]", "nTriangles", 
             "\[RightDoubleBracket]"}], "=", 
            RowBox[{"N", "@", 
             RowBox[{"ReadStreamNumbers", "[", 
              RowBox[{"meshStr", ",", "3"}], "]"}]}]}], ";"}]}], "]"}], 
        ";"}]}], "\n", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"trianglesTable", "=", 
      RowBox[{"trianglesTable", "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", "nTriangles"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Close", "[", "meshStr", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ToPackedArray", "/@", 
      RowBox[{"{", 
       RowBox[{"nodesTable", ",", 
        RowBox[{"Floor", "@", "trianglesTable"}]}], "}"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"DumpMSHFileTo2DATFiles", "[", "mshfilename_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dir", ",", "nodesTable", ",", "trianglesTable"}], "}"}], ",", 
    "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nodesTable", ",", "trianglesTable"}], "}"}], "=", 
      RowBox[{"ReadMSHFile", "[", "mshfilename", "]"}]}], ";", "\n", 
     RowBox[{"dir", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DirectoryName", "[", "mshfilename", "]"}], ",", 
         RowBox[{
          RowBox[{"FileBaseName", "[", "mshfilename", "]"}], "<>", 
          "\"\<.dat\>\""}]}], "}"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"CreateDirectory", "[", "dir", "]"}], "//", "Quiet"}], ";", 
     "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<directory created:\>\"", ",", "dir"}], "]"}], ";", "\n", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "\"\<nodes.dat\>\""}], "}"}], "]"}], ",", 
       "nodesTable"}], "]"}], ";", "\n", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "\"\<triangles.dat\>\""}], "}"}], "]"}], ",", 
       "trianglesTable"}], "]"}], ";", "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<exported nodes file: \>\"", ",", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "\"\<nodes.dat\>\""}], "}"}], "]"}]}], "]"}], 
     ";", "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<exported triangles file: \>\"", ",", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "\"\<triangles.dat\>\""}], "}"}], "]"}]}], "]"}],
      ";"}]}], "\n", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ReadMSHFileFrom2DATFiles", "[", "mshfilename_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "dir", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"dir", "=", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DirectoryName", "[", "mshfilename", "]"}], ",", 
          RowBox[{
           RowBox[{"FileBaseName", "[", "mshfilename", "]"}], "<>", 
           "\"\<.dat\>\""}]}], "}"}], "]"}]}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<imported nodes file: \>\"", ",", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"dir", ",", "\"\<nodes.dat\>\""}], "}"}], "]"}]}], "]"}], 
      ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<imported triangles file: \>\"", ",", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"dir", ",", "\"\<triangles.dat\>\""}], "}"}], "]"}]}], 
       "]"}], ";", "\n", 
      RowBox[{"ToPackedArray", "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"Import", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"dir", ",", "\"\<nodes.dat\>\""}], "}"}], "]"}], "]"}]}],
          ",", 
         RowBox[{"Import", "[", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"dir", ",", "\"\<triangles.dat\>\""}], "}"}], "]"}], 
          "]"}]}], "}"}]}]}]}], "\n", "]"}]}], "\n"}], "\n", 
 RowBox[{"Needs", "[", "\"\<CCompilerDriver`\>\"", "]"}], "\n", 
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "cflags", ",", "dir", ",", "incdir", ",", "libdir", ",", "xlib", ",", "src",
    ",", "lib"}], "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"lib", "=", "\"\<libmll\>\""}], ";"}], "\n", 
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{"cflags", "=", "\"\<-O3 -Wall -fopenmp -m64\>\""}], ";", "\n", 
    RowBox[{"dir", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<../src/mll\>\""}], 
       "}"}], "]"}]}], ";", "\n", 
    RowBox[{"incdir", "=", "\"\</opt/intel/mkl/include\>\""}], ";", "\n", 
    RowBox[{"libdir", "=", "\"\</opt/intel/mkl/lib/intel64\>\""}], ";", "\n", 
    
    RowBox[{"xlib", "=", "\"\<\>\""}], ";", "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"xlib", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<fftw3\>\"", ",", "\"\<mkl_core\>\"", ",", 
         "\"\<mkl_intel_lp64\>\"", ",", "\"\<mkl_sequential\>\"", ",", 
         "\"\<pthread\>\"", ",", "\"\<m\>\""}], "}"}]}], ";"}], "*)"}], "\n", 
    
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "xlib", "=", 
       "\"\<-lmkl_intel_lp64 -lmkl_core -lmkl_sequential -lpthread -lm\>\""}],
       ";"}], "*)"}], "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"xlib", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<-lmkl_intel_lp64\>\"", ",", "\"\<-lmkl_core\>\"", ",", 
         "\"\<-lmkl_sequentia;\>\"", ",", "\"\<-lpthread\>\"", ",", 
         "\"\<-lm\>\""}], "}"}]}], ";"}], "*)"}], "\n", 
    RowBox[{"src", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<dunavant-rule.cpp\>\"", ",", "\"\<legendre-rule.cpp\>\"", ",", 
        "\"\<arcsinh-rule.cpp\>\"", ",", "\"\<mll.cpp\>\""}], "}"}], "//", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"dir", ",", "#"}], "}"}], "]"}], "&"}], ",", "#"}], "]"}],
        "&"}]}]}], ";", "\n", 
    RowBox[{"lib", "=", 
     RowBox[{"CreateLibrary", "[", 
      RowBox[{"src", ",", "\"\<libmll\>\"", ",", 
       RowBox[{"\"\<Libraries\>\"", "\[Rule]", "xlib"}], ",", 
       RowBox[{"\"\<IncludeDirectories\>\"", "\[Rule]", "incdir"}], ",", 
       RowBox[{"\"\<LibraryDirectories\>\"", "\[Rule]", "libdir"}], ",", 
       RowBox[{"\"\<CompileOptions\>\"", "\[Rule]", "cflags"}]}], "]"}]}], 
    ";", "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"lib", "=", 
       RowBox[{"CreateLibrary", "[", 
        RowBox[{"src", ",", "\"\<libmll\>\"", ",", 
         RowBox[{"\"\<Libraries\>\"", "\[Rule]", "\"\<fftw3\>\""}], ",", 
         RowBox[{"\"\<CompileOptions\>\"", "\[Rule]", "cflags"}]}], "]"}]}], 
      ";"}], "*)"}], "\n", 
    RowBox[{
     RowBox[{"ClearAll", "[", 
      RowBox[{
      "cflags", ",", "dir", ",", "incdir", ",", "libdir", ",", "xlib", ",", 
       "src"}], "]"}], "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<lib=\>\"", ",", "lib"}], "]"}]}], ";"}], "\n", "*)"}], 
  "\n"}], "\n", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"LegendreRule", ",", "DunavantRule", ",", "ArcSinhRule"}], 
  "]"}], "\n", 
 RowBox[{
  RowBox[{"LegendreRule", "=", 
   RowBox[{"LibraryFunctionLoad", "[", 
    RowBox[{"lib", ",", "\"\<LegendreRule_MLL\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"Integer", ",", "Real", ",", "Real"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Real", ",", "2", ",", "\"\<Shared\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"DunavantRule", "=", 
   RowBox[{"LibraryFunctionLoad", "[", 
    RowBox[{"lib", ",", "\"\<DunavantRule_MLL\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"Integer", ",", 
       RowBox[{"{", 
        RowBox[{"Real", ",", "2", ",", "\"\<Constant\>\""}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"Real", ",", "2", ",", "\"\<Shared\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ArcSinhRule", "=", 
    RowBox[{"LibraryFunctionLoad", "[", 
     RowBox[{"lib", ",", "\"\<ArcSinhRule_MLL\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Real", ",", "2", ",", "\"\<Constant\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Real", ",", "1", ",", "\"\<Constant\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Real", ",", "2", ",", "\"\<Constant\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Real", ",", "2", ",", "\"\<Constant\>\""}], "}"}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"Real", ",", "2", ",", "\"\<Shared\>\""}], "}"}]}], "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "VHomoFull", ",", "BHomo", ",", "BHomoFull", ",", "BHomoS", ",", "BHomoN", 
   ",", "HomoMul"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"VHomoFull", "=", 
   RowBox[{"LibraryFunctionLoad", "[", 
    RowBox[{"lib", ",", "\"\<VHomoFull_MLL\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Real", ",", "3", ",", "\"\<Constant\>\""}], "}"}], ",", 
       "Real", ",", "Real", ",", "Real", ",", "Integer", ",", "Integer", ",", 
       "Integer", ",", "Integer", ",", "Integer"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Complex", ",", "1", ",", "\"\<Shared\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"BHomo", "=", 
   RowBox[{"LibraryFunctionLoad", "[", 
    RowBox[{"lib", ",", "\"\<BHomo_MLL\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Real", ",", "3", ",", "\"\<Constant\>\""}], "}"}], ",", 
       "Integer", ",", "Integer", ",", "Integer", ",", "Integer", ",", 
       "Integer"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Real", ",", "3", ",", "\"\<Shared\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"BHomoFull", "=", 
   RowBox[{"LibraryFunctionLoad", "[", 
    RowBox[{"lib", ",", "\"\<BHomoFull_MLL\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Real", ",", "3", ",", "\"\<Constant\>\""}], "}"}], ",", 
       "Integer", ",", "Integer", ",", "Integer", ",", "Integer", ",", 
       "Integer", ",", "Integer"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Real", ",", "3", ",", "\"\<Shared\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"BHomoS", "=", 
   RowBox[{"LibraryFunctionLoad", "[", 
    RowBox[{"lib", ",", "\"\<BHomoS_MLL\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"Integer", ",", "Integer", ",", 
       RowBox[{"{", 
        RowBox[{"Real", ",", "1", ",", "\"\<Constant\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Real", ",", "2", ",", "\"\<Constant\>\""}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"Real", ",", "1", ",", "\"\<Shared\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BHomoN", "=", 
   RowBox[{"LibraryFunctionLoad", "[", 
    RowBox[{"lib", ",", "\"\<BHomoN_MLL\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"Integer", ",", "Integer", ",", 
       RowBox[{"{", 
        RowBox[{"Real", ",", "1", ",", "\"\<Constant\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Real", ",", "2", ",", "\"\<Constant\>\""}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"Real", ",", "1", ",", "\"\<Shared\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HomoMul", "=", 
    RowBox[{"LibraryFunctionLoad", "[", 
     RowBox[{"lib", ",", "\"\<HomoMul_MLL\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Complex", ",", "1", ",", "\"\<Constant\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Real", ",", "1", ",", "\"\<Constant\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Real", ",", "3", ",", "\"\<Constant\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Real", ",", "1", ",", "\"\<Constant\>\""}], "}"}], ",", 
        "Real", ",", "Real"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Complex", ",", "1", ",", "\"\<Shared\>\""}], "}"}]}], "]"}]}],
    ";"}], "\n", "\n"}], "\n", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"InTriangle", ",", "PickTriangle"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InTriangle", "[", 
   RowBox[{"v_", ",", "ptn_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"det", ",", "v0", ",", "v1", ",", "v2", ",", "a", ",", "b"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"det", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "-", 
        
        RowBox[{
         RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         RowBox[{
         "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
       "&"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v0", "=", 
      RowBox[{"ptn", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{
       RowBox[{"ptn", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "-", "v0"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{
       RowBox[{"ptn", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
       "-", "v0"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"det", "[", 
          RowBox[{"v", ",", "v2"}], "]"}], "-", 
         RowBox[{"det", "[", 
          RowBox[{"v0", ",", "v2"}], "]"}]}], ")"}], "/", 
       RowBox[{"det", "[", 
        RowBox[{"v1", ",", "v2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"det", "[", 
           RowBox[{"v", ",", "v1"}], "]"}], "-", 
          RowBox[{"det", "[", 
           RowBox[{"v0", ",", "v1"}], "]"}]}], ")"}]}], "/", 
       RowBox[{"det", "[", 
        RowBox[{"v1", ",", "v2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", ">", "0.0"}], "&&", 
      RowBox[{"b", ">", "0.0"}], "&&", 
      RowBox[{
       RowBox[{"a", "+", "b"}], "<", "1.0"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"PickTriangle", "[", "v_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "n", "}"}], ",", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"n", "=", "1"}], ",", 
       RowBox[{"n", "\[LessEqual]", "Ns"}], ",", 
       RowBox[{"n", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"InTriangle", "[", 
          RowBox[{"v", ",", 
           RowBox[{
           "pt", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", 
         RowBox[{"Break", "[", "]"}]}], "]"}]}], "]"}], ";", "n"}]}], 
   "]"}]}], "\n", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"HalfLineTriangleSegmentC", ",", "P0", ",", "PT", ",", "alpha"}], 
  "]"}], "\n", 
 RowBox[{
  RowBox[{"HalfLineTriangleSegmentC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"alpha", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"pt", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", "\n", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "d", ",", "ds", ",", "pts", ",", "k", ",", "t"}], 
        "}"}], ",", "\n", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "alpha", "]"}], ",", 
           RowBox[{"Sin", "[", "alpha", "]"}]}], "}"}]}], ";", 
        RowBox[{"d", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Det", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "-", "p"}], ",", "n"}], "}"}], "]"}], "&"}], "/@", 
          "pt"}]}], ";", 
        RowBox[{"ds", "=", 
         RowBox[{"Sort", "[", "d", "]"}]}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "ds", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             RowBox[{
             "ds", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
            "\[LessEqual]", "0.0"}], "&&", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                "ds", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "]"}], "<", 
               RowBox[{"1.0", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "15"}]]}]}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                "ds", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                "]"}], "<", 
               RowBox[{"1.0", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "15"}]]}]}]}], ")"}]}]}], ",", 
          RowBox[{"0.0", ";"}], ",", 
          RowBox[{
           RowBox[{"Return", "[", "0.0", "]"}], ";"}]}], "]"}], ";", "\n", 
        RowBox[{"k", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", "\n", 
        RowBox[{
         RowBox[{"k", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"d", ",", 
            RowBox[{
            "ds", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{
         RowBox[{"k", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"d", ",", 
            RowBox[{
            "ds", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
           "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        RowBox[{
         RowBox[{"k", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{
          RowBox[{"Delete", "[", 
           RowBox[{
            RowBox[{"Range", "[", "3", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "k", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "k", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               "}"}]}], "}"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"pts", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"pt", "\[LeftDoubleBracket]", 
            RowBox[{
            "k", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "3", "]"}]}]}], ";", "\n", 
        RowBox[{"t", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "ds", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "*", 
             RowBox[{
             "ds", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "\[GreaterEqual]", "0"}], ",", "\n", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "pts", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{
                   "pts", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{"p", "-", 
                   RowBox[{
                   "pts", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], "]"}]}], "/", 
              RowBox[{"Det", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "pts", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{
                  "pts", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ",", "n"}], "}"}], "]"}]}], 
             ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "pts", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{
                   "pts", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{"p", "-", 
                   RowBox[{
                   "pts", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], "]"}]}], "/", 
              RowBox[{"Det", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "pts", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{
                  "pts", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], ",", "n"}], "}"}], "]"}]}]}], 
            "}"}], ",", "\n", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "pts", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{
                   "pts", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{"p", "-", 
                   RowBox[{
                   "pts", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], "]"}]}], "/", 
              RowBox[{"Det", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "pts", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{
                  "pts", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ",", "n"}], "}"}], "]"}]}], 
             ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "pts", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{
                   "pts", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{"p", "-", 
                   RowBox[{
                   "pts", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], "]"}]}], "/", 
              RowBox[{"Det", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "pts", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{
                  "pts", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ",", "n"}], "}"}], "]"}]}]}], 
            "}"}]}], "\n", "]"}]}], ";", "\n", 
        RowBox[{"t", "=", 
         RowBox[{"Sort", "[", "t", "]"}]}], ";", "\n", 
        RowBox[{
         RowBox[{"t", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
           "t", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           "0.0"}], "]"}]}], ";", "\n", 
        RowBox[{
         RowBox[{"t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
           "t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           "0.0"}], "]"}]}], ";", "\n", 
        RowBox[{
         RowBox[{"t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "-", 
         RowBox[{
         "t", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]}], 
      "\n", "]"}]}], "\n", 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"CompilationTarget", "\[RuleDelayed]", "\"\<C\>\""}]}], "*)"}], 
    "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"P0", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"-", 
        SqrtBox["3"]}], "/", "2"}]}], "}"}], "//", "N"}]}], ";", 
  RowBox[{"PT", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{
         SqrtBox["3"], "/", "2"}]}], "}"}]}], "}"}], "//", "N"}]}], ";", 
  RowBox[{"alpha", "=", 
   RowBox[{
    RowBox[{"\[Pi]", "/", "3"}], "//", "N"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"HalfLineTriangleSegmentC", "[", 
     RowBox[{"alpha", ",", "P0", ",", "PT"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"alpha", ",", "0", ",", 
      RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
    RowBox[{"AxesOrigin", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{"ClearAll", "[", "Draw2Trig", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Draw2Trig", "[", 
    RowBox[{"n_", ",", "np_"}], "]"}], ":=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"pt", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"PointSize", "[", "Large", "]"}]}], "}"}]}], ",", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"pt", "\[LeftDoubleBracket]", 
              RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"pt", "\[LeftDoubleBracket]", 
              RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"pt", "\[LeftDoubleBracket]", 
              RowBox[{"n", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"pt", "\[LeftDoubleBracket]", 
              RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}], 
           "]"}], ",", "Red", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"pt", "\[LeftDoubleBracket]", 
              RowBox[{"np", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"pt", "\[LeftDoubleBracket]", 
              RowBox[{"np", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"pt", "\[LeftDoubleBracket]", 
              RowBox[{"np", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"pt", "\[LeftDoubleBracket]", 
              RowBox[{"np", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}], 
           "]"}]}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"pt", "\[LeftDoubleBracket]", "np", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"PointSize", "[", "Large", "]"}]}], "}"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\n"}], "\n", 
 RowBox[{"ClearAll", "[", "PlotFluenceX0", "]"}], "\n", 
 RowBox[{
  RowBox[{"PlotFluenceX0", "[", 
   RowBox[{"X_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data", ",", "coord", ",", "index", ",", "pltdata"}], "}"}], ",",
     "\n", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"X", ",", 
          RowBox[{
           RowBox[{"2", "Nd"}], "+", "1"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"Nd", "+", "1"}]}], "]"}], "]"}], "//", "Re"}]}], ";", "\n", 
     RowBox[{"coord", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0.01", ",", "0.99", ",", 
           RowBox[{"0.9", "/", 
            RowBox[{"Sqrt", "[", "Ns", "]"}]}]}], "}"}]}], "]"}], "//", 
       "ToPackedArray"}]}], ";", "\n", 
     RowBox[{"index", "=", 
      RowBox[{
       RowBox[{"PickTriangle", "/@", "coord"}], "//", "ToPackedArray"}]}], 
     ";", "\n", 
     RowBox[{"pltdata", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"coord", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"data", "[", 
          RowBox[{"[", "index", "]"}], "]"}]}], "}"}], "//", "Transpose"}]}], 
     ";", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"PackedArrayQ", "/@", 
         RowBox[{"{", 
          RowBox[{"data", ",", "coord", ",", "index", ",", "pltdata"}], 
          "}"}]}], "//", "Print"}], ";"}], "*)"}], "\n", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"pltdata", ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"2", "\[Pi]"}], ")"}]}], "+", "0.01"}]}], "}"}]}], ",", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<x\>\"", ",", "\"\<fluence\>\""}], "}"}]}]}], "]"}]}]}], 
   "\n", "]"}]}], "\n", 
 RowBox[{"ClearAll", "[", "PlotFluenceX1", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotFluenceX1", "[", 
    RowBox[{"X_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "data", ",", "coord", ",", "base", ",", "index", ",", "pltdata"}], 
      "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"X", ",", 
           RowBox[{
            RowBox[{"2", "Nd"}], "+", "1"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"Nd", "+", "1"}]}], "]"}], "]"}], "//", "Re"}]}], ";", 
      "\n", 
      RowBox[{"coord", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0.01", ",", "0.99", ",", 
            RowBox[{"0.9", "/", 
             RowBox[{"Sqrt", "[", "Ns", "]"}]}]}], "}"}]}], "]"}], "//", 
        "ToPackedArray"}]}], ";", "\n", 
      RowBox[{"base", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"2", "\[Pi]"}], ")"}]}], 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[Mu]t"}], 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
         "coord"}], "//", "ToPackedArray"}]}], ";", "\n", 
      RowBox[{"index", "=", 
       RowBox[{
        RowBox[{"PickTriangle", "/@", "coord"}], "//", "ToPackedArray"}]}], 
      ";", "\n", 
      RowBox[{"pltdata", "=", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", "index", "]"}], "]"}], "+", "base"}]}], ";", "\n", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"coord", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "pltdata"}], 
            "}"}], "//", "Transpose"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"2", "\[Pi]"}], ")"}]}], "+", "0.01"}]}], "}"}]}], 
          ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<fluence\>\""}], "}"}]}]}], "]"}], 
        ",", "\n", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[Mu]t"}], " ", "x"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "\[Pi]"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"PlotStyle", "->", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Red", ",", "Dashed"}], "}"}]}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"2", "\[Pi]"}], ")"}]}], "+", "0.01"}]}], "}"}]}]}], 
         "]"}]}], "]"}]}]}], "\n", "]"}]}], "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Developer`\>\"", "]"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "filename", ",", "\[Mu]a", ",", "\[Mu]s", ",", "\[Mu]t", ",", "g", ",", 
    "phis", ",", "Nd", ",", "padding"}], "]"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"filename", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<../msh\>\"", ",", 
        "\"\<t4.msh\>\""}], "}"}], "]"}]}], ";"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<../msh\>\"", ",", 
      "\"\<square162.msh\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DumpMSHFileTo2DATFiles", "[", "filename", "]"}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Mu]a", ",", "\[Mu]s"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Log", "[", "3.0", "]"}], ",", 
     RowBox[{"2", 
      RowBox[{"Log", "[", "2.0", "]"}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Mu]t", "=", 
   RowBox[{"\[Mu]a", "+", "\[Mu]s"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"g", "=", "0.6"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"phis", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nd", "=", "10"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"padding", "=", "1"}], ";"}], "\n"}], "\n", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"iG", ",", "iL", ",", "ToCmplxPckdArry"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"iG", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n_", ",", "m_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Ns_", ",", "Nd_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "Nd"}], "+", "1"}], ")"}]}], "+", "m", "+", "Nd", "+", 
   "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iL", "[", 
   RowBox[{"ng_", ",", 
    RowBox[{"{", 
     RowBox[{"Ns_", ",", "Nd_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"IntegerPart", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ng", "-", "1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "Nd"}], "+", "1"}], ")"}]}], "+", "1"}], "]"}], ",", 
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"ng", "-", "Nd", "-", "1"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "Nd"}], "+", "1"}], ")"}], ",", 
      RowBox[{"-", "Nd"}]}], "]"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ToCmplxPckdArry", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ToPackedArray", "[", 
       RowBox[{"N", "[", 
        RowBox[{"Re", "[", "#", "]"}], "]"}], "]"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"ToPackedArray", "[", 
        RowBox[{"N", "[", 
         RowBox[{"Im", "[", "#", "]"}], "]"}], "]"}]}]}], "&"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "TriPtPreCalc", ",", "CntrPreCalc", ",", "r2rRPreCalc", ",", 
   "SignedAreaPreCalc"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"TriPtPreCalc", "[", 
   RowBox[{"p_", ",", "t_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
     "&"}], "/@", "t"}], "//", "ToPackedArray"}]}], "\n", 
 RowBox[{
  RowBox[{"CntrPreCalc", "[", "pt_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Total", "/@", "pt"}], ")"}], "/", "3.0"}], "//", 
   "ToPackedArray"}]}], "\n", 
 RowBox[{
  RowBox[{"r2rRPreCalc", "[", "cntr_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Outer", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#1", "<", "#2"}], ",", 
         RowBox[{"Norm", "[", 
          RowBox[{"Subtract", "@@", 
           RowBox[{"cntr", "\[LeftDoubleBracket]", 
            RowBox[{"{", 
             RowBox[{"#1", ",", "#2"}], "}"}], "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "0.0"}], "]"}], "&"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "cntr", "]"}], "]"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "cntr", "]"}], "]"}]}], "]"}], "//", 
    "ToPackedArray"}], "//", 
   RowBox[{
    RowBox[{"#", "+", 
     RowBox[{"#", "\[Transpose]"}]}], "&"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SignedAreaPreCalc", "[", "pt_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pt", "//", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "-", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
              ",", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "-", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", 
                "\[RightDoubleBracket]"}]}]}], "}"}], "&"}], ",", "#"}], 
          "]"}], "&"}]}], "//", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "-", 
            RowBox[{
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "&"}], 
          ",", "#"}], "]"}], "&"}]}], "//", "ToPackedArray"}], "//", 
     RowBox[{
      RowBox[{"Times", "[", 
       RowBox[{"#", ",", "0.5"}], "]"}], "&"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "Np", ",", "p", ",", "t", ",", "Nm", ",", "Ns", ",", "Ng", ",", "gTbl", ",",
    "iGTbl", ",", "iLTbl", ",", "pt", ",", "cntr", ",", "r2rR", ",", "area", 
   ",", "Tpt", ",", "Tcntr", ",", "Tr2rR", ",", "Tarea"}], "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "t"}], "}"}], "=", 
    RowBox[{"ReadMSHFileFrom2DATFiles", "[", "filename", "]"}]}], ";"}], "\n",
   "\n", 
  RowBox[{"(*", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"symmetrize", " ", "the", " ", "geometry", " ", 
      RowBox[{"w", ".", "r", ".", "p", ".", "t", ".", " ", "y"}]}], "=", 
     "0"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Np", "=", 
     RowBox[{"Length", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"t", "=", 
     RowBox[{"t", "//", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "+", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"Np", ",", "3"}], "]"}]}], "&"}], ",", "t"}], "]"}]}], 
        "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"p", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
          "}"}], "&"}], "/@", "p"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Np", "=", 
     RowBox[{"Length", "[", "p", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"end", " ", "of", " ", "symmetrization"}], "*)"}], "\n", "*)"}], 
  "\n", "\n", 
  RowBox[{"(*", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"symmetrize", " ", "the", " ", "geometry", " ", 
      RowBox[{"w", ".", "r", ".", "p", ".", "t", ".", " ", "x"}]}], "=", 
     "0"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Np", "=", 
     RowBox[{"Length", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"t", "=", 
     RowBox[{"t", "//", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "+", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"Np", ",", "3"}], "]"}]}], "&"}], ",", "t"}], "]"}]}], 
        "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"p", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "}"}], "&"}], "/@", "p"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Np", "=", 
     RowBox[{"Length", "[", "p", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"end", " ", "of", " ", "symmetrization"}], "*)"}], "\n", "*)"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"Np", "=", 
   RowBox[{"Length", "[", "p", "]"}]}], ";", 
  RowBox[{"Ns", "=", 
   RowBox[{"Length", "[", "t", "]"}]}], ";", 
  RowBox[{"Nm", "=", 
   RowBox[{
    RowBox[{"2", "Nd"}], "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{"Nm", ",", "padding"}], "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[NotEqual]", "0"}], ",", 
       RowBox[{
        RowBox[{"Nm", "=", 
         RowBox[{"Nm", "+", "padding", "-", "n"}]}], ";", 
        RowBox[{"Nd", "=", 
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Nm", "-", "1"}], ")"}], "/", "2"}], "]"}]}], ";"}]}], 
      "]"}], ";"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Ng", "=", 
   RowBox[{"Ns", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "Nd"}], "+", "1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<{p,t}=\>\"", ",", 
    RowBox[{"PackedArrayQ", "/@", 
     RowBox[{"{", 
      RowBox[{"p", ",", "t"}], "}"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<{Ns,Nd,Nm,Ng}=\>\"", ",", 
    RowBox[{"{", 
     RowBox[{"Ns", ",", "Nd", ",", "Nm", ",", "Ng"}], "}"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"gTbl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"g", "^", 
       RowBox[{"Abs", "[", "#", "]"}]}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"-", "Nd"}], ",", "Nd"}], "]"}]}], "//", "ToPackedArray"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"iGTbl", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"iG", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", "m"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ns", ",", "Nd"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "Ns"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"-", "Nd"}], ",", "Nd"}], "}"}]}], "]"}], "//", 
    "ToPackedArray"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iLTbl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"iL", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"Ns", ",", "Nd"}], "}"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", "Ng", "]"}]}], "//", "ToPackedArray"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<{gTbl,iGTbl,iLTbl}=\>\"", ",", 
    RowBox[{"PackedArrayQ", "/@", 
     RowBox[{"{", 
      RowBox[{"gTbl", ",", "iGTbl", ",", "iLTbl"}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tpt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"pt", "=", 
        RowBox[{"TriPtPreCalc", "[", 
         RowBox[{"p", ",", "t"}], "]"}]}], ";"}], ")"}], "//", 
     "AbsoluteTiming"}], "//", 
    RowBox[{
     RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tcntr", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"cntr", "=", 
        RowBox[{"CntrPreCalc", "[", "pt", "]"}]}], ";"}], ")"}], "//", 
     "AbsoluteTiming"}], "//", 
    RowBox[{
     RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tr2rR", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r2rR", "=", 
        RowBox[{"r2rRPreCalc", "[", "cntr", "]"}]}], ";"}], ")"}], "//", 
     "AbsoluteTiming"}], "//", 
    RowBox[{
     RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "&"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Tarea", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"area", "=", 
        RowBox[{"SignedAreaPreCalc", "[", "pt", "]"}]}], ";"}], ")"}], "//", 
     "AbsoluteTiming"}], "//", 
    RowBox[{
     RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<{Tpt,Tcntr,Tr2rR,TsignedArea,Tarea,TRc}=\>\"", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Tpt", ",", "Tcntr", ",", "Tr2rR", ",", "Tarea"}], "}"}], "//", 
     
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Total", "[", "#", "]"}], ",", "#"}], "}"}], "&"}]}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<{pt,cntr,r2rR,signedArea,area,Rc}=\>\"", ",", 
    RowBox[{"PackedArrayQ", "/@", 
     RowBox[{"{", 
      RowBox[{"pt", ",", "cntr", ",", "r2rR", ",", "area"}], "}"}]}]}], "]"}],
   ";"}], "\n", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"A", ",", "B"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "=", 
    RowBox[{"2", "\[Pi]", "*", "area"}]}], ";"}], "\n", 
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<HOME\>\"", "/.", 
         RowBox[{"GetEnvironment", "[", "\"\<HOME\>\"", "]"}]}], ",", 
        "\"\<tmp\>\""}], "}"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"<<", "\"\<B.mx\>\""}], ";", "\[IndentingNewLine]", 
    RowBox[{"ResetDirectory", "[", "]"}], ";"}], "\n", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"RULE1", ",", "RULE2", ",", "NU", ",", "NV"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"RULE1", ",", "RULE2", ",", "NU", ",", "NV"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"5", ",", "20", ",", 
      RowBox[{
       RowBox[{"2", "Nd"}], "+", "15"}], ",", "3"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"BHomo", "[", 
      RowBox[{"pt", ",", "Nd", ",", "Nm", ",", "RULE", ",", "NU", ",", "NV"}],
       "]"}], "//", "Quiet"}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BHomoFull", "[", 
      RowBox[{
      "pt", ",", "Nd", ",", "Nm", ",", "RULE1", ",", "RULE2", ",", "NU", ",", 
       "NV"}], "]"}], "//", "Quiet"}], "//", "ToPackedArray"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<HOME\>\"", "/.", 
       RowBox[{"GetEnvironment", "[", "\"\<HOME\>\"", "]"}]}], ",", 
      "\"\<tmp\>\""}], "}"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{"\"\<B.mx\>\"", ",", "B"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResetDirectory", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"RULE1", ",", "RULE2", ",", "NU", ",", "NV"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "n", ",", "np", ",", "rc", ",", "q0", ",", "q1", ",", "rule", ",", "Nu", 
   ",", "Nv", ",", "qu", ",", "qv"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<{A,B}=\>\"", ",", 
    RowBox[{"PackedArrayQ", "/@", 
     RowBox[{"{", 
      RowBox[{"A", ",", "B"}], "}"}]}]}], "]"}], ";"}]}], "Code",
 CellChangeTimes->{{3.5832314072112837`*^9, 3.583231410988764*^9}, {
   3.58323154973929*^9, 3.5832315711990194`*^9}, 3.5832340812738132`*^9, {
   3.5832341244523025`*^9, 3.583234126420551*^9}, {3.5832347795149984`*^9, 
   3.5832347857037506`*^9}, {3.583235678369472*^9, 3.583235713551936*^9}, {
   3.583236886323658*^9, 3.583236907364332*^9}, {3.5832369407465734`*^9, 
   3.5832369662514257`*^9}, {3.583237056301586*^9, 3.583237250480199*^9}, {
   3.583237435802699*^9, 3.583237509742097*^9}, {3.583237547384881*^9, 
   3.5832376102318735`*^9}, {3.583238556769198*^9, 3.5832385796996784`*^9}, {
   3.583249040780386*^9, 3.5832490566664023`*^9}, {3.583249624846754*^9, 
   3.5832496452083435`*^9}, {3.58324975210089*^9, 3.5832497599448895`*^9}, {
   3.583250394059413*^9, 3.583250407973187*^9}, 3.583250913833332*^9, {
   3.583278644416027*^9, 3.5832786489712477`*^9}, {3.5832791246692266`*^9, 
   3.5832791588958397`*^9}, {3.5832792220453434`*^9, 
   3.5832792550552955`*^9}, {3.583279298751335*^9, 3.5832793035561895`*^9}, {
   3.583279337081085*^9, 3.5832793461759825`*^9}, 3.5832794223826647`*^9, 
   3.5832795431904125`*^9, {3.583279637774208*^9, 3.5832796715017567`*^9}, {
   3.5832797937774553`*^9, 3.5832797938865314`*^9}, 3.5833139663004465`*^9, 
   3.583315381451195*^9, {3.583315586657086*^9, 3.583315586719489*^9}, 
   3.583316654057167*^9, 3.5833178540262127`*^9, {3.583520226851201*^9, 
   3.583520253130539*^9}, {3.583520619225793*^9, 3.583520620596919*^9}, {
   3.5835827242941933`*^9, 3.583582724856262*^9}, {3.583594263315054*^9, 
   3.5835943811569653`*^9}, {3.5835950720180473`*^9, 3.583595085993845*^9}, {
   3.583595754693125*^9, 3.583595761682022*^9}, {3.5835958617102165`*^9, 
   3.5835958653606596`*^9}, {3.583596220331219*^9, 3.5835962212984247`*^9}, {
   3.5835965168150053`*^9, 3.583596520993891*^9}, {3.5835974586815157`*^9, 
   3.5835974587285385`*^9}, {3.5835977035927134`*^9, 
   3.5835977085691185`*^9}, {3.5835982529128222`*^9, 3.583598253068824*^9}, {
   3.583598520378256*^9, 3.5835985263376226`*^9}, {3.5835987249901967`*^9, 
   3.583598740949011*^9}, {3.5835987891849327`*^9, 3.583598795783643*^9}, {
   3.583598927168252*^9, 3.583598928759626*^9}, {3.583604248308853*^9, 
   3.5836042485118766`*^9}, {3.5837057707458773`*^9, 3.583705809974505*^9}, {
   3.5837058647931747`*^9, 3.5837058659576406`*^9}, {3.583705923638197*^9, 
   3.583705929523687*^9}, {3.5837081085500927`*^9, 3.583708121196658*^9}, {
   3.583708281517411*^9, 3.583708295382011*^9}, {3.583753502635223*^9, 
   3.583753538147101*^9}, {3.583753978051922*^9, 3.583753979097967*^9}, {
   3.583762326006537*^9, 3.583762334759839*^9}, {3.583852713203553*^9, 
   3.5838527500631113`*^9}, {3.583852849628519*^9, 3.583852877028597*^9}, {
   3.5838529363020353`*^9, 3.5838529364519053`*^9}, 3.5838537543123207`*^9, {
   3.583854551278051*^9, 3.583854553931589*^9}, 3.583854590999557*^9, {
   3.5838560698876047`*^9, 3.5838560747178*^9}, {3.583857268327314*^9, 
   3.583857274746943*^9}, {3.583882314118259*^9, 3.583882317028575*^9}, {
   3.583882765441311*^9, 3.5838827664086227`*^9}, 3.583882806880651*^9, {
   3.58397213193909*^9, 3.5839721392809896`*^9}, {3.583972681764387*^9, 
   3.583972688084626*^9}, 3.5840565212715273`*^9, {3.584056637085861*^9, 
   3.5840566424512997`*^9}, {3.584057493710822*^9, 3.584057510976591*^9}, {
   3.584093802933436*^9, 3.584093804077717*^9}, {3.584093946930346*^9, 
   3.5840939679796467`*^9}, {3.584100245806541*^9, 3.5841002771329203`*^9}, {
   3.5841011795529346`*^9, 3.584101181057598*^9}, {3.584101218916643*^9, 
   3.5841012216047773`*^9}, {3.584101343500826*^9, 3.5841013508197002`*^9}, {
   3.584101601719351*^9, 3.584101605485053*^9}, {3.584102543822041*^9, 
   3.5841025699620657`*^9}, {3.5841026753462677`*^9, 3.584102675545371*^9}, {
   3.584102758834619*^9, 3.584102762046706*^9}, {3.584103309633869*^9, 
   3.58410330979025*^9}, {3.5841049996556253`*^9, 3.584105005664445*^9}, {
   3.5841060330548697`*^9, 3.584106034081315*^9}, {3.5841065289559193`*^9, 
   3.584106533016822*^9}, {3.5841066158749743`*^9, 3.5841066190013638`*^9}, {
   3.58410775112497*^9, 3.584107760749167*^9}, {3.584109351360709*^9, 
   3.584109366851808*^9}, {3.584109397590267*^9, 3.5841094031069098`*^9}, {
   3.584109460735282*^9, 3.584109467550446*^9}, {3.584109714578034*^9, 
   3.584109719721878*^9}, {3.584109898755789*^9, 3.584109904112873*^9}, {
   3.5841099903284073`*^9, 3.584109991248518*^9}, {3.5841113532058477`*^9, 
   3.5841113718542767`*^9}, {3.584116561297707*^9, 3.584116566526635*^9}, {
   3.5841166289900723`*^9, 3.584116635708377*^9}, {3.584116708320763*^9, 
   3.5841167099364433`*^9}, {3.5841167427709837`*^9, 3.584116744972249*^9}, {
   3.584116775712604*^9, 3.5841167766551027`*^9}, {3.584116901259707*^9, 
   3.584116901769099*^9}, {3.584117033750503*^9, 3.58411703672456*^9}, 
   3.584117208791696*^9, {3.5841172474261637`*^9, 3.584117249890498*^9}, {
   3.584117305759334*^9, 3.584117307886177*^9}, {3.584117562382041*^9, 
   3.584117562867426*^9}, {3.584117648035438*^9, 3.584117649936048*^9}, {
   3.584117783862821*^9, 3.584117785235839*^9}, {3.584117969402565*^9, 
   3.584117971823327*^9}, {3.584118352280308*^9, 3.584118353733083*^9}, {
   3.584118697627366*^9, 3.584118698085375*^9}, {3.584118752957251*^9, 
   3.584118753815971*^9}, {3.584119905693214*^9, 3.5841199060525303`*^9}, {
   3.5841239981488333`*^9, 3.584124020907257*^9}, {3.584125393286289*^9, 
   3.584125434259445*^9}, {3.58412551909102*^9, 3.5841255249164257`*^9}, {
   3.584125573891191*^9, 3.584125574293983*^9}, 3.584205558651864*^9, {
   3.584269653037593*^9, 3.584269747443141*^9}, {3.584269924597587*^9, 
   3.584269924696177*^9}, {3.584276038290503*^9, 3.5842760396494427`*^9}, {
   3.584284769115233*^9, 3.5842848443112164`*^9}, 3.58428498396157*^9, 
   3.584285017946795*^9, {3.584286668070664*^9, 3.584286668324972*^9}, {
   3.5842868973577538`*^9, 3.584286897542233*^9}, {3.58428812134195*^9, 
   3.584288147143755*^9}, {3.584288304866745*^9, 3.58428832716191*^9}, {
   3.5844486688857193`*^9, 3.5844487154174137`*^9}, {3.584448838762253*^9, 
   3.584448839516128*^9}, {3.584661846899613*^9, 3.584661847309595*^9}, {
   3.5846620335247993`*^9, 3.584662043512877*^9}, {3.5848060702810583`*^9, 
   3.584806089493761*^9}, {3.584806766340901*^9, 3.584806770890993*^9}, {
   3.584887433006837*^9, 3.58488743336614*^9}, {3.584891800513522*^9, 
   3.584891819389023*^9}, 3.584892208007536*^9, {3.5851341565776463`*^9, 
   3.585134181885275*^9}, {3.585134235538843*^9, 3.585134236060835*^9}, {
   3.5852372311610727`*^9, 3.585237239642768*^9}, {3.5852379008280907`*^9, 
   3.585237904071282*^9}, {3.585251536830648*^9, 3.5852515479205227`*^9}, {
   3.585310893781364*^9, 3.58531089515585*^9}, {3.5853109940890913`*^9, 
   3.5853109945588408`*^9}, {3.5853110271176453`*^9, 3.58531102787365*^9}, {
   3.585311084199689*^9, 3.58531113089914*^9}, {3.5853119818211727`*^9, 
   3.58531206173103*^9}, {3.585312901306547*^9, 3.585312909066924*^9}, {
   3.5853129995689898`*^9, 3.585313087067675*^9}, {3.585313169041212*^9, 
   3.585313187593348*^9}, {3.5853133167124367`*^9, 3.585313346266529*^9}, {
   3.58531362684833*^9, 3.585313639797749*^9}, 3.5853146736587687`*^9, {
   3.585318777799823*^9, 3.585318778597548*^9}, {3.585319029982422*^9, 
   3.585319047002562*^9}, {3.5853473083367853`*^9, 3.585347309176016*^9}, {
   3.585347363551502*^9, 3.58534736575099*^9}, {3.585347452627171*^9, 
   3.585347452762898*^9}, {3.585354380375525*^9, 3.5853543847006598`*^9}, {
   3.58556490875089*^9, 3.585564920072631*^9}, {3.585564964806664*^9, 
   3.585564968961257*^9}, {3.585565027504154*^9, 3.5855650385188217`*^9}, {
   3.5855656642533712`*^9, 3.585565680562438*^9}, {3.585567401864567*^9, 
   3.5855674225584707`*^9}, {3.585585304198057*^9, 3.5855853215909433`*^9}, {
   3.585585585607018*^9, 3.585585606118992*^9}, {3.5855856425898743`*^9, 
   3.585585642832698*^9}, {3.5855858294831753`*^9, 3.5855858297141743`*^9}, {
   3.585586197201103*^9, 3.5855861973160667`*^9}, {3.585586306352434*^9, 
   3.5855863068802557`*^9}, {3.585586351935874*^9, 3.585586352246883*^9}, {
   3.585586861212987*^9, 3.585586865300055*^9}, {3.585586988040905*^9, 
   3.585586991847643*^9}, {3.585587499787125*^9, 3.585587506054982*^9}, {
   3.585587585932705*^9, 3.585587591792345*^9}, 3.5855877046494703`*^9, {
   3.5855922273950243`*^9, 3.585592227650222*^9}, {3.58561082438691*^9, 
   3.585610828616761*^9}, {3.5856111566492987`*^9, 3.585611156948185*^9}, {
   3.5856112094124517`*^9, 3.585611210034096*^9}, {3.5856121424029284`*^9, 
   3.585612142547574*^9}, {3.585612215485703*^9, 3.585612215632259*^9}, {
   3.5856166644883547`*^9, 3.5856166897595987`*^9}, {3.585616721408259*^9, 
   3.5856167356538363`*^9}, {3.585617603919504*^9, 3.585617653302911*^9}, {
   3.5856177237950068`*^9, 3.5856177243655767`*^9}, {3.585617975310217*^9, 
   3.5856180119211903`*^9}, {3.585618494955637*^9, 3.585618528592437*^9}, {
   3.585618593496059*^9, 3.5856185939195957`*^9}, {3.585619245031193*^9, 
   3.58561925810221*^9}, {3.58562057218316*^9, 3.585620580116696*^9}, {
   3.585620873321986*^9, 3.585620874231022*^9}, {3.585621011941361*^9, 
   3.58562101252444*^9}, {3.585621097331201*^9, 3.585621128117597*^9}, {
   3.585621389929229*^9, 3.58562139288577*^9}, {3.5856217095996647`*^9, 
   3.585621712913986*^9}, {3.585622079569388*^9, 3.585622086896751*^9}, {
   3.585653364574955*^9, 3.585653400397188*^9}, 3.585653519131411*^9, {
   3.5856539012861137`*^9, 3.5856539022808533`*^9}, {3.585654621856339*^9, 
   3.585654641774622*^9}, {3.585654838394051*^9, 3.5856548405835857`*^9}, 
   3.58565523667232*^9, {3.585655349458521*^9, 3.585655371714329*^9}, {
   3.585655441523971*^9, 3.585655441783534*^9}, {3.585655530668221*^9, 
   3.58565555882299*^9}, {3.585655612754331*^9, 3.5856556208181763`*^9}, {
   3.585656399063827*^9, 3.585656401982272*^9}, {3.5856566527907133`*^9, 
   3.58565665326237*^9}, {3.585657867150669*^9, 3.585657867275197*^9}, {
   3.585657972596665*^9, 3.585657975363266*^9}, {3.585658044507557*^9, 
   3.5856580449700003`*^9}, {3.58565862887886*^9, 3.585658629495151*^9}, {
   3.5856609746620817`*^9, 3.5856609751724443`*^9}, {3.585661117989048*^9, 
   3.585661124488646*^9}, {3.5856657438394747`*^9, 3.58566575454749*^9}, {
   3.585665810193323*^9, 3.585665814890565*^9}, {3.58566587651718*^9, 
   3.585665883267405*^9}, {3.585666730957909*^9, 3.5856667311578197`*^9}, {
   3.5856669830506573`*^9, 3.585666993882155*^9}, {3.5856670487598953`*^9, 
   3.585667053379611*^9}, {3.585667138966072*^9, 3.585667148334443*^9}, {
   3.5856675268721743`*^9, 3.585667527559721*^9}, {3.585667562940229*^9, 
   3.585667565264351*^9}, {3.5856676175244427`*^9, 3.5856676202335863`*^9}, {
   3.585667810341323*^9, 3.5856678354598427`*^9}, {3.585671113484079*^9, 
   3.585671113843617*^9}, {3.585905457147614*^9, 3.585905499775901*^9}, {
   3.585905614535688*^9, 3.5859056189514723`*^9}, {3.585906080291451*^9, 
   3.5859061298899803`*^9}, 3.585906161818863*^9, {3.585906206814258*^9, 
   3.58590620751788*^9}, {3.585906318481633*^9, 3.585906318771999*^9}, {
   3.5859065235754337`*^9, 3.585906523750793*^9}, 3.58590700013951*^9, {
   3.5859070833087673`*^9, 3.58590708341927*^9}, 3.58590722724096*^9, {
   3.58590735251744*^9, 3.5859073544202833`*^9}, {3.5859089940595217`*^9, 
   3.585908994175251*^9}, {3.585910636465623*^9, 3.585910674787486*^9}, {
   3.5859108564224443`*^9, 3.585910862341241*^9}, {3.5859110650792093`*^9, 
   3.585911066037571*^9}, {3.585912048881832*^9, 3.5859120550170794`*^9}, {
   3.585912273635405*^9, 3.585912274273356*^9}, {3.585912671226837*^9, 
   3.585912671786277*^9}, {3.585913673536766*^9, 3.585913682774732*^9}, {
   3.585914121099399*^9, 3.585914121576208*^9}, {3.5859143955634413`*^9, 
   3.585914419216905*^9}, {3.585914594318667*^9, 3.585914597814332*^9}, {
   3.585914746948645*^9, 3.585914750248067*^9}, {3.5859149632019863`*^9, 
   3.585914963791971*^9}, {3.585915220062561*^9, 3.585915225253337*^9}, {
   3.5859156267645187`*^9, 3.5859156317853107`*^9}, {3.585915828316368*^9, 
   3.585915828419462*^9}, {3.585917289395454*^9, 3.5859172915360537`*^9}, {
   3.585917331618895*^9, 3.5859173519013023`*^9}, {3.5859197394615707`*^9, 
   3.58591973964779*^9}, {3.585919824876342*^9, 3.5859198252222757`*^9}, {
   3.585919964780443*^9, 3.585919965065943*^9}, {3.58592124637151*^9, 
   3.5859212468239927`*^9}, {3.585921677848608*^9, 3.5859217373518353`*^9}, {
   3.585924718698011*^9, 3.5859247363969173`*^9}, {3.5859271988714323`*^9, 
   3.585927215090831*^9}, {3.5859283748207817`*^9, 3.585928389151348*^9}, {
   3.585928581559876*^9, 3.585928581704129*^9}, {3.58592873418642*^9, 
   3.585928737485828*^9}, {3.5859288909351482`*^9, 3.58592889106883*^9}, {
   3.585928926940256*^9, 3.5859289294460707`*^9}, {3.585929073409643*^9, 
   3.585929073937574*^9}, {3.585929132520479*^9, 3.585929132821694*^9}, {
   3.5859292400142603`*^9, 3.5859292423568287`*^9}, {3.585929309300296*^9, 
   3.5859293118130074`*^9}, {3.5859314356647577`*^9, 3.585931446033888*^9}, {
   3.5859321601007767`*^9, 3.585932160528606*^9}, {3.585951204728244*^9, 
   3.585951218160686*^9}, {3.585951253159937*^9, 3.585951275416308*^9}, {
   3.5859521538651237`*^9, 3.585952172003193*^9}, {3.58595404569669*^9, 
   3.585954066036934*^9}, {3.585954559179288*^9, 3.585954559771141*^9}, {
   3.5859553065618877`*^9, 3.585955306682909*^9}, {3.5859556113886623`*^9, 
   3.5859556115070887`*^9}, {3.585955969378227*^9, 3.585955972558989*^9}, {
   3.585992004832542*^9, 3.585992004949377*^9}, {3.5859924033842897`*^9, 
   3.58599240549389*^9}, {3.586000039139439*^9, 3.5860000930126743`*^9}, {
   3.586000129207157*^9, 3.586000134700856*^9}, {3.586000284530305*^9, 
   3.586000306458371*^9}, {3.586002335613599*^9, 3.5860023522207003`*^9}, {
   3.58600352205492*^9, 3.5860035362829533`*^9}, {3.586003965494925*^9, 
   3.586003968822584*^9}, {3.586004236026589*^9, 3.586004245111536*^9}, {
   3.5860043497971077`*^9, 3.586004353399646*^9}, {3.586004674184585*^9, 
   3.586004675602087*^9}, {3.586004874082465*^9, 3.586004875375914*^9}, {
   3.586008757635071*^9, 3.586008785198996*^9}, {3.586008860888886*^9, 
   3.58600886100915*^9}, {3.586009087078415*^9, 3.586009091627569*^9}, {
   3.586009173738904*^9, 3.58600917839533*^9}, {3.586009407238391*^9, 
   3.586009421621805*^9}, {3.586009472387608*^9, 3.586009472785973*^9}, {
   3.5860097336776257`*^9, 3.586009746140414*^9}, {3.586010306775868*^9, 
   3.5860103085421047`*^9}, {3.586010443058907*^9, 3.586010450677567*^9}, {
   3.586010591484399*^9, 3.58601059222602*^9}, {3.586017207389621*^9, 
   3.58601722548477*^9}, {3.586030847312771*^9, 3.586030851868537*^9}, {
   3.5860446815979013`*^9, 3.586044692845083*^9}, {3.586045394395627*^9, 
   3.586045394524132*^9}, {3.5860455542199717`*^9, 3.586045554321032*^9}, {
   3.586045722707262*^9, 3.586045736386677*^9}, {3.586046030173212*^9, 
   3.586046033844818*^9}, {3.5860463032478867`*^9, 3.586046311420875*^9}, {
   3.586175787504369*^9, 3.5861757963259077`*^9}, {3.586176013045237*^9, 
   3.586176020081842*^9}, {3.5861971335804358`*^9, 3.586197134083375*^9}, {
   3.58626037401723*^9, 3.5862604641409397`*^9}, {3.586260515576954*^9, 
   3.586260518191428*^9}, {3.5862606944762897`*^9, 3.586261098267708*^9}, {
   3.586261132093011*^9, 3.5862611332359333`*^9}, 3.586261260774823*^9, {
   3.586261398303369*^9, 3.586261425381465*^9}, {3.586263568053598*^9, 
   3.5862636435992527`*^9}, {3.586264130303351*^9, 3.586264131504971*^9}, {
   3.586272228169983*^9, 3.5862722300327997`*^9}, {3.58627382766778*^9, 
   3.586273845450675*^9}, {3.586274188222036*^9, 3.5862741941809063`*^9}, {
   3.586274704452845*^9, 3.586274704540745*^9}, {3.586275096673512*^9, 
   3.586275097301385*^9}, {3.586275387075507*^9, 3.58627538789277*^9}, {
   3.5862756461437073`*^9, 3.586275646608527*^9}, {3.586275881685399*^9, 
   3.586275895526825*^9}, {3.586275989942478*^9, 3.586275990209215*^9}, {
   3.5862761598123617`*^9, 3.5862761728028307`*^9}, {3.5862766974513597`*^9, 
   3.5862767050156517`*^9}, {3.5862769685177517`*^9, 3.586276972375846*^9}, {
   3.586277085489868*^9, 3.586277085578792*^9}, {3.5862774896106157`*^9, 
   3.586277490945325*^9}, {3.586277675637706*^9, 3.586277675806511*^9}, {
   3.5862782074874887`*^9, 3.5862782075951567`*^9}, {3.5862785138296747`*^9, 
   3.586278524431981*^9}, {3.586299957432815*^9, 3.586299957982965*^9}, {
   3.5863007227018127`*^9, 3.586300723013514*^9}, {3.586300890803255*^9, 
   3.586300891145954*^9}, {3.586301066360034*^9, 3.586301066633614*^9}, {
   3.5863017267564363`*^9, 3.5863017271323643`*^9}, {3.586302021402279*^9, 
   3.586302021955317*^9}, {3.586302118126728*^9, 3.586302118236003*^9}, {
   3.586381776584436*^9, 3.586381792277049*^9}, {3.5868720835417223`*^9, 
   3.586872084900858*^9}, {3.5868726689830647`*^9, 3.5868726706620646`*^9}, {
   3.5868732861900644`*^9, 3.5868732959090643`*^9}, {3.586875682133559*^9, 
   3.5868756859739437`*^9}, {3.5870511591149597`*^9, 
   3.5870511591649647`*^9}, {3.5912217278134527`*^9, 3.5912217287156*^9}, {
   3.59122483540934*^9, 3.5912248394428253`*^9}, {3.591224882859967*^9, 
   3.591224891137409*^9}, {3.591227923432393*^9, 3.5912279334095182`*^9}, 
   3.591288770035035*^9, {3.5912888234237843`*^9, 3.591288826022884*^9}, {
   3.591288887574812*^9, 3.591288887997858*^9}, {3.5912950398810472`*^9, 
   3.591295123193832*^9}, {3.591296579382214*^9, 3.591296617380375*^9}, {
   3.591296657165275*^9, 3.591296676341487*^9}, {3.591296740175308*^9, 
   3.591296782973329*^9}, {3.5912969510916567`*^9, 3.591296953003766*^9}, {
   3.591297022286523*^9, 3.591297076585884*^9}, {3.5921506862826643`*^9, 
   3.592150694773328*^9}, {3.5921508032386103`*^9, 3.592151104135303*^9}, {
   3.5921511488417597`*^9, 3.592151154275928*^9}, {3.5921511967042503`*^9, 
   3.592151296684084*^9}, {3.592151618601972*^9, 3.592151689351117*^9}, {
   3.5924735618884897`*^9, 3.592473562020426*^9}, {3.592481000318696*^9, 
   3.5924810007602262`*^9}, {3.592481219800811*^9, 3.592481219937624*^9}, {
   3.5924817576849117`*^9, 3.592481778322916*^9}, {3.592481831248885*^9, 
   3.592481835502351*^9}, {3.592481911625691*^9, 3.592481912888076*^9}, {
   3.5924822376585007`*^9, 3.5924822608694553`*^9}, 3.5924823609813423`*^9, {
   3.5924826004826393`*^9, 3.592482600600987*^9}, {3.592482851777931*^9, 
   3.592482854678439*^9}, {3.592483436337863*^9, 3.592483436750441*^9}, {
   3.592590213880867*^9, 3.5925902140323677`*^9}, {3.592591094150853*^9, 
   3.592591094445141*^9}, {3.593189395619042*^9, 3.593189398981052*^9}, {
   3.593952520158455*^9, 3.593952520253524*^9}, {3.593953244960091*^9, 
   3.593953290381213*^9}, {3.5939534935274982`*^9, 3.59395351256291*^9}, {
   3.594578580561651*^9, 3.594578586570574*^9}, {3.594578755772644*^9, 
   3.5945788135916777`*^9}, {3.5949896769026537`*^9, 3.594989677248083*^9}, {
   3.594990110176016*^9, 3.594990112121812*^9}, {3.5949911447946787`*^9, 
   3.594991144944536*^9}, {3.594991391438011*^9, 3.5949913915659513`*^9}, {
   3.594991549878942*^9, 3.594991550030712*^9}, {3.595594057552569*^9, 
   3.5955940655256968`*^9}, {3.595594283801564*^9, 3.595594286511107*^9}, {
   3.5955950272902737`*^9, 3.595595031297583*^9}, {3.595602408167944*^9, 
   3.595602435553466*^9}, {3.595873809570693*^9, 3.5958738265120687`*^9}, {
   3.598051560699049*^9, 3.59805160462397*^9}, {3.598113581659998*^9, 
   3.5981136471240892`*^9}, {3.5981243823949757`*^9, 3.598124391100135*^9}, {
   3.598124449985386*^9, 3.598124471230076*^9}, {3.598125078538786*^9, 
   3.598125172252654*^9}, {3.598126304000682*^9, 3.5981263157087193`*^9}, 
   3.59812866832271*^9, {3.5981287385583963`*^9, 3.598128778638356*^9}, {
   3.598134117649506*^9, 3.5981341595703783`*^9}, {3.598134313793887*^9, 
   3.5981345864038486`*^9}, {3.598141215549562*^9, 3.598141220736332*^9}, {
   3.59814419983492*^9, 3.59814420083346*^9}, {3.598146881016671*^9, 
   3.598146883106842*^9}, {3.598250874671597*^9, 3.598250883840097*^9}, {
   3.598311880778432*^9, 3.598311883589241*^9}, {3.59832552001607*^9, 
   3.598325525021978*^9}, {3.598325766871619*^9, 3.598325773468461*^9}, 
   3.598452869383011*^9, {3.598573953020013*^9, 3.598574012748721*^9}, {
   3.5985743506649017`*^9, 3.598574350848041*^9}, {3.5986188815624638`*^9, 
   3.598618888183557*^9}, {3.5986191703584146`*^9, 3.598619192973559*^9}, {
   3.5986192429287786`*^9, 3.598619243767276*^9}, {3.5986193132768993`*^9, 
   3.5986193138949337`*^9}, {3.598619348387589*^9, 3.598619348809691*^9}, {
   3.5986196699730453`*^9, 3.598619670381453*^9}, {3.5986197194874487`*^9, 
   3.5986197202479677`*^9}, {3.59880760598081*^9, 3.598807688808949*^9}, {
   3.5988079597218122`*^9, 3.59880797086281*^9}, {3.598808069008931*^9, 
   3.598808156144346*^9}, {3.598808191672782*^9, 3.598808192196435*^9}, {
   3.5988082355393667`*^9, 3.5988082360018578`*^9}, {3.598808302625616*^9, 
   3.598808302996482*^9}, {3.598808381067172*^9, 3.598808381310112*^9}, {
   3.59880868524684*^9, 3.5988086854897633`*^9}, {3.598809967193149*^9, 
   3.598809967697053*^9}, {3.598810064878641*^9, 3.598810065312748*^9}, {
   3.598810110821739*^9, 3.59881011126545*^9}, {3.59881014390383*^9, 
   3.5988101449320602`*^9}, {3.598810232209629*^9, 3.5988102326420918`*^9}, {
   3.5988103017022867`*^9, 3.598810302175494*^9}, {3.5988103751687193`*^9, 
   3.598810375829164*^9}, {3.598810407531589*^9, 3.59881042961474*^9}, {
   3.599782981036351*^9, 3.599783021649776*^9}, 3.599783225239463*^9, {
   3.599783805594459*^9, 3.599783875818963*^9}, 3.5997839063069887`*^9, 
   3.599783990447626*^9, {3.5997840786367397`*^9, 3.599784083391109*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"directory created:\"\>", 
   "\[InvisibleSpace]", \
"\<\"/home/qzmfrank/codes/rte2dvis/notebook/../msh/square162.dat\"\>"}],
  SequenceForm[
  "directory created:", 
   "/home/qzmfrank/codes/rte2dvis/notebook/../msh/square162.dat"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.598619056297843*^9, {3.598619177936928*^9, 3.598619193836482*^9}, 
   3.598619244694509*^9, 3.59861931472023*^9, 3.598619349754073*^9, 
   3.598619671398055*^9, 3.598619722135105*^9, 3.5988079113341*^9, 
   3.5988079729308653`*^9, {3.5988080570637903`*^9, 3.598808078985268*^9}, {
   3.5988081337349443`*^9, 3.5988081571505747`*^9}, 3.598808193300318*^9, 
   3.598808237033772*^9, 3.598808304616486*^9, 3.59880839095405*^9, 
   3.598808690276754*^9, 3.598809861429495*^9, 3.5988099686449213`*^9, 
   3.598810066341943*^9, 3.5988101121914577`*^9, 3.598810145994491*^9, 
   3.598810233478342*^9, 3.598810303207066*^9, 3.598810376867441*^9, {
   3.59881040913231*^9, 3.5988104311630497`*^9}, 3.5997829527793827`*^9, 
   3.5997838340517473`*^9, {3.599783908485805*^9, 3.5997839266318693`*^9}, 
   3.5997839919098682`*^9, 3.5997840856454782`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"exported nodes file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"/home/qzmfrank/codes/rte2dvis/notebook/../msh/square162.dat/nodes.dat\"\>\
"}],
  SequenceForm[
  "exported nodes file: ", 
   "/home/qzmfrank/codes/rte2dvis/notebook/../msh/square162.dat/nodes.dat"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.598619056297843*^9, {3.598619177936928*^9, 3.598619193836482*^9}, 
   3.598619244694509*^9, 3.59861931472023*^9, 3.598619349754073*^9, 
   3.598619671398055*^9, 3.598619722135105*^9, 3.5988079113341*^9, 
   3.5988079729308653`*^9, {3.5988080570637903`*^9, 3.598808078985268*^9}, {
   3.5988081337349443`*^9, 3.5988081571505747`*^9}, 3.598808193300318*^9, 
   3.598808237033772*^9, 3.598808304616486*^9, 3.59880839095405*^9, 
   3.598808690276754*^9, 3.598809861429495*^9, 3.5988099686449213`*^9, 
   3.598810066341943*^9, 3.5988101121914577`*^9, 3.598810145994491*^9, 
   3.598810233478342*^9, 3.598810303207066*^9, 3.598810376867441*^9, {
   3.59881040913231*^9, 3.5988104311630497`*^9}, 3.5997829527793827`*^9, 
   3.5997838340517473`*^9, {3.599783908485805*^9, 3.5997839266318693`*^9}, 
   3.5997839919098682`*^9, 3.599784085709281*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"exported triangles file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"/home/qzmfrank/codes/rte2dvis/notebook/../msh/square162.dat/triangles.\
dat\"\>"}],
  SequenceForm[
  "exported triangles file: ", 
   "/home/qzmfrank/codes/rte2dvis/notebook/../msh/square162.dat/triangles.\
dat"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.598619056297843*^9, {3.598619177936928*^9, 3.598619193836482*^9}, 
   3.598619244694509*^9, 3.59861931472023*^9, 3.598619349754073*^9, 
   3.598619671398055*^9, 3.598619722135105*^9, 3.5988079113341*^9, 
   3.5988079729308653`*^9, {3.5988080570637903`*^9, 3.598808078985268*^9}, {
   3.5988081337349443`*^9, 3.5988081571505747`*^9}, 3.598808193300318*^9, 
   3.598808237033772*^9, 3.598808304616486*^9, 3.59880839095405*^9, 
   3.598808690276754*^9, 3.598809861429495*^9, 3.5988099686449213`*^9, 
   3.598810066341943*^9, 3.5988101121914577`*^9, 3.598810145994491*^9, 
   3.598810233478342*^9, 3.598810303207066*^9, 3.598810376867441*^9, {
   3.59881040913231*^9, 3.5988104311630497`*^9}, 3.5997829527793827`*^9, 
   3.5997838340517473`*^9, {3.599783908485805*^9, 3.5997839266318693`*^9}, 
   3.5997839919098682`*^9, 3.599784085709868*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"imported nodes file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"/home/qzmfrank/codes/rte2dvis/notebook/../msh/square162.dat/nodes.dat\"\>\
"}],
  SequenceForm[
  "imported nodes file: ", 
   "/home/qzmfrank/codes/rte2dvis/notebook/../msh/square162.dat/nodes.dat"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.598619056297843*^9, {3.598619177936928*^9, 3.598619193836482*^9}, 
   3.598619244694509*^9, 3.59861931472023*^9, 3.598619349754073*^9, 
   3.598619671398055*^9, 3.598619722135105*^9, 3.5988079113341*^9, 
   3.5988079729308653`*^9, {3.5988080570637903`*^9, 3.598808078985268*^9}, {
   3.5988081337349443`*^9, 3.5988081571505747`*^9}, 3.598808193300318*^9, 
   3.598808237033772*^9, 3.598808304616486*^9, 3.59880839095405*^9, 
   3.598808690276754*^9, 3.598809861429495*^9, 3.5988099686449213`*^9, 
   3.598810066341943*^9, 3.5988101121914577`*^9, 3.598810145994491*^9, 
   3.598810233478342*^9, 3.598810303207066*^9, 3.598810376867441*^9, {
   3.59881040913231*^9, 3.5988104311630497`*^9}, 3.5997829527793827`*^9, 
   3.5997838340517473`*^9, {3.599783908485805*^9, 3.5997839266318693`*^9}, 
   3.5997839919098682`*^9, 3.599784085710383*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"imported triangles file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"/home/qzmfrank/codes/rte2dvis/notebook/../msh/square162.dat/triangles.\
dat\"\>"}],
  SequenceForm[
  "imported triangles file: ", 
   "/home/qzmfrank/codes/rte2dvis/notebook/../msh/square162.dat/triangles.\
dat"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.598619056297843*^9, {3.598619177936928*^9, 3.598619193836482*^9}, 
   3.598619244694509*^9, 3.59861931472023*^9, 3.598619349754073*^9, 
   3.598619671398055*^9, 3.598619722135105*^9, 3.5988079113341*^9, 
   3.5988079729308653`*^9, {3.5988080570637903`*^9, 3.598808078985268*^9}, {
   3.5988081337349443`*^9, 3.5988081571505747`*^9}, 3.598808193300318*^9, 
   3.598808237033772*^9, 3.598808304616486*^9, 3.59880839095405*^9, 
   3.598808690276754*^9, 3.598809861429495*^9, 3.5988099686449213`*^9, 
   3.598810066341943*^9, 3.5988101121914577`*^9, 3.598810145994491*^9, 
   3.598810233478342*^9, 3.598810303207066*^9, 3.598810376867441*^9, {
   3.59881040913231*^9, 3.5988104311630497`*^9}, 3.5997829527793827`*^9, 
   3.5997838340517473`*^9, {3.599783908485805*^9, 3.5997839266318693`*^9}, 
   3.5997839919098682`*^9, 3.5997840857109003`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{p,t}=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"True", ",", "True"}], "}"}]}],
  SequenceForm["{p,t}=", {True, True}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.598619056297843*^9, {3.598619177936928*^9, 3.598619193836482*^9}, 
   3.598619244694509*^9, 3.59861931472023*^9, 3.598619349754073*^9, 
   3.598619671398055*^9, 3.598619722135105*^9, 3.5988079113341*^9, 
   3.5988079729308653`*^9, {3.5988080570637903`*^9, 3.598808078985268*^9}, {
   3.5988081337349443`*^9, 3.5988081571505747`*^9}, 3.598808193300318*^9, 
   3.598808237033772*^9, 3.598808304616486*^9, 3.59880839095405*^9, 
   3.598808690276754*^9, 3.598809861429495*^9, 3.5988099686449213`*^9, 
   3.598810066341943*^9, 3.5988101121914577`*^9, 3.598810145994491*^9, 
   3.598810233478342*^9, 3.598810303207066*^9, 3.598810376867441*^9, {
   3.59881040913231*^9, 3.5988104311630497`*^9}, 3.5997829527793827`*^9, 
   3.5997838340517473`*^9, {3.599783908485805*^9, 3.5997839266318693`*^9}, 
   3.5997839919098682`*^9, 3.599784085711412*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{Ns,Nd,Nm,Ng}=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"162", ",", "10", ",", "21", ",", "3402"}], "}"}]}],
  SequenceForm["{Ns,Nd,Nm,Ng}=", {162, 10, 21, 3402}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.598619056297843*^9, {3.598619177936928*^9, 3.598619193836482*^9}, 
   3.598619244694509*^9, 3.59861931472023*^9, 3.598619349754073*^9, 
   3.598619671398055*^9, 3.598619722135105*^9, 3.5988079113341*^9, 
   3.5988079729308653`*^9, {3.5988080570637903`*^9, 3.598808078985268*^9}, {
   3.5988081337349443`*^9, 3.5988081571505747`*^9}, 3.598808193300318*^9, 
   3.598808237033772*^9, 3.598808304616486*^9, 3.59880839095405*^9, 
   3.598808690276754*^9, 3.598809861429495*^9, 3.5988099686449213`*^9, 
   3.598810066341943*^9, 3.5988101121914577`*^9, 3.598810145994491*^9, 
   3.598810233478342*^9, 3.598810303207066*^9, 3.598810376867441*^9, {
   3.59881040913231*^9, 3.5988104311630497`*^9}, 3.5997829527793827`*^9, 
   3.5997838340517473`*^9, {3.599783908485805*^9, 3.5997839266318693`*^9}, 
   3.5997839919098682`*^9, 3.599784085711931*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{gTbl,iGTbl,iLTbl}=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "True"}], "}"}]}],
  SequenceForm["{gTbl,iGTbl,iLTbl}=", {True, True, True}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.598619056297843*^9, {3.598619177936928*^9, 3.598619193836482*^9}, 
   3.598619244694509*^9, 3.59861931472023*^9, 3.598619349754073*^9, 
   3.598619671398055*^9, 3.598619722135105*^9, 3.5988079113341*^9, 
   3.5988079729308653`*^9, {3.5988080570637903`*^9, 3.598808078985268*^9}, {
   3.5988081337349443`*^9, 3.5988081571505747`*^9}, 3.598808193300318*^9, 
   3.598808237033772*^9, 3.598808304616486*^9, 3.59880839095405*^9, 
   3.598808690276754*^9, 3.598809861429495*^9, 3.5988099686449213`*^9, 
   3.598810066341943*^9, 3.5988101121914577`*^9, 3.598810145994491*^9, 
   3.598810233478342*^9, 3.598810303207066*^9, 3.598810376867441*^9, {
   3.59881040913231*^9, 3.5988104311630497`*^9}, 3.5997829527793827`*^9, 
   3.5997838340517473`*^9, {3.599783908485805*^9, 3.5997839266318693`*^9}, 
   3.5997839919098682`*^9, 3.599784085712455*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{Tpt,Tcntr,Tr2rR,TsignedArea,Tarea,TRc}=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.05884700000000000278115464685813051915`4.188264249510802", ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00011500000000000000347812056933349822`2.081297753633236", ",", 
       "0.00009399999999999999447577309075185781`1.9937277668793227", ",", 
       "0.05820800000000000279376521916674391832`4.785582590663013", ",", 
       "0.0004299999999999999894355340313012448`2.6540683688592104"}], 
      "}"}]}], "}"}]}],
  SequenceForm[
  "{Tpt,Tcntr,Tr2rR,TsignedArea,Tarea,TRc}=", {
   0.05884700000000000278115464685813051915`4.188264249510802, {
    0.00011500000000000000347812056933349822`2.081297753633236, 
     0.00009399999999999999447577309075185781`1.9937277668793227, 
     0.05820800000000000279376521916674391832`4.785582590663013, 
     0.0004299999999999999894355340313012448`2.6540683688592104}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.598619056297843*^9, {3.598619177936928*^9, 3.598619193836482*^9}, 
   3.598619244694509*^9, 3.59861931472023*^9, 3.598619349754073*^9, 
   3.598619671398055*^9, 3.598619722135105*^9, 3.5988079113341*^9, 
   3.5988079729308653`*^9, {3.5988080570637903`*^9, 3.598808078985268*^9}, {
   3.5988081337349443`*^9, 3.5988081571505747`*^9}, 3.598808193300318*^9, 
   3.598808237033772*^9, 3.598808304616486*^9, 3.59880839095405*^9, 
   3.598808690276754*^9, 3.598809861429495*^9, 3.5988099686449213`*^9, 
   3.598810066341943*^9, 3.5988101121914577`*^9, 3.598810145994491*^9, 
   3.598810233478342*^9, 3.598810303207066*^9, 3.598810376867441*^9, {
   3.59881040913231*^9, 3.5988104311630497`*^9}, 3.5997829527793827`*^9, 
   3.5997838340517473`*^9, {3.599783908485805*^9, 3.5997839266318693`*^9}, 
   3.5997839919098682`*^9, 3.599784085789291*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{pt,cntr,r2rR,signedArea,area,Rc}=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}],
  SequenceForm["{pt,cntr,r2rR,signedArea,area,Rc}=", {True, True, True, True}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.598619056297843*^9, {3.598619177936928*^9, 3.598619193836482*^9}, 
   3.598619244694509*^9, 3.59861931472023*^9, 3.598619349754073*^9, 
   3.598619671398055*^9, 3.598619722135105*^9, 3.5988079113341*^9, 
   3.5988079729308653`*^9, {3.5988080570637903`*^9, 3.598808078985268*^9}, {
   3.5988081337349443`*^9, 3.5988081571505747`*^9}, 3.598808193300318*^9, 
   3.598808237033772*^9, 3.598808304616486*^9, 3.59880839095405*^9, 
   3.598808690276754*^9, 3.598809861429495*^9, 3.5988099686449213`*^9, 
   3.598810066341943*^9, 3.5988101121914577`*^9, 3.598810145994491*^9, 
   3.598810233478342*^9, 3.598810303207066*^9, 3.598810376867441*^9, {
   3.59881040913231*^9, 3.5988104311630497`*^9}, 3.5997829527793827`*^9, 
   3.5997838340517473`*^9, {3.599783908485805*^9, 3.5997839266318693`*^9}, 
   3.5997839919098682`*^9, 3.5997840857899218`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{A,B}=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"True", ",", "True"}], "}"}]}],
  SequenceForm["{A,B}=", {True, True}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.598619056297843*^9, {3.598619177936928*^9, 3.598619193836482*^9}, 
   3.598619244694509*^9, 3.59861931472023*^9, 3.598619349754073*^9, 
   3.598619671398055*^9, 3.598619722135105*^9, 3.5988079113341*^9, 
   3.5988079729308653`*^9, {3.5988080570637903`*^9, 3.598808078985268*^9}, {
   3.5988081337349443`*^9, 3.5988081571505747`*^9}, 3.598808193300318*^9, 
   3.598808237033772*^9, 3.598808304616486*^9, 3.59880839095405*^9, 
   3.598808690276754*^9, 3.598809861429495*^9, 3.5988099686449213`*^9, 
   3.598810066341943*^9, 3.5988101121914577`*^9, 3.598810145994491*^9, 
   3.598810233478342*^9, 3.598810303207066*^9, 3.598810376867441*^9, {
   3.59881040913231*^9, 3.5988104311630497`*^9}, 3.5997829527793827`*^9, 
   3.5997838340517473`*^9, {3.599783908485805*^9, 3.5997839266318693`*^9}, 
   3.5997839919098682`*^9, 3.599784088800331*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["V0", "Subsection",
 CellChangeTimes->{{3.5988077152157917`*^9, 3.598807715398546*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"\[Mu]t", ",", "\[Mu]s", ",", "V0"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]t", "=", 
   RowBox[{"Log", "[", "4.0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]s", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "area", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", "phis"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "Ns"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", 
         RowBox[{"-", "Nd"}], ",", "Nd"}], "}"}]}], "]"}], "//", "Flatten"}], 
    "//", "ToPackedArray"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V0", "//", "PackedArrayQ"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "X0", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X0", "=", 
   RowBox[{
    RowBox[{"LinearSolve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"HomoMul", "[", 
        RowBox[{
        "#", ",", "A", ",", "B", ",", "gTbl", ",", "\[Mu]t", ",", "\[Mu]s"}], 
        "]"}], "&"}], ",", "V0", ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<Krylov\>\"", ",", 
         RowBox[{"Tolerance", "\[Rule]", 
          RowBox[{"10", "^", 
           RowBox[{"-", "20"}]}]}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<GMRES\>\""}], ",", 
         RowBox[{"\"\<Preconditioner\>\"", "\[Rule]", "None"}], ",", 
         RowBox[{"MaxIterations", "\[Rule]", "20"}], ",", 
         RowBox[{"\"\<ResidualNormFunction\>\"", "\[Rule]", "Norm"}]}], 
        "}"}]}]}], "]"}], "//", "Quiet"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Max Relative err=\>\"", ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"HomoMul", "[", 
            RowBox[{
            "X0", ",", "A", ",", "B", ",", "gTbl", ",", "\[Mu]t", ",", 
             "\[Mu]s"}], "]"}], "-", "V0"}], ")"}], "/", "V0"}], "]"}], "//", 
       "Quiet"}], "//", "Flatten"}], "//", "Max"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "data", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{
     RowBox[{"Re", "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"X0", ",", 
          RowBox[{
           RowBox[{"2", "Nd"}], "+", "1"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"Nd", "+", "1"}], ";;", 
          RowBox[{
           RowBox[{"2", "Nd"}], "+", "1"}]}]}], "\[RightDoubleBracket]"}], 
       ")"}]}], "//", "ToPackedArray"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{"data", ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"2", "\[Pi]"}], ")"}]}]}], "}"}]}]}], "]"}], "//", 
     "Print"}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<sol\>\""}], "}"}], 
    "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ToString", "[", "Ns", "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", "Nd", "]"}]}], ",", "X0", ",", 
    "\"\<Complex128\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResetDirectory", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.598462046844242*^9, 3.598462125569311*^9}, {
   3.598464910911262*^9, 3.5984649178552*^9}, {3.59846496049406*^9, 
   3.5984649606616488`*^9}, {3.5984653610591087`*^9, 3.598465361411025*^9}, {
   3.598465509123221*^9, 3.598465517788282*^9}, {3.598574626205223*^9, 
   3.59857463222789*^9}, {3.5986191199630957`*^9, 3.598619127699278*^9}, {
   3.598619265051969*^9, 3.5986192921745367`*^9}, {3.5997832950091476`*^9, 
   3.599783305965995*^9}, 3.5997841142642527`*^9, {3.599784958965106*^9, 
   3.5997849975752707`*^9}, 3.5997850415526743`*^9, {3.599785145665039*^9, 
   3.5997851523860197`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Max Relative err=\"\>", "\[InvisibleSpace]", 
   "3.890831176034689`*^-11"}],
  SequenceForm["Max Relative err=", 3.890831176034689*^-11],
  Editable->False]], "Print",
 CellChangeTimes->{{3.598619287906547*^9, 3.598619293947627*^9}, {
   3.598619330144691*^9, 3.598619337987808*^9}, 3.598619370274338*^9, 
   3.598619705509838*^9, 3.598619761205001*^9, 3.599782956594142*^9, 
   3.599783137436636*^9, 3.5997833028202877`*^9, 3.59978392711834*^9, 
   3.599784091621044*^9, 3.599784961483856*^9, {3.59978514749158*^9, 
   3.5997851576327887`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{927, 1028},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 77676, 1863, 4250, "Code"],
Cell[CellGroupData[{
Cell[78280, 1889, 1177, 21, 23, "Print"],
Cell[79460, 1912, 1203, 22, 23, "Print"],
Cell[80666, 1936, 1221, 23, 23, "Print"],
Cell[81890, 1961, 1203, 22, 23, "Print"],
Cell[83096, 1985, 1223, 23, 23, "Print"],
Cell[84322, 2010, 1078, 19, 23, "Print"],
Cell[85403, 2031, 1122, 19, 23, "Print"],
Cell[86528, 2052, 1123, 19, 23, "Print"],
Cell[87654, 2073, 1862, 33, 23, "Print"],
Cell[89519, 2108, 1174, 19, 23, "Print"],
Cell[90696, 2129, 1078, 19, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[91823, 2154, 92, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[91940, 2159, 4537, 122, 385, "Input"],
Cell[96480, 2283, 595, 11, 25, "Print"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
