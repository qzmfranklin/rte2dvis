################################################################################
#  A set of template files to build projects with a single Makefile
#  Copyright (C) 2013 Zhongming Qu <qzmfrank@umich.edu>
#  
#  This program is free software: you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation, either version 3 of the License, or
#  (at your option) any later version.
#  
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#  
#  You should have received a copy of the GNU General Public License
#  along with this program.  If not, see <http://www.gnu.org/licenses/>.  
################################################################################
#	DIRECTORY NAME FROM THE ROOT DIRECTORY
DIR004:=src/pyplot# Please, NO SPACE 
# Quiet build for this dirctory. Comment the following line to be verbose.
${DIR004}QUIET:=@
###############################################################################
#	DIRECTORY-SPECIFIC COMPILING AND LINKING OPTIONS
${DIR004}CXXFLAGS:=${CXXFLAGS}
${DIR004}INCS:=${INCS}
###############################################################################
#	DIRECTORY-SPECIFIC SOURCE FILES
${DIR004}CPPFILES:=pyplot.cpp pyhist.cpp
###############################################################################
#	DIRECTORY-SPECIFIC BINARY OUTPUTS: EXECUTABLES and LIBRARIES
###############################################################################
#	DIRECTORY-SPECIFIC TEST FILES
${DIR004}TSTEXE:= test_pyplot.exe test_pyhist.exe

${BIN}/test_pyplot.exe: ${OBJ}/test_pyplot.o ${OBJ}/pyplot.o \
	${OBJ}/utils.o
${BIN}/test_pyhist.exe: ${OBJ}/test_pyhist.o ${OBJ}/pyhist.o \
	${OBJ}/utils.o
###############################################################################
#	END
###############################################################################


































###############################################################################
###############################################################################
###############################################################################
###############################################################################
#	The following four blocks of codes generate proper directory-specific
#  variables and add proper files to the top level variables. Please anyway do
#  NOT modify them.
################## DO NOT MODIFY ################
${DIR004}CPPFILES:=${${DIR004}CPPFILES:%=${DIR004}/%}
${DIR004}OBJFILES:=${${DIR004}CPPFILES:${DIR004}%.cpp=${OBJ}%.o}
${DIR004}DEPFILES:=${${DIR004}OBJFILES:%.o=%.d}
${DIR004}ASMFILES:=${${DIR004}OBJFILES:${OBJ}%.o=${ASM}%.s}
################## DO NOT MODIFY ################
${DIR004}BINEXE:=${${DIR004}BINEXE:%=${BIN}/%}
${DIR004}BINCPP:=${${DIR004}BINEXE:${BIN}/%.exe=${DIR004}/%.cpp}
${DIR004}BINOBJ:=${${DIR004}BINCPP:${DIR004}%.cpp=${OBJ}%.o}
${DIR004}BINDEP:=${${DIR004}BINOBJ:%.o=%.d}
${DIR004}BINASM:=${${DIR004}BINOBJ:${OBJ}%.o=${ASM}%.s}
################## DO NOT MODIFY ################
${DIR004}TSTEXE:=${${DIR004}TSTEXE:%=${BIN}/%}
${DIR004}TSTCPP:=${${DIR004}TSTEXE:${BIN}/%.exe=${DIR004}/%.cpp}
${DIR004}TSTOBJ:=${${DIR004}TSTCPP:${DIR004}%.cpp=${OBJ}%.o}
${DIR004}TSTDEP:=${${DIR004}TSTOBJ:%.o=%.d}
${DIR004}TSTASM:=${${DIR004}TSTOBJ:${OBJ}%.o=${ASM}%.s}
################## DO NOT MODIFY ################
SRCFILES:=${SRCFILES} ${${DIR004}CFILES} \
	${${DIR004}CPPFILES} ${${DIR004}TSTCPP} \
	${${DIR004}BINCPP}
DEPFILES:=${DEPFILES} ${${DIR004}DEPFILES} \
	${${DIR004}TSTDEP} ${${DIR004}BINDEP}
################## DO NOT MODIFY ################
###############################################################################
#				WANRING
#  Please do not modify the following part if you are not 100% sure about it.
#  The design of this file is that one only needs to modify the part above.
#  If you find you need to modify any of the parts below, be very careful!
#				WANRING
###############################################################################
###############################################################################

#DIRECTORY-SPECIFIC PATTERN RULES
#
#	C++ linkage at the top level is done in the Makefile.vars in the root 
#  directory. Any special build rules for libraries and executables should be
#  secified in STEP 6 in this makevars.mk file.
#  	Not using "\" to break long lines because that would hurt the non-quiet 
#  mode output aestetics. The new colorful version of "make list" is ready now!

#DIRECTORY-SPECIFIC PHONY TARGETS
.PHONY: ${DIR004}-all ${DIR004}-test \
	${DIR004}-asm ${DIR004}-check \
	${DIR004}-list

#  C++ sources
${OBJ}/%.o: ${DIR004}/%.cpp
	@echo Compiling "${GREEN}$@${NONE}"...
	${${DIR004}QUIET}${CXX} -o $@ -c $< ${${DIR004}CXXFLAGS} ${${DIR004}INCS}
${ASM}/%.s: ${DIR004}/%.cpp
	@echo Generating "${CYAN}$@${NONE}"...
	${${DIR004}QUIET}${CXX} -o $@ $< ${ASMFLAGS} ${${DIR004}CXXFLAGS} ${${DIR004}INCS} 

	
TARGET_ALL	:=${TARGET_ALL} ${DIR004}-all
TARGET_TEST	:=${TARGET_TEST} ${DIR004}-test
TARGET_ASM	:=${TARGET_ASM} ${DIR004}-asm
TARGET_CHECK	:=${TARGET_CHECK} ${DIR004}-check
TARGET_LIST	:=${TARGET_LIST} ${DIR004}-list
${DIR004}-all: ${${DIR004}OBJFILES} ${${DIR004}BINEXE}
	@echo Finished building "${B_BLUE}$@${NONE}".
${DIR004}-test: ${${DIR004}TSTEXE}
	@echo Finished building "${B_BLUE}$@${NONE}".  
${DIR004}-asm: ${${DIR004}ASMFILES} ${${DIR004}TSTASM} \
	${${DIR004}BINASM}
	@echo Finished generating "${B_BLUE}$@${NONE}".  
${DIR004}-check: ${${DIR004}TSTEXE:${BIN}/%.exe=${OUTPUT}/%.txt}
${DIR004}-list:
	@echo \#\#\#\#\#\#\#\#"${B_BROWN}$@${NONE}"\#\#\#\#\#\#\#\#
	@$(foreach dir, 						\
		CFILES CPPFILES TSTCPP BINCPP				\
		,							\
		if [ ! -z "${${DIR004}${dir}}" ]; then 		\
			echo "${BROWN}${dir}${NONE}\t\c";		\
			$(foreach file,${${DIR004}${dir}},		\
			    if [ -f ${file} ]; then echo		\
				"${BLACK}${file}${NONE}\c";		\
			    else echo "${GREY}${file}${NONE}\c";	\
			    fi;)					\
			echo;						\
		fi;)
	@$(foreach dir, 						\
		TSTEXE BINEXE						\
		,							\
		if [ ! -z "${${DIR004}${dir}}" ]; then 		\
			echo "${BROWN}${dir}${NONE}\t\c";		\
			$(foreach file,${${DIR004}${dir}},		\
			    if [ -f ${file} ]; then echo		\
				"${RED}${file}${NONE}\c";		\
			    else echo "${GREY}${file}${NONE}\c";	\
			    fi;)					\
			echo;						\
		fi;)
	@$(foreach dir, 						\
		OBJFILES TSTOBJ BINOBJ					\
		,							\
		if [ ! -z "${${DIR004}${dir}}" ]; then 		\
			echo "${BROWN}${dir}${NONE}\t\c";		\
			$(foreach file,${${DIR004}${dir}},		\
			    if [ -f ${file} ]; then echo		\
				"${GREEN}${file}${NONE}\c";		\
			    else echo "${GREY}${file}${NONE}\c";	\
			    fi;)					\
			echo;						\
		fi;) 
